{"version":3,"file":"pulse.min.js","sources":["../lib2/helpers.ts","../lib2/interfaces.ts","../lib2/runtime.ts","../lib2/dep.ts","../lib2/reactive.ts","../lib2/action.ts","../lib2/filter.ts","../lib2/collection.ts","../lib2/subController.ts","../lib2/storage.ts","../lib2/collections/request.ts","../lib2/collections/base.ts","../lib2/library.ts"],"sourcesContent":["export const protectedNames = [\n  'data',\n  'indexes',\n  'groups',\n  'filters',\n  'actions',\n  'routes'\n];\n\nexport const collectionFunctions = [\n  'collect',\n  'replaceIndex',\n  'getGroup',\n  'newGroup',\n  'deleteGroup',\n  'removeFromGroup',\n  'update',\n  'increment',\n  'decrement',\n  'delete',\n  'purge',\n  'watch',\n  'findById'\n];\n\nexport function defineConfig(config, defaults) {\n  return { ...defaults, ...config };\n}\n\nexport function uuid() {\n  return (\n    Math.random()\n      .toString()\n      .split('.')[1] + Date.now()\n  );\n}\n\nexport function objectLoop(object, callback, keys?: Array<any>) {\n  const objectKeys = keys ? keys : Object.keys(object);\n  for (let i = 0; i < objectKeys.length; i++) {\n    const key: string = objectKeys[i];\n    const value: any = object[key];\n    callback(key, value, objectKeys);\n  }\n}\n\n// const thing = {}\n// objectLoop(thing, (thingKey, thingItem) => {\n\n// })\n\nexport function log(value, payload) {\n  console.log(`Pulse / ${value}`, payload ? payload : ' ');\n}\n\nexport function normalizeMap(map) {\n  return Array.isArray(map)\n    ? map.map(key => ({ key, val: key }))\n    : Object.keys(map).map(key => ({ key, val: map[key] }));\n}\n\nexport const arrayFunctions = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse'\n];\n\nexport function assert(\n  func: (warnings: { [key: string]: any }) => any,\n  funcName?: string\n) {\n  function warn(message) {\n    if (funcName) console.log(`Pulse / ${funcName} / ${message}`);\n    else console.warn(`Pulse / ${message}`);\n    return false;\n  }\n  const warnings = {\n    NO_PRIMARY_KEY: () => warn('No primary key found!'),\n    INVALID_PARAMETER: () => warn('Invalid parameter supplied to function.'),\n    INDEX_NOT_FOUND: () => warn('Index was not found on collection.'),\n    INTERNAL_DATA_NOT_FOUND: () => warn('Data was not found on collection.'),\n    PROPERTY_NOT_A_NUMBER: () => warn('Property is not a number!')\n  };\n  return func(warnings)();\n}\n\nexport function isWatchableObject(value) {\n  function isHTMLElement(obj) {\n    try {\n      return obj instanceof HTMLElement;\n    } catch (e) {\n      return (\n        typeof obj === 'object' &&\n        obj.nodeType === 1 &&\n        typeof obj.style === 'object' &&\n        typeof obj.ownerDocument === 'object'\n      );\n    }\n  }\n  let type = typeof value;\n  return (\n    value != null &&\n    type == 'object' &&\n    !isHTMLElement(value) &&\n    !Array.isArray(value)\n  );\n}\n\nexport function validateNumber(mutable, amount) {\n  if (typeof amount !== 'number' || typeof mutable !== 'number') {\n    return false;\n  }\n  return true;\n}\n","import SubController from './subController';\nimport Runtime from './runtime';\nimport Collection from './collection';\nimport Dep from './dep';\nimport Action from './action';\nimport Filter from './filter';\n\nexport interface ExpandableObject {\n  [key: string]: any;\n}\n\nexport interface RequestConfig {\n  baseURL?: string;\n  requestIntercept?: () => void;\n  responseIntercept?: () => void;\n  mode?: 'cors' | 'same-origin' | 'no-cors' | 'navigate';\n  credentials?: 'omit' | 'same-origin';\n  include?: any;\n  headers?: ExpandableObject;\n  saveHistory?: boolean;\n  timeout?: number;\n}\n\nexport interface Watcher {\n  collection: string;\n  property: string;\n}\n\nexport interface RootConfig {\n  framework?: any;\n  frameworkConstructor?: any;\n  waitForMount?: boolean;\n  autoUnmount?: boolean;\n  enableBase: boolean;\n  enableRequest: boolean;\n}\nexport interface CollectionConfig {}\n\nexport interface CollectionObject {\n  config?: CollectionConfig;\n  data?: object;\n  persist?: Array<string>;\n  groups?: Array<string>;\n  actions?: object;\n  filters?: object;\n  watch?: object;\n  routes?: object;\n  model?: object;\n  local?: object;\n  // private\n  indexes?: object;\n}\n\nexport interface RootCollectionObject extends CollectionObject {\n  config?: RootConfig;\n  request?: object;\n  collections?: object;\n}\n\nexport interface Methods {\n  collect?: void;\n  replaceIndex?: void;\n  getGroup?: void;\n  newGroup?: void;\n  deleteGroup?: void;\n  removeFromGroup?: void;\n  update?: void;\n  increment?: void;\n  decrement?: void;\n  delete?: void;\n  purge?: void;\n  watch?: void;\n  findById?: void;\n}\n\nexport interface Keys {\n  data?: Array<string>;\n  filters?: Array<string>;\n  actions?: Array<string>;\n  indexes?: Array<string>;\n}\n\nexport interface Global {\n  subs: SubController;\n  runtime?: Runtime;\n  config: RootConfig;\n  initComplete: boolean;\n  collecting: boolean;\n  runningAction: boolean | Action;\n  runningFilter: boolean | Filter;\n  runningWatcher: boolean | Watcher;\n  contextRef: ExpandableObject;\n  storage: any;\n  // aliases\n  createForeignGroupRelation: any;\n  dispatch: any;\n  getContext: any;\n  uuid: any;\n  ingest?: any;\n  request?: any;\n}\n\nexport interface Private {\n  global: Global;\n  runtime: Runtime;\n  collections?: { [key: string]: Collection };\n  events?: { [key: string]: Array<(payload?: any) => any> };\n}\n\nexport const enum JobType {\n  PUBLIC_DATA_MUTATION = 'PUBLIC_DATA_MUTATION',\n  INTERNAL_DATA_MUTATION = 'INTERNAL_DATA_MUTATION',\n  INDEX_UPDATE = 'INDEX_UPDATE',\n  FILTER_REGEN = 'FILTER_REGEN',\n  GROUP_UPDATE = 'GROUP_UPDATE',\n  DEEP_PUBLIC_DATA_MUTATION = 'DEEP_PUBLIC_DATA_MUTATION',\n  BULK_INTERNAL_DATA_MUTATION = 'BULK_INTERNAL_DATA_MUTATION',\n  DELETE_INTERNAL_DATA = 'DELETE_INTERNAL_DATA'\n}\n\nexport interface Job {\n  type: JobType;\n  collection: string;\n  property: string;\n  value?: any;\n  previousValue?: any;\n  dep?: Dep;\n  fromAction?: boolean | Action;\n}\n\nexport interface ComponentContainer {\n  instance: any;\n  uuid: string;\n  ready: boolean;\n}\n","import { log, objectLoop } from './helpers';\nimport { JobType, Job, Global } from './interfaces';\n\nexport default class Runtime {\n  public running: Boolean = false;\n  public updatingSubscribers: Boolean = false;\n\n  private ingestQueue: Array<Job> = [];\n  private completedJobs: Array<Job> = [];\n  private archivedJobs: Array<Job> = [];\n\n  // private collections: Object;\n  private config: Object;\n\n  constructor(private collections: Object, private global: Global) {\n    global.ingest = this.ingest.bind(this);\n    this.config = global.config;\n  }\n\n  public ingest(job: Job): void {\n    if (this.ingestQueue.length > 0) {\n      // check if this job is already queued, if so defer to bottom of stack\n      const alreadyInQueueAt = this.ingestQueue.findIndex(\n        item =>\n          item.type === job.type &&\n          item.collection === job.collection &&\n          item.property === job.property\n      );\n      if (alreadyInQueueAt) {\n        // remove from queue at index\n        this.ingestQueue.splice(alreadyInQueueAt, 1);\n      }\n    }\n    this.ingestQueue.push(job);\n    if (!this.running) {\n      this.findNextJob();\n    }\n  }\n\n  private findNextJob() {\n    this.running = true;\n    let next = this.ingestQueue.shift();\n\n    // non public data properties such as groups, filters and indexes will not have their dep, so get it.\n    if (!next.dep)\n      next.dep = this.collections[next.collection].public.getDep(next.property);\n\n    // execute the next task in the queue\n    this.performJob(next);\n  }\n\n  private performJob(job: Job): void {\n    switch (job.type) {\n      case JobType.PUBLIC_DATA_MUTATION:\n        this.performPublicDataUpdate(job);\n        break;\n      case JobType.INTERNAL_DATA_MUTATION:\n        this.performInternalDataUpdate(job);\n        break;\n      case JobType.BULK_INTERNAL_DATA_MUTATION:\n        // this.performInternalDataUpdate(collection, property, value);\n        break;\n      case JobType.INDEX_UPDATE:\n        this.performIndexUpdate(job);\n        break;\n      case JobType.FILTER_REGEN:\n        this.performFilterOutput(job);\n        break;\n      case JobType.GROUP_UPDATE:\n        this.performGroupRebuild(job);\n        break;\n      case JobType.DELETE_INTERNAL_DATA:\n        this.performInternalDataDeletion(job);\n        break;\n      default:\n        break;\n    }\n\n    // run watcher if it exists\n    if (this.collections[job.collection].watchers[job.property]) {\n      // log(\"Running WATCHER for\", property);\n      this.collections[job.collection].watchers[job.property]();\n    }\n    if (this.collections[job.collection].externalWatchers[job.property]) {\n      this.collections[job.collection].externalWatchers[job.property]();\n    }\n\n    // unpack dependent filters\n    if (job.dep && job.dep.dependents.size > 0) {\n      // log(`Queueing ${dep.dependents.size} dependents`);\n      job.dep.dependents.forEach(filter => {\n        // get dep from public filter output\n        this.ingest({\n          type: JobType.FILTER_REGEN,\n          collection: filter.collection,\n          property: filter,\n          dep: this.collections[filter.collection].public.getDep(filter.name)\n        });\n      });\n    }\n\n    this.finished();\n  }\n\n  private finished(): void {\n    this.running = false;\n    if (this.completedJobs.length > 100) return;\n\n    // If there's already more stuff in the queue, loop.\n    if (this.ingestQueue.length > 0) {\n      this.findNextJob();\n      return;\n    }\n\n    // Wait until callstack is empty to check if we should finalise this body of work\n    setTimeout(() => {\n      if (this.ingestQueue.length === 0) {\n        if (!this.updatingSubscribers) this.compileComponentUpdates();\n        this.cleanup();\n      } else {\n        // loop more!\n        this.findNextJob();\n      }\n    });\n  }\n\n  // Jobs runtime can perform\n  private performPublicDataUpdate(job: Job): void {\n    this.writeToPublicObject(job.collection, 'data', job.property, job.value);\n    this.completedJob(job);\n  }\n  private performInternalDataUpdate(job: Job): void {\n    job.previousValue = this.overwriteInternalData(\n      job.collection,\n      job.property,\n      job.value\n    );\n    // only look for indexes if we're not collecting data\n    if (!this.global.collecting)\n      this.findIndexesToUpdate(job.collection, job.property);\n    this.completedJob(job);\n  }\n\n  private performInternalDataDeletion(job: Job): void {\n    const c = this.collections[job.collection];\n    // preserve previous value\n    job.previousValue = { ...c.internalData[job.property] };\n    // delete data\n    delete c.internalData[job.property];\n    // find indexes affected by this data deletion\n    const indexesToUpdate = this.searchIndexes(job.collection, job.property);\n\n    // for each found index, perform index update\n    for (let i = 0; i < indexesToUpdate.length; i++) {\n      const indexName = indexesToUpdate[i];\n      const newIndex = [...c.indexes.object[indexName]].filter(\n        id => id !== job.property\n      );\n      this.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: c.name,\n        property: indexName,\n        value: newIndex,\n        dep: this.collections[job.collection].public.getDep(job.property)\n      });\n    }\n    this.completedJob(job);\n  }\n  private performIndexUpdate(job: Job): void {\n    // preserve old index\n    job.previousValue = this.collections[job.collection].indexes[job.property];\n    // Update Index\n    this.collections[job.collection].indexes.privateWrite(\n      job.property,\n      job.value\n    );\n    this.completedJob(job);\n\n    // Group must also be updated\n    this.ingest({\n      type: JobType.GROUP_UPDATE,\n      collection: job.collection,\n      property: job.property,\n      dep: this.collections[job.collection].public.getDep(job.property)\n    });\n  }\n  private performGroupRebuild(job: Job): void {\n    job.value = this.collections[job.collection].buildGroupFromIndex(\n      job.property\n    );\n    this.ingestForeignRelatedGroups(job.collection, job.property);\n    this.writeToPublicObject(job.collection, 'group', job.property, job.value);\n    this.completedJob(job);\n  }\n  public performFilterOutput(job: Job): void {\n    const filter =\n      typeof job.property === 'string'\n        ? this.collections[job.collection].filters[job.property]\n        : job.property;\n\n    job.value = filter.run();\n\n    console.log(job);\n    // Commit Update\n    this.writeToPublicObject(job.collection, 'filters', filter.name, job.value);\n    this.completedJob(job);\n  }\n\n  // Handlers for committing updates\n  private writeToPublicObject(\n    collection: string,\n    type: string,\n    key: string,\n    value: any\n  ): void {\n    if (type === 'indexes') {\n      if (!this.collections[collection][type].object.hasOwnProperty(key))\n        return;\n      this.collections[collection][type].privateWrite(key, value);\n    } else {\n      if (!this.collections[collection].public.object.hasOwnProperty(key))\n        return;\n      this.collections[collection].public.privateWrite(key, value);\n    }\n  }\n\n  private completedJob(job: Job): void {\n    job.fromAction = this.global.runningAction;\n    if (this.global.initComplete) this.completedJobs.push(job);\n    this.persistData(job);\n  }\n\n  private compileComponentUpdates(): void {\n    if (!this.global.initComplete) return;\n    this.updatingSubscribers = true;\n    console.log('ALL JOBS COMPLETE', this.completedJobs);\n    console.log('Updating components...');\n\n    const componentsToUpdate = {};\n\n    const subscribe = (value, subscribers) => {\n      for (let i = 0; i < subscribers.length; i++) {\n        const uuid = subscribers[i].componentUUID;\n        const key = subscribers[i].key;\n        if (!componentsToUpdate[uuid]) {\n          componentsToUpdate[uuid] = {};\n          componentsToUpdate[uuid][key] = value;\n        } else {\n          componentsToUpdate[uuid][key] = value;\n        }\n      }\n    };\n\n    for (let i = 0; i < this.completedJobs.length; i++) {\n      const job = this.completedJobs[i];\n      if (job.dep) subscribe(job.value, job.dep.subscribers);\n    }\n\n    console.log(componentsToUpdate);\n    // this.updateSubscribers(componentsToUpdate)\n  }\n\n  private updateSubscribers(componentsToUpdate) {\n    const componentKeys = Object.keys(componentsToUpdate);\n    for (let i = 0; i < componentKeys.length; i++) {\n      const componentID = componentKeys[i];\n      const data = componentsToUpdate[componentID];\n      const dataKeys = Object.keys(data);\n      dataKeys.forEach(property => {\n        const value = data[property];\n      });\n    }\n  }\n\n  private persistData(job: Job): void {\n    if (job.type === JobType.INTERNAL_DATA_MUTATION) return;\n    if (this.collections[job.collection].persist.includes(job.property)) {\n      this.global.storage.set(job.collection, job.property, job.value);\n    }\n  }\n\n  private cleanup(): void {\n    setTimeout(() => {\n      this.updatingSubscribers = false;\n    });\n  }\n\n  private findIndexesToUpdate(collection, keys): void {\n    const foundIndexes = new Set();\n    const c = this.collections[collection];\n\n    if (!Array.isArray(keys)) keys = [keys];\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const searchIndexes = this.searchIndexes(collection, key);\n      searchIndexes.forEach(index => foundIndexes.add(index));\n    }\n\n    foundIndexes.forEach(index => {\n      this.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: c.name,\n        property: index\n        // FIND DEP\n      });\n    });\n  }\n  // when groups are rebuilt, find other groups that are dependent on this group\n  // (defined using \"hasMany\" in the model) and ingest those groups into the queue.\n  private ingestForeignRelatedGroups(collection: string, groupName: string) {\n    let relations = this.collections[collection].foreignGroupRelations;\n    objectLoop(relations, (relationKey, relation) => {\n      if (relationKey === groupName)\n        this.ingest({\n          type: JobType.GROUP_UPDATE,\n          collection: relation.collection,\n          property: relation.groupToRegen,\n          dep: this.collections[relation.collection].public.getDep(\n            relation.groupToRegen\n          )\n        });\n    });\n  }\n\n  private searchIndexes(\n    collection: string,\n    primaryKey: string | number\n  ): Array<string> {\n    const c = this.collections[collection];\n\n    let foundIndexes = [];\n    for (let i = 0; i < c.keys.indexes.length; i++) {\n      const indexName = c.keys.indexes[i];\n      if (c.indexes[indexName].includes(primaryKey))\n        foundIndexes.push(indexName);\n    }\n    return foundIndexes;\n  }\n\n  private overwriteInternalData(\n    collection: string,\n    primaryKey: string | number,\n    newData: any\n  ): object | boolean {\n    const currentData = Object.assign(\n      {},\n      this.collections[collection].internalData[primaryKey]\n    );\n    if (currentData[primaryKey]) {\n      // data already exists, merge objects and return previous object\n      const keys = Object.keys(newData);\n      for (let i = 0; i < keys.length; i++) {\n        const property = keys[i];\n        this.collections[collection].internalData[primaryKey][property] =\n          newData[property];\n      }\n      return currentData;\n    } else {\n      // data does not exist, write and return false\n      this.collections[collection].internalData[primaryKey] = newData;\n      return false;\n    }\n  }\n}\n","import { Global } from \"./interfaces\";\n\nexport default class Dep {\n  public dependents: any = new Set();\n  public subscribers: Array<object> = [];\n\n  constructor(\n    private global: Global,\n    public name: string,\n    public rootProperty: string,\n    public propertyOnObject: string\n  ) {}\n\n  register() {\n    const subs = this.global.subs;\n\n    if (this.global.runningFilter) {\n      this.dependents.add(this.global.runningFilter);\n    }\n    if (subs.subscribingComponent) {\n      this.subscribeComponent();\n    }\n    if (subs.unsubscribingComponent) {\n      // this.subscribers.delete(this.global.subscribingComponent);\n    }\n  }\n\n  subscribeComponent() {\n    const subs = this.global.subs;\n\n    if (this.rootProperty && subs.skimmingDeepReactive) {\n      subs.prepareNext(this);\n      return;\n    }\n    if (this.rootProperty) {\n      subs.foundDeepReactive();\n      subs.prepareNext(this);\n      return;\n    }\n    if (!this.rootProperty && subs.skimmingDeepReactive) {\n      subs.exitDeepReactive();\n    }\n\n    this.subscribe();\n\n    subs.prepareNext(this);\n  }\n  subscribe() {\n    const subs = this.global.subs;\n    const keys = subs.subscribingComponent.keys;\n    const key = keys[subs.subscribingComponentKey];\n    const component = {\n      componentUUID: subs.subscribingComponent.componentUUID,\n      key: key\n    };\n    this.subscribers.push(component);\n  }\n}\n","import { protectedNames, arrayFunctions, isWatchableObject } from './helpers';\nimport Dep from './dep';\nimport { Global } from './interfaces';\n\ninterface Obj {\n  [key: string]: any;\n}\n\nexport default class Reactive {\n  public properties: Array<string>;\n  public object: Obj;\n  private dispatch: any;\n  private allowPrivateWrite: boolean = false;\n  private touching: boolean = false;\n  private touched: null | Dep;\n\n  constructor(\n    object: Obj = {},\n    private global: Global,\n    private collection: string,\n    public mutable: Array<string>,\n    public type: string\n  ) {\n    this.dispatch = this.global.dispatch;\n    this.properties = Object.keys(object);\n\n    this.object = this.reactiveObject(object);\n  }\n\n  reactiveObject(object: Obj, rootProperty?: string): object {\n    const self = this;\n    const objectKeys = Object.keys(object);\n\n    // Loop over all properties of the to-be reactive object\n    for (let i = 0; i < objectKeys.length; i++) {\n      const key = objectKeys[i];\n      const rootProperty = object.rootProperty;\n      const currentProperty = key;\n      let value = object[key];\n\n      // If property is an array, make it reactive\n      if (Array.isArray(value)) {\n        value = this.reactiveArray(value, key);\n        // if property is an object, make it reactive also\n      } else if (isWatchableObject(value) && !protectedNames.includes(key)) {\n        // rootProperty should be the current key if first deep object\n        value = this.deepReactiveObject(\n          value,\n          rootProperty || key,\n          currentProperty\n        );\n      }\n\n      // Create an instance of the dependency tracker\n      const dep = new Dep(this.global, key, rootProperty, currentProperty);\n\n      Object.defineProperty(object, key, {\n        get: function pulseGetter() {\n          if (self.touching) {\n            self.touched = dep;\n            return;\n          }\n          dep.register();\n          return value;\n        },\n        set: function pulseSetter(newValue) {\n          // rootProperty indicates if the object is \"deep\".\n          if (rootProperty && self.mutable.includes(rootProperty)) {\n            // mutate locally\n            value = newValue;\n            // dispatch mutation for rootProperty\n            self.dispatch('mutation', {\n              collection: self.collection,\n              key: rootProperty,\n              value: self.object[rootProperty],\n              dep: dep\n            });\n          } else {\n            // if backdoor open or is protected name, allow direct mutation\n            if (self.allowPrivateWrite || protectedNames.includes(key))\n              return (value = newValue);\n\n            // if property is mutable dispatch update\n            if (self.mutable.includes(key)) {\n              self.dispatch('mutation', {\n                collection: self.collection,\n                key,\n                value: newValue,\n                dep: dep\n              });\n              // we did not apply the mutation since runtime will privatly\n              // write the result since we dispatched above\n            }\n          }\n        }\n      });\n    }\n    return object;\n  }\n\n  deepReactiveObject(value, rootProperty?: string, propertyOnObject?: string) {\n    let objectWithCustomPrototype = Object.create({\n      rootProperty,\n      propertyOnObject\n    });\n    // repopulate custom object with incoming values\n    const keys = Object.keys(value);\n    for (let i = 0; i < keys.length; i++) {\n      const property = keys[i];\n      objectWithCustomPrototype[property] = value[property];\n    }\n\n    this.allowPrivateWrite = true;\n    const obj = this.reactiveObject(objectWithCustomPrototype, rootProperty);\n    this.allowPrivateWrite = false;\n    return obj;\n  }\n\n  reactiveArray(array, key) {\n    const self = this;\n    const reactiveArray = array.slice();\n\n    for (let i = 0; i < arrayFunctions.length; i++) {\n      const func = arrayFunctions[i];\n      const original = Array.prototype[func];\n      Object.defineProperty(reactiveArray, func, {\n        value: function() {\n          const result = original.apply(this, arguments);\n          if (self.global.initComplete)\n            self.dispatch('mutation', {\n              collection: self.collection,\n              key,\n              value: result\n            });\n          return result;\n        }\n      });\n    }\n    return reactiveArray;\n  }\n\n  privateWrite(property, value) {\n    this.allowPrivateWrite = true;\n    this.object[property] = value;\n    this.allowPrivateWrite = false;\n  }\n\n  privateGetValue(property) {\n    return this.object[property];\n  }\n\n  exists(property: string): boolean {\n    return !!this.object.hasOwnProperty(property);\n  }\n\n  getDep(property) {\n    this.touching = true;\n    const _ = this.object[property]; // eslint-disable-line no-unused-var\n    const dep = this.touched;\n    this.touching = false;\n    return dep;\n  }\n}\n\n// look for filter output access to determine dependencies\n// remove filter categories from public object on default config\n","import { uuid } from \"./helpers\";\nimport { Global } from \"./interfaces\";\n\nexport default class Action {\n  public executing: boolean = false;\n  public uuid: string;\n  public exec: () => {};\n\n  constructor(\n    private collection: string,\n    private global: Global,\n    public action: any,\n    public actionName: string\n  ) {\n    this.uuid = uuid();\n    this.prepare(action, global, this.global.contextRef.undo);\n  }\n\n  prepare(action, global, undo) {\n    const _this = this;\n\n    this.exec = function() {\n      const context = global.getContext(_this.collection);\n      context.undo = error => {\n        return undo(this.actionName, this.uuid, error);\n      };\n      global.runningAction = _this;\n\n      _this.executing = true;\n\n      const result = action.apply(\n        null,\n        [context].concat(Array.prototype.slice.call(arguments))\n      );\n\n      _this.executing = false;\n      global.runningAction = false;\n\n      return result;\n    };\n  }\n}\n","import { Global } from './interfaces';\n\nexport default class Filter {\n  public relatedToGroup: Array<any> = [];\n  public relatedToInternalData: Array<any> = [];\n\n  constructor(\n    private global: Global,\n    public collection: string,\n    public name: string,\n    private filterFunction: (context: object) => any\n  ) {}\n\n  public run() {\n    // cleanup before running\n    this.relatedToGroup = [];\n    this.relatedToInternalData = [];\n\n    this.global.runningFilter = this;\n\n    let output = this.filterFunction(this.global.getContext(this.collection));\n\n    if (output === undefined || output === null) output = false;\n\n    this.global.runningFilter = false;\n\n    return output;\n  }\n\n  addRelationToGroup(collectionName: string, groupName: string): void {\n    const parsed = JSON.stringify({\n      collection: collectionName,\n      group: groupName\n    });\n    if (!this.relatedToGroup.includes(parsed)) this.relatedToGroup.push(parsed);\n  }\n  addRelationToInternalData(collectionName: string, primaryKey: string): void {\n    const parsed = JSON.stringify({\n      collection: collectionName,\n      primaryKey\n    });\n    if (!this.relatedToInternalData.includes(parsed))\n      this.relatedToInternalData.push(parsed);\n  }\n}\n","import {\n  assert,\n  defineConfig,\n  validateNumber,\n  collectionFunctions,\n  objectLoop\n} from './helpers';\nimport Reactive from './reactive';\nimport Action from './action';\nimport Filter from './filter';\nimport {\n  Methods,\n  Keys,\n  CollectionObject,\n  CollectionConfig,\n  Global,\n  JobType,\n  ExpandableObject\n} from './interfaces';\n\nexport default class Collection {\n  private namespace: CollectionObject;\n  public public: Reactive;\n  public indexes: Reactive;\n  public config: CollectionConfig = {};\n  public keys: Keys = {};\n  public methods: Methods = {};\n\n  public actions: { [key: string]: Action } = {};\n  public filters: { [key: string]: Filter } = {};\n  public watchers: { [key: string]: any } = {};\n  public externalWatchers: { [key: string]: any } = {};\n  public persist: Array<string> = [];\n\n  public collectionSize: number = 0;\n  public primaryKey: string | number | boolean = false;\n\n  private internalData: object = {};\n\n  private dataRelations: { [key: string]: any } = {};\n  private groupRelations: { [key: string]: any } = {};\n  public foreignGroupRelations: { [key: string]: any } = {};\n\n  dispatch: void;\n\n  constructor(\n    public name: string,\n    protected global: Global,\n    root: CollectionObject\n  ) {\n    this.config = root.config;\n    this.dispatch = this.global.dispatch;\n\n    root = this.prepareNamespace(root);\n\n    this.initReactive(root.data, root.groups);\n    this.initRoutes(root.routes);\n    this.initActions(root.actions);\n    this.initWatchers(root.watch);\n    this.initFilters(root.filters);\n\n    this.initModel(root.model);\n    this.initPersist(root.persist);\n  }\n\n  prepareNamespace(root: CollectionObject) {\n    // map collection methods\n    collectionFunctions.map(\n      func => (this.methods[func] = this[func].bind(this))\n    );\n\n    // for each type set default and register keys\n    ['data', 'actions', 'filters', 'indexes', 'routes', 'watch'].forEach(\n      type => {\n        if (type !== 'indexes' && !root[type]) root[type] = {};\n        this.keys[type] =\n          type === 'indexes' ? root[type] || [] : Object.keys(root[type]);\n      }\n    );\n\n    // assign namespace, this is used by initReactive\n    this.namespace = Object.assign(\n      Object.create({ ...this.methods }), // bind methods to prototype\n      {\n        routes: {},\n        indexes: {},\n        actions: root.actions,\n        ...root.filters,\n        ...root.data,\n        ...this.normalizeGroups(root.groups)\n      }\n    );\n    return root;\n  }\n\n  // groups are defined by the user as an array of strings, this converts them into object/keys\n  normalizeGroups(groupsAsArray: any = []) {\n    const groups: object = {};\n    for (let i = 0; i < groupsAsArray.length; i++) {\n      const groupName = groupsAsArray[i];\n      groups[groupName] = [];\n    }\n    return groups;\n  }\n\n  initReactive(data: object = {}, groups: object = {}) {\n    // Make indexes reactive\n    this.indexes = new Reactive(\n      groups, // object\n      this.global, // global\n      this.name, // collection\n      this.keys.indexes, // mutable\n      'indexes' // type\n    );\n    this.namespace.indexes = this.indexes.object;\n\n    // Make entire public object Reactive\n    this.public = new Reactive(\n      this.namespace,\n      this.global,\n      this.name,\n      [...this.keys.data, ...this.keys.indexes],\n      'root'\n    );\n  }\n\n  initPersist(persist: Array<string>): void {\n    if (!Array.isArray(persist)) return;\n    for (let i = 0; i < persist.length; i++) {\n      const dataName = persist[i];\n\n      // TODO: validate\n\n      this.persist.push(dataName);\n      let data = this.global.storage.get(this.name, dataName);\n      if (data === undefined || data === null) continue;\n      this.public.privateWrite(dataName, data);\n    }\n  }\n\n  initActions(actions: object = {}) {\n    let actionKeys = Object.keys(actions);\n    for (let i = 0; i < actionKeys.length; i++) {\n      const action = actions[actionKeys[i]];\n      this.actions[actionKeys[i]] = new Action(\n        this.name,\n        this.global,\n        action,\n        actionKeys[i]\n      );\n\n      this.public.privateWrite(actionKeys[i], this.actions[actionKeys[i]].exec);\n    }\n  }\n\n  initWatchers(watchers: object = {}) {\n    let watcherKeys = Object.keys(watchers);\n    for (let i = 0; i < watcherKeys.length; i++) {\n      const watcher = watchers[watcherKeys[i]];\n      this.watchers[watcherKeys[i]] = () => {\n        this.global.runningWatcher = {\n          collection: this.name,\n          property: watcherKeys[i]\n        };\n        const watcherOutput = watcher(this.global.getContext(this.name));\n        this.global.runningWatcher = false;\n        return watcherOutput;\n      };\n    }\n    this.watchers._keys = watcherKeys;\n  }\n\n  initFilters(filters: object): void {\n    this.filters = {};\n    objectLoop(\n      filters,\n      (filterName: string, filterFunction: () => void) => {\n        this.filters[filterName] = new Filter(\n          this.global,\n          this.name,\n          filterName,\n          filterFunction\n        );\n        this.public.object[filterName] = [];\n      },\n      this.keys.filters\n    );\n  }\n\n  initRoutes(routes: ExpandableObject) {\n    const self = this;\n    const routeWrapped = routeName => {\n      return function() {\n        let requestObject = Object.assign({}, self.global.request);\n        requestObject.context = self.global.getContext();\n        return routes[routeName].apply(\n          null,\n          [self.global.request].concat(Array.prototype.slice.call(arguments))\n        );\n      };\n    };\n    objectLoop(\n      routes,\n      routeName =>\n        (this.public.object.routes[routeName] = routeWrapped(routeName))\n    );\n  }\n\n  initModel(model = {}) {\n    Object.keys(model).forEach(property => {\n      Object.keys(model[property]).forEach(config => {\n        if (config === 'primaryKey') {\n          this.primaryKey = property;\n        } else if (config === 'type') {\n          // if (\n          //   [\n          //     'string',\n          //     'boolean',\n          //     'integer',\n          //     'number',\n          //     'array',\n          //     'object'\n          //   ].includes(model[property].type)\n          // ) {\n          //   // model types are properties of the model to type check & validate on collect\n          //   if (!this._modelTypes.includes(property)) {\n          //     this._modelTypes.push(property);\n          //   }\n          // }\n        } else if (config === 'parent' || config === 'hasOne') {\n          this.createDataRelation(\n            property,\n            model[property].parent || model[property].hasOne,\n            model[property].assignTo\n          );\n        } else if (config === 'has' || config === 'hasMany') {\n          this.createGroupRelation(\n            property,\n            model[property].has || model[property].hasMany,\n            model[property].assignTo\n          );\n        }\n      });\n    });\n  }\n\n  createDataRelation(primaryKeyName, fromCollectionName, assignTo) {\n    this.dataRelations[primaryKeyName] = {};\n    this.dataRelations[primaryKeyName].fromCollectionName = fromCollectionName;\n    if (assignTo) this.dataRelations[primaryKeyName].assignTo = assignTo;\n  }\n\n  createGroupRelation(primaryKeyName, fromCollectionName, assignTo) {\n    this.groupRelations[primaryKeyName] = {};\n    this.groupRelations[primaryKeyName].fromCollectionName = fromCollectionName;\n    if (assignTo) this.groupRelations[primaryKeyName].assignTo = assignTo;\n  }\n\n  buildGroupFromIndex(groupName: string): Array<number> {\n    // console.log(collection, key)\n    const constructedArray = [];\n    let index = this.indexes.object[groupName];\n    for (let i = 0; i < index.length; i++) {\n      let id = index[i];\n      let data = Object.keys({}, this.internalData[id]);\n      if (!data) continue;\n      data = this.injectDataByRelation(data);\n      data = this.injectGroupByRelation(data, groupName);\n      constructedArray.push(data);\n    }\n    return constructedArray;\n  }\n\n  injectDataByRelation(data) {\n    let relations = Object.keys(this.dataRelations);\n    if (relations.length > 0)\n      for (let i = 0; i < relations.length; i++) {\n        const relationKey = relations[i];\n        const rel = this.dataRelations[relationKey];\n        const assignTo = rel.hasOwnProperty('assignTo') ? rel.assignTo : false;\n\n        if (data.hasOwnProperty(relationKey)) {\n          let foreignData = this.global.contextRef[rel.fromCollectionName][\n            data[relationKey]\n          ];\n\n          if (foreignData) {\n            if (assignTo) data[assignTo] = foreignData;\n            else data[rel.fromCollectionName] = foreignData;\n          }\n        }\n      }\n    return data;\n  }\n\n  injectGroupByRelation(data, groupName) {\n    let groupRealtions = Object.keys(this.groupRelations);\n    if (groupRealtions.length > 0)\n      for (let i = 0; i < groupRealtions.length; i++) {\n        const relationKey = groupRealtions[i];\n        const rel = this.groupRelations[relationKey];\n\n        const assignTo = rel.hasOwnProperty('assignTo') ? rel.assignTo : false;\n\n        if (data.hasOwnProperty(relationKey)) {\n          const foreignData = this.global.contextRef[rel.fromCollectionName][\n            data[relationKey]\n          ];\n\n          if (foreignData) {\n            if (assignTo) data[assignTo] = foreignData;\n            else data[rel.fromCollectionName] = foreignData;\n          }\n\n          // register this relation on the foreign collection for reactive updates\n          this.global.createForeignGroupRelation(\n            rel.fromCollectionName,\n            data[relationKey],\n            this.name,\n            groupName\n          );\n        }\n      }\n    return data;\n  }\n\n  createGroups(group) {\n    if (!Array.isArray(group)) group = [group];\n    for (let i = 0; i < group.length; i++) {\n      const groupName = group[i];\n      if (!this.indexes.object[groupName]) {\n        this.indexes.object[groupName] = [];\n      }\n    }\n    return group;\n  }\n\n  // METHODS\n  collect(data, group?: string, config?: ExpandableObject) {\n    config = defineConfig(config, {\n      append: true\n    });\n    this.global.collecting = true;\n    // normalise data\n    if (!Array.isArray(data)) data = [data];\n    const groups = this.createGroups(group);\n    const previousIndexValues = this.getPreviousIndexValues(groups);\n\n    // process data items\n    for (let i = 0; i < data.length; i++) {\n      const dataItem = data[i];\n      const dataProcessed = this.processDataItem(dataItem, groups, config);\n      if (dataProcessed) this.collectionSize++;\n    }\n\n    // dispatch regen indexes and groups\n    for (let i = 0; i < groups.length; i++) {\n      const groupName = groups[i];\n\n      // processDataItem takes care of adding the data, submit\n      this.global.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: this.name,\n        property: groupName,\n        value: this.indexes.object[groupName],\n        previousValue: previousIndexValues[groupName]\n      });\n    }\n\n    this.global.collecting = false;\n  }\n\n  processDataItem(dataItem, groups, config) {\n    if (!this.primaryKey) this.findPrimaryKey(dataItem);\n\n    const key = dataItem[this.primaryKey as number | string];\n\n    // validate against model\n\n    // ingest the data\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: key,\n      value: dataItem\n    });\n\n    // add the data to group indexes\n    for (let i = 0; i < groups.length; i++) {\n      const groupName = groups[i];\n      const index = [...this.indexes.object[groupName]];\n      if (config.append) index.push(key);\n      else index.unshift(key);\n      this.indexes.privateWrite(groupName, index);\n    }\n    return true;\n  }\n\n  getPreviousIndexValues(groups) {\n    const returnData = {};\n    for (let i = 0; i < groups; i++) {\n      const groupName = groups[i];\n      returnData[groupName] = this.indexes.object[groupName];\n    }\n    return returnData;\n  }\n\n  findPrimaryKey(dataItem) {\n    if (dataItem.hasOwnProperty('id')) this.primaryKey = 'id';\n    else if (dataItem.hasOwnProperty('_id')) this.primaryKey = '_id';\n    else if (dataItem.hasOwnProperty('key')) this.primaryKey = 'key';\n    if (this.primaryKey) return true;\n    else return assert(warn => warn.NO_PRIMARY_KEY);\n  }\n\n  replaceIndex(indexName: string, newIndex: Array<string | number>) {\n    if (!Array.isArray(newIndex) || typeof indexName !== 'string')\n      return assert(warn => warn.INVALID_PARAMETER, 'replaceIndex');\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: indexName,\n      value: newIndex\n    });\n  }\n\n  findById(id) {\n    if (!this.internalData.hasOwnProperty(id))\n      return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'findById');\n\n    if (this.global.runningFilter) {\n      let filter = this.global.runningFilter as Filter;\n      filter.addRelationToInternalData(this.name, id);\n    }\n    return this.internalData[id];\n  }\n\n  // action functions\n  undo() {}\n  throttle() {}\n\n  // group functions\n  move(\n    ids: number | Array<string | number>,\n    sourceIndexName: string,\n    destIndexName?: string,\n    method: 'push' | 'unshift' = 'push'\n  ) {\n    // validation\n    if (!this.indexes.exists(sourceIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\n\n    if (destIndexName && !this.indexes.exists(destIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\n\n    if (!Array.isArray(ids)) ids = [ids];\n\n    let sourceIndex = this.indexes.privateGetValue(sourceIndexName);\n    for (let i = 0; i < ids.length; i++) sourceIndex.map(id => id !== ids[i]);\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: sourceIndexName,\n      value: sourceIndex\n    });\n\n    if (destIndexName) {\n      let destIndex = this.indexes.privateGetValue(destIndexName);\n      for (let i = 0; i < ids.length; i++) destIndex[method](ids[i]);\n\n      this.global.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: this.name,\n        property: destIndexName,\n        value: destIndex\n      });\n    }\n  }\n\n  put(\n    ids: number | Array<string | number>,\n    destIndexName: string,\n    method: 'push' | 'unshift' = 'push'\n  ) {\n    // validation\n    if (!this.indexes.exists(destIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'put');\n\n    if (!Array.isArray(ids)) ids = [ids];\n\n    let destIndex = this.indexes.privateGetValue(destIndexName);\n    for (let i = 0; i < ids.length; i++) destIndex[method](ids[i]);\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: destIndexName,\n      value: destIndex\n    });\n  }\n\n  getGroup(property) {\n    if (!this.indexes.exists(property))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'group');\n\n    if (this.global.runningFilter) {\n      let filter = this.global.runningFilter as Filter;\n      filter.addRelationToGroup(this.name, property);\n    }\n    return this.buildGroupFromIndex(property) || [];\n  }\n  newGroup(groupName: string, indexValue?: Array<string | number>) {\n    if (this.indexes.object.hasOwnProperty(groupName))\n      return assert(warn => warn.GROUP_ALREADY_EXISTS, 'newGroup');\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: indexValue\n    });\n  }\n  deleteGroup(groupName: string) {\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: []\n    });\n  }\n  removeFromGroup(\n    groupName: string,\n    itemsToRemove: number | string | Array<number | string>\n  ) {\n    if (!this.indexes.exists(groupName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'group');\n\n    if (!Array.isArray(itemsToRemove)) itemsToRemove = [itemsToRemove];\n\n    const index = this.indexes.privateGetValue(groupName);\n\n    const newIndex = index.filter(\n      id => !(itemsToRemove as Array<number | string>).includes(id)\n    );\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: newIndex\n    });\n  }\n\n  // internal data functions\n  update(primaryKey: string | number, newObject: { [key: string]: any }) {\n    if (!this.internalData.hasOwnProperty(primaryKey))\n      return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'update');\n\n    const newObjectKeys = Object.keys(newObject);\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\n\n    for (let i = 0; i < newObjectKeys.length; i++) {\n      const key = newObjectKeys[i];\n      currentData[key] = newObject[key];\n    }\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: primaryKey,\n      value: currentData\n    });\n  }\n  increment(\n    primaryKey: string | number,\n    property: string,\n    amount: number,\n    decrement?: boolean\n  ) {\n    if (!this.internalData.hasOwnProperty(primaryKey))\n      return assert(\n        warn => warn.INTERNAL_DATA_NOT_FOUND,\n        decrement ? 'decrement' : 'increment'\n      );\n\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\n\n    if (!validateNumber(amount, currentData[primaryKey][property]))\n      return assert(\n        warn => warn.PROPERTY_NOT_A_NUMBER,\n        decrement ? 'decrement' : 'increment'\n      );\n\n    if (decrement) currentData[primaryKey][property] -= amount;\n    else currentData[primaryKey][property] += amount;\n\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: primaryKey,\n      value: currentData\n    });\n  }\n  decrement(primaryKey: string | number, property: string, amount: number) {\n    this.increment(primaryKey, property, amount, true);\n  }\n\n  delete(primaryKeys: string | number | Array<string | number>) {\n    if (!Array.isArray(primaryKeys)) primaryKeys = [primaryKeys];\n    for (let i = 0; i < primaryKeys.length; i++) {\n      const primaryKey = primaryKeys[i];\n      this.global.ingest({\n        type: JobType.DELETE_INTERNAL_DATA,\n        collection: this.name,\n        property: primaryKey\n      });\n    }\n  }\n\n  // remove all dynamic indexes, empty all indexes, delete all internal data\n  purge() {}\n\n  // external functions\n  watch(property, callback) {\n    if (!this.externalWatchers[property])\n      this.externalWatchers[property] = [callback];\n    else this.externalWatchers[property].push(callback);\n  }\n\n  // deprecate\n  remove() {}\n}\n","// This file handles external components subscribing to pulse.\n// It also handles subscribing mapData properties to collections\n\nimport { uuid } from \"./helpers\";\nimport { Global, ComponentContainer } from \"./interfaces\";\nimport Dep from \"./dep\";\n\ninterface SubscribingComponentObject {\n  componentUUID: string;\n  keys: Array<string>;\n}\n\nexport default class SubController {\n  private uuid: any = uuid;\n  private subscribingComponentKey: number = 0;\n  private subscribingComponent: boolean | SubscribingComponentObject = false;\n  private unsubscribingComponent: boolean = false;\n  private skimmingDeepReactive: boolean = false;\n  private lastAccessedDep: null | Dep = null;\n\n  public componentStore: { [key: string]: ComponentContainer } = {};\n\n  constructor(private getContext: any) {}\n\n  registerComponent(instance, config) {\n    let uuid = instance.__pulseUniqueIdentifier;\n    if (!uuid) {\n      // generate UUID\n      uuid = this.uuid();\n      // inject uuid into component instance\n      const componentContainer = {\n        instance: instance,\n        uuid,\n        ready: config.waitForMount ? false : true\n      };\n      instance.__pulseUniqueIdentifier = uuid;\n\n      this.componentStore[uuid] = componentContainer;\n    } else {\n      this.mount(instance);\n    }\n    return uuid;\n  }\n\n  mount(instance) {}\n\n  unmount(instance) {}\n\n  subscribePropertiesToComponents(properties, componentUUID) {\n    // provisionally get keys of mapped data\n    const provision = properties(this.getContext());\n    const keys = Object.keys(provision);\n\n    // mapData has a user defined local key, we need to include that in the subscription so we know what to update on the component later.\n    this.subscribingComponentKey = 0;\n    this.subscribingComponent = {\n      componentUUID,\n      keys\n    };\n    const returnToComponent = properties(this.getContext());\n    this.subscribingComponent = false;\n    this.subscribingComponentKey = 0;\n    return returnToComponent;\n  }\n  prepareNext(dep) {\n    this.lastAccessedDep = dep;\n    if (!this.skimmingDeepReactive) this.subscribingComponentKey++;\n  }\n  foundDeepReactive() {\n    this.skimmingDeepReactive = true;\n    // undo changes\n    this.lastAccessedDep.subscribers.pop();\n    this.subscribingComponentKey--;\n  }\n  exitDeepReactive() {\n    this.skimmingDeepReactive = false;\n    //redo changes\n    this.lastAccessedDep.subscribe();\n    this.subscribingComponentKey++;\n  }\n}\n","interface StorageMethods {\n  async?: boolean;\n  get?: any;\n  set?: any;\n  remove?: any;\n}\n\nexport default class Storage {\n  private isPromise: boolean = false;\n  private storageReady: boolean = false;\n  constructor(\n    private storageType: \"localStorage\" | \"custom\" = \"localStorage\",\n    private storageMethods: StorageMethods = {}\n  ) {\n    if (this.localStorageAvaliable() && storageType === \"localStorage\") {\n      this.storageReady = true;\n\n      storageMethods.get = localStorage.getItem.bind(localStorage);\n      storageMethods.set = localStorage.setItem.bind(localStorage);\n      storageMethods.remove = localStorage.removeItem.bind(localStorage);\n    } else {\n      this.storageType = \"custom\";\n      if (\n        this.check(storageMethods.get) &&\n        this.check(storageMethods.set) &&\n        this.check(storageMethods.remove)\n      ) {\n        this.storageReady = true;\n        if (storageMethods.async) this.isPromise = true;\n      } else {\n        this.storageReady = false;\n        // bad\n      }\n    }\n  }\n\n  public get(collection, key) {\n    if (!this.storageReady) return;\n\n    if (this.isPromise) {\n      return new Promise((resolve, reject) => {\n        this.storageMethods\n          .get(this.getKey(collection, key))\n          .then(res => {\n            if (typeof res !== \"string\") return resolve(res);\n            resolve(JSON.parse(res));\n          })\n          .catch(reject);\n      });\n    } else {\n      return this.storageMethods.get(this.getKey(collection, key));\n    }\n  }\n\n  public set(collection, key, value) {\n    if (!this.storageReady) return;\n    this.storageMethods.set(\n      this.getKey(collection, key),\n      typeof value === \"string\" ? value : JSON.stringify(value)\n    );\n  }\n\n  public remove(collection, key) {\n    if (!this.storageReady) return;\n    this.storageMethods.remove(this.getKey(collection, key));\n  }\n\n  private getKey(collection, key) {\n    return `_${collection}_${key}`;\n  }\n\n  private check(func) {\n    return typeof func !== \"function\";\n  }\n\n  private localStorageAvaliable() {\n    try {\n      localStorage.setItem(\"_\", \"_\");\n      localStorage.removeItem(\"_\");\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n}\n","import Collection from \"../collection\";\nimport { Global, ExpandableObject, RequestConfig } from \"../interfaces\";\n\ntype Method = \"get\" | \"put\" | \"post\" | \"patch\" | \"delete\";\n\nexport default class Request extends Collection {\n  private timeout: number;\n  private options: ExpandableObject;\n  private saveHistory: boolean;\n\n  private requestIntercept: (\n    context: ExpandableObject,\n    options: ExpandableObject\n  ) => void;\n  private responseIntercept: (\n    context: ExpandableObject,\n    response: ExpandableObject\n  ) => void;\n\n  constructor(global: Global, requestConfig: RequestConfig) {\n    // Before we invoke the parent class, we define some defaults\n    let groups = [];\n    let persist = [\"baseURL\"];\n    let data = {\n      baseURL: requestConfig.baseURL || null,\n      mode: \"cors\",\n      credentials: \"same-origin\",\n      headers: {\n        Accept: \"application/json\"\n      }\n    };\n\n    if (requestConfig.headers)\n      Object.keys(requestConfig.headers).forEach(header => {\n        data.headers[header] = requestConfig.headers[header];\n      });\n\n    if (requestConfig.credentials) data.credentials = requestConfig.credentials;\n    if (requestConfig.mode) data.mode = requestConfig.mode;\n\n    super(\"request\", global, { groups, data, persist });\n\n    this.requestIntercept = requestConfig.requestIntercept;\n    this.responseIntercept = requestConfig.responseIntercept;\n    this.timeout = requestConfig.timeout;\n    this.saveHistory =\n      typeof requestConfig.saveHistory === \"undefined\" ? true : false;\n\n    this.global.request = {\n      get: this.get.bind(this),\n      post: this.post.bind(this),\n      put: this._put.bind(this),\n      patch: this.patch.bind(this),\n      delete: this.delete.bind(this),\n      queryify: this.queryify.bind(this)\n    };\n  }\n\n  get(url: string, headers?: ExpandableObject) {\n    return this.send(url, \"get\", {}, headers);\n  }\n\n  post(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, \"post\", body, headers);\n  }\n\n  _put(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, \"put\", body, headers);\n  }\n\n  patch(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, \"patch\", body, headers);\n  }\n\n  delete(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, \"delete\", body, headers);\n  }\n\n  async send(\n    url: string,\n    method: Method,\n    body: ExpandableObject | string = {},\n    headers: ExpandableObject\n  ) {\n    const requestHeaders = Object.assign({}, this.public.object.headers);\n\n    if (headers)\n      Object.keys(headers).forEach(header => {\n        requestHeaders[header] = headers[header];\n      });\n\n    // If method is not get set application type\n    if (method !== \"get\" && requestHeaders[\"Content-Type\"] === undefined)\n      requestHeaders[\"Content-Type\"] = \"application/json\";\n\n    let fullURL;\n\n    if (url.startsWith(\"http\")) fullURL = url;\n    else fullURL = `${this.public.object.baseURL}/${url}`;\n\n    // Stringify body\n    body = JSON.stringify(body);\n\n    // Build options\n    this.options = {};\n    this.options.credentials = this.public.object.credentials;\n    this.options.mode = this.public.object.mode;\n\n    // Build final fetch options object\n    const options = Object.assign(\n      {\n        headers: requestHeaders,\n        method: method.toUpperCase(),\n        body: method === \"get\" ? null : body\n      },\n      this.options\n    );\n\n    if (this.requestIntercept)\n      this.requestIntercept(this.global.getContext(), options);\n\n    let response: any;\n\n    if (this.timeout) {\n      response = await Promise.race([\n        fetch(fullURL, options),\n        new Promise((resolve, reject) =>\n          setTimeout(() => reject(\"timeout\"), this.timeout)\n        )\n      ]);\n    } else {\n      response = await fetch(fullURL, options);\n    }\n\n    const contentType = response.headers.get(\"content-type\");\n\n    // extract body\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\n      body = await response.json();\n    } else {\n      body = await response.text();\n    }\n\n    // history\n    if (!this.saveHistory)\n      this.collect({\n        id: Date.now(),\n        status: response.status,\n        timestamp: new Date(),\n        response: body\n      });\n\n    // inject headers into prototype\n    let final;\n\n    // If reponse body is an object, create a custom object with response function in prototype, so headers and the full response data can be accessed outside of this class\n    if (!Array.isArray(body) && typeof body === \"object\") {\n      final = Object.create({\n        response: () => {\n          return response;\n        }\n      });\n      const keys = Object.keys(body);\n      for (let i = 0; i < keys.length; i++) {\n        const property = keys[i];\n        final[property] = body[property];\n      }\n      // if the body is not an object, we can not inject a prototype, so just return the rew body\n    } else {\n      final = body;\n    }\n    // intercept response\n    if (this.responseIntercept) {\n      response.data = body;\n      this.responseIntercept(this.global.getContext(), response);\n    }\n\n    // reject if bad response status\n    if (response.ok || response.redirected) return final;\n\n    // resolve response\n    throw final;\n  }\n\n  // Adapted from: https://github.com/Gozala/querystring/blob/master/encode.js\n  queryify(obj) {\n    const stringifyPrimitive = function(value) {\n      switch (typeof value) {\n        case \"string\":\n          return value;\n\n        case \"boolean\":\n          return value ? \"true\" : \"false\";\n\n        case \"number\":\n          return isFinite(value) ? value : \"\";\n\n        default:\n          return \"\";\n      }\n    };\n    // validate input\n    if (typeof obj != \"object\") return;\n\n    return Object.keys(obj)\n      .map(key => {\n        const encodedKey = encodeURIComponent(stringifyPrimitive(key)) + \"=\";\n        // if value is an array, encode with same key as parent\n        if (Array.isArray(obj[key]))\n          return obj[key]\n            .map(value => {\n              return encodedKey + encodeURIComponent(stringifyPrimitive(value));\n            })\n            .join(\"&\");\n        // join encoded key with value\n        return encodedKey + encodeURIComponent(stringifyPrimitive(obj[key]));\n      })\n      .join(\"&\");\n  }\n}\n","import Collection from \"../collection\";\nimport { Global, RootCollectionObject } from \"../interfaces\";\n\nexport default class Request extends Collection {\n  constructor(global: Global, root: RootCollectionObject = {}) {\n    root = Object.assign({}, root);\n\n    delete root.collections;\n    delete root.request;\n\n    if (!root.data) root.data = {};\n    if (!root.persist) root.persist = [];\n\n    root.data[\"isAuthenticated\"] = false;\n    root.data[\"appReady\"] = false;\n\n    root.persist.push(\"isAuthenticated\");\n\n    console.log(root);\n    super(\"base\", global, root);\n  }\n}\n","import Runtime from './runtime';\nimport Collection from './collection';\nimport SubController from './subController';\nimport Storage from './storage';\nimport Request from './collections/request';\nimport Base from './collections/base';\nimport { uuid, normalizeMap } from './helpers';\nimport {\n  Private,\n  RequestConfig,\n  RootCollectionObject,\n  JobType\n} from './interfaces';\n\nexport default class Library {\n  _private: Private;\n  [key: string]: any;\n\n  constructor(root: RootCollectionObject) {\n    this._private = {\n      runtime: null,\n      events: {},\n      global: {\n        config: root.config,\n        initComplete: false,\n        runningAction: false,\n        runningWatcher: false,\n        runningFilter: false,\n        collecting: false,\n        subs: new SubController(this.getContext.bind(this)),\n        storage: null,\n        dispatch: this.dispatch.bind(this),\n        getContext: this.getContext.bind(this),\n        createForeignGroupRelation: this.createForeignGroupRelation.bind(this),\n        contextRef: {},\n        uuid\n      }\n    };\n    // this.mapData = this._mapData.bind(this);\n    this._private.global.storage = new Storage();\n    this.initCollections(root);\n    this.initRuntime();\n    this.bindCollectionPublicData();\n    this.runAllFilters();\n    this._private.global.initComplete = true;\n    console.log('INIT COMPLETE');\n  }\n\n  runAllFilters() {\n    const collectionKeys = Object.keys(this._private.collections);\n    for (let i = 0; i < collectionKeys.length; i++) {\n      const collection = this._private.collections[collectionKeys[i]];\n\n      const filterKeys = collection.keys.filters;\n      for (let i = 0; i < filterKeys.length; i++) {\n        const filterName = filterKeys[i];\n        this._private.runtime.performFilterOutput({\n          collection: collection.name,\n          property: filterName,\n          type: JobType.FILTER_REGEN\n        });\n      }\n    }\n  }\n\n  initCollections(root: RootCollectionObject, request: RequestConfig = {}) {\n    this._private.collections = {};\n    let collectionKeys = Object.keys(root.collections);\n    for (let i = 0; i < collectionKeys.length; i++) {\n      const collection = root.collections[collectionKeys[i]];\n      this._private.collections[collectionKeys[i]] = new Collection(\n        collectionKeys[i],\n        this._private.global,\n        collection\n      );\n    }\n    if (this._private.global.config.enableRequest !== false)\n      this._private.collections['request'] = new Request(\n        this._private.global,\n        request\n      );\n    if (this._private.global.config.enableBase !== false)\n      this._private.collections['base'] = new Base(this._private.global, root);\n  }\n\n  initRuntime() {\n    this._private.runtime = new Runtime(\n      this._private.collections,\n      this._private.global\n    );\n  }\n\n  bindCollectionPublicData() {\n    let collectionKeys = Object.keys(this._private.collections);\n    for (let i = 0; i < collectionKeys.length; i++) {\n      const collection = this._private.collections[collectionKeys[i]];\n      this._private.global.contextRef[collectionKeys[i]] =\n        collection.public.object;\n      this[collectionKeys[i]] = collection.public.object;\n    }\n  }\n\n  dispatch(type: string, payload) {\n    switch (type) {\n      case 'mutation':\n        this._private.runtime.ingest({\n          type: JobType.PUBLIC_DATA_MUTATION,\n          collection: payload.collection,\n          property: payload.key,\n          value: payload.value,\n          dep: payload.dep\n        });\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  getContext(collection) {\n    const c = this._private.collections[collection];\n    if (!c) return this._private.global.contextRef;\n    return {\n      ...this._private.global.contextRef,\n      ...c.methods,\n      data: c.public.object,\n      indexes: c.indexes.object,\n      groups: c.public.object,\n      filters: c.public.object,\n      routes: c.public.object.routes\n    };\n  }\n\n  install(Vue) {\n    const pulse = this;\n    const config = pulse._private.global.config;\n    Vue.mixin({\n      beforeCreate() {\n        Object.keys(pulse.global.dataRef).forEach(collection => {\n          this['$' + collection] = pulse.global.dataRef[collection];\n        });\n\n        if (pulse.utils) this.$utils = pulse.utils;\n        if (pulse.services) this.$services = pulse.services;\n        if (pulse.staticData) this.$staticData = pulse.staticData;\n\n        this.mapData = properties =>\n          pulse.mapData(\n            properties,\n            this,\n            {\n              waitForMount: config.waitForMount\n            },\n            pulse\n          );\n      },\n      mounted() {\n        if (this.__pulseUniqueIdentifier && config.waitForMount)\n          pulse.mount(this);\n      },\n      beforeDestroy() {\n        if (this.__pulseUniqueIdentifier && config.autoUnmount)\n          pulse.unmount(this);\n      }\n    });\n  }\n\n  mapData(properties, instance = {}, _config = {}, pulseAlias?: any) {\n    let pulse = pulseAlias ? pulseAlias : this;\n    const config = {\n      waitForMount: true,\n      ..._config\n    };\n    const componentUUID = pulse._private.global.subs.registerComponent(\n      instance,\n      config\n    );\n    // new cool mapData method\n    if (typeof properties === 'function') {\n      return pulse._private.global.subs.subscribePropertiesToComponents(\n        properties,\n        componentUUID\n      );\n      // legacy support....\n    } else if (typeof properties === 'object') {\n      let returnData = {};\n      normalizeMap(properties).forEach(({ key, val }) => {\n        let collection = val.split('/')[0];\n        let property = val.split('/')[1];\n        let c = pulse._private.global.getContext()[collection];\n        returnData = pulse._private.global.subs.subscribePropertiesToComponents(\n          () => {\n            return { [key]: c[property] };\n          },\n          componentUUID\n        );\n      });\n      return returnData;\n    }\n  }\n\n  createForeignGroupRelation(\n    foreignCollection,\n    foreignData,\n    dependentCollection,\n    dependentGroup\n  ) {\n    this._private.collections[foreignCollection].foreignGroupRelations[\n      foreignData\n    ] = {\n      collection: dependentCollection,\n      groupToRegen: dependentGroup\n    };\n  }\n\n  emit(name: string, payload: any): void {\n    if (this._private.events[name])\n      for (let i = 0; i < this._private.events[name].length; i++) {\n        const callback = this._private.events[name][i];\n        callback(payload);\n      }\n  }\n  on(name: string, callback: () => any): void {\n    if (!Array.isArray(this._private.events[name]))\n      this._private.events[name] = [callback];\n    else this._private.events[name].push(callback);\n  }\n}\n"],"names":["tslib_1.__extends","Base"],"mappings":"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"}