{"version":3,"file":"pulse.min.js","sources":["../lib2/helpers.ts","../lib2/runtime.ts","../lib2/computed.ts","../lib2/relationController.ts","../lib2/dep.ts","../lib2/reactive.ts","../lib2/action.ts","../lib2/collection.ts","../lib2/subController.ts","../lib2/storage.ts","../lib2/collections/request.ts","../lib2/collections/base.ts","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/objectSpread.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../lib2/wrappers/ReactWithPulse.js","../lib2/library.ts"],"sourcesContent":["export const protectedNames = [\r\n  'data',\r\n  'indexes',\r\n  'groups',\r\n  'computed',\r\n  'actions',\r\n  'routes'\r\n];\r\n\r\nexport const collectionFunctions = [\r\n  'collect',\r\n  'replaceIndex',\r\n  'getGroup',\r\n  'newGroup',\r\n  'deleteGroup',\r\n  'removeFromGroup',\r\n  'update',\r\n  'increment',\r\n  'decrement',\r\n  'delete',\r\n  'purge',\r\n  'watch',\r\n  'findById',\r\n  'put',\r\n  'move',\r\n  'throttle',\r\n  // deprecated\r\n  'remove'\r\n];\r\n\r\nexport function defineConfig(config, defaults) {\r\n  return { ...defaults, ...config };\r\n}\r\n\r\nexport function parse(key: string) {\r\n  return {\r\n    collection: key.split('/')[0],\r\n    primaryKey: key.split('/')[1]\r\n  };\r\n}\r\n\r\nexport function uuid() {\r\n  return (\r\n    Math.random()\r\n      .toString()\r\n      .split('.')[1] + Date.now()\r\n  );\r\n}\r\n\r\nexport function objectLoop(object, callback, keys?: Array<any>) {\r\n  const objectKeys = keys ? keys : Object.keys(object);\r\n  for (let i = 0; i < objectKeys.length; i++) {\r\n    const key: string = objectKeys[i];\r\n    const value: any = object[key];\r\n    callback(key, value, objectKeys);\r\n  }\r\n}\r\n\r\n// const thing = {}\r\n// objectLoop(thing, (thingKey, thingItem) => {\r\n\r\n// })\r\n\r\nexport function log(value: any, payload?: any) {\r\n  // console.log(`Pulse / ${value}`, payload ? payload : ' ');\r\n}\r\nexport function key(collection: string, property?: string | number) {\r\n  return `${collection}/${property}`;\r\n}\r\n\r\nexport function normalizeMap(map) {\r\n  return Array.isArray(map)\r\n    ? map.map(key => ({ key, val: key }))\r\n    : Object.keys(map).map(key => ({ key, val: map[key] }));\r\n}\r\n\r\nexport const arrayFunctions = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'splice',\r\n  'sort',\r\n  'reverse'\r\n];\r\n\r\nexport function assert(\r\n  func: (warnings: { [key: string]: any }) => any,\r\n  funcName?: string\r\n) {\r\n  function warn(message) {\r\n    // if (funcName) console.log(`PULSE // \"${funcName}()\" :: ${message}`);\r\n    // else console.warn(`PULSE :: ${message}`);\r\n    return false;\r\n  }\r\n  const warnings = {\r\n    NO_PRIMARY_KEY: () => warn('No primary $1 key found! $2'),\r\n    INVALID_PARAMETER: () => warn('Invalid parameter supplied to function.'),\r\n    INDEX_NOT_FOUND: () => warn('Index was not found on collection.'),\r\n    INTERNAL_DATA_NOT_FOUND: () => warn('Data was not found on collection.'),\r\n    PROPERTY_NOT_A_NUMBER: () => warn('Property is not a number!')\r\n  };\r\n  return func(warnings)();\r\n}\r\n\r\nexport function isWatchableObject(value) {\r\n  function isHTMLElement(obj) {\r\n    try {\r\n      return obj instanceof HTMLElement;\r\n    } catch (e) {\r\n      return (\r\n        typeof obj === 'object' &&\r\n        obj.nodeType === 1 &&\r\n        typeof obj.style === 'object' &&\r\n        typeof obj.ownerDocument === 'object'\r\n      );\r\n    }\r\n  }\r\n  let type = typeof value;\r\n  return (\r\n    value != null &&\r\n    type == 'object' &&\r\n    !isHTMLElement(value) &&\r\n    !Array.isArray(value)\r\n  );\r\n}\r\n\r\nexport function validateNumber(mutable, amount) {\r\n  if (typeof amount !== 'number' || typeof mutable !== 'number') {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n","import { log, objectLoop, log } from './helpers';\r\nimport { Job, Global } from './interfaces';\r\nimport Dep from './Dep';\r\n\r\nexport enum JobType {\r\n  PUBLIC_DATA_MUTATION = 'PUBLIC_DATA_MUTATION',\r\n  INTERNAL_DATA_MUTATION = 'INTERNAL_DATA_MUTATION',\r\n  INDEX_UPDATE = 'INDEX_UPDATE',\r\n  COMPUTED_REGEN = 'COMPUTED_REGEN',\r\n  GROUP_UPDATE = 'GROUP_UPDATE',\r\n  DEEP_PUBLIC_DATA_MUTATION = 'DEEP_PUBLIC_DATA_MUTATION',\r\n  DELETE_INTERNAL_DATA = 'DELETE_INTERNAL_DATA'\r\n}\r\nexport default class Runtime {\r\n  public running: Boolean = false;\r\n  public updatingSubscribers: Boolean = false;\r\n\r\n  private ingestQueue: Array<Job> = [];\r\n  private completedJobs: Array<Job> = [];\r\n  private archivedJobs: Array<Job> = [];\r\n\r\n  // private collections: Object;\r\n  private config: Object;\r\n\r\n  constructor(private collections: Object, private global: Global) {\r\n    global.ingest = this.ingest.bind(this);\r\n    this.config = global.config;\r\n  }\r\n\r\n  // The primary entry point for Runtime, all jobs should come through here\r\n  public ingest(job: Job): void {\r\n    this.ingestQueue.push(job);\r\n    if (!this.running) {\r\n      this.findNextJob();\r\n    }\r\n  }\r\n\r\n  private findNextJob() {\r\n    this.running = true;\r\n    // shift the next job from the queue\r\n    let next = this.ingestQueue.shift();\r\n\r\n    if (!next.dep)\r\n      // groups, computed and indexes will not have their Dep class, so get it.\r\n      next.dep = this.global.getDep(next.property, next.collection);\r\n\r\n    // execute the next task in the queue\r\n    this.performJob(next);\r\n  }\r\n\r\n  private performJob(job: Job): void {\r\n    switch (job.type) {\r\n      case JobType.PUBLIC_DATA_MUTATION:\r\n        this.performPublicDataUpdate(job);\r\n        this.collections[job.collection].runWatchers(job.property);\r\n        break;\r\n      case JobType.INTERNAL_DATA_MUTATION:\r\n        this.performInternalDataUpdate(job);\r\n        break;\r\n      case JobType.INDEX_UPDATE:\r\n        this.performIndexUpdate(job);\r\n        break;\r\n      case JobType.COMPUTED_REGEN:\r\n        this.performComputedOutput(job);\r\n        this.collections[job.collection].runWatchers(job.property.name);\r\n        break;\r\n      case JobType.GROUP_UPDATE:\r\n        this.performGroupRebuild(job);\r\n        this.collections[job.collection].runWatchers(job.property);\r\n        break;\r\n      case JobType.DELETE_INTERNAL_DATA:\r\n        this.performInternalDataDeletion(job);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    // unpack dependents\r\n    if (job.dep && job.dep.dependents.size > 0) {\r\n      // log(`Queueing ${dep.dependents.size} dependents`);\r\n      job.dep.dependents.forEach(computed => {\r\n        // get dep from public computed output\r\n        this.ingest({\r\n          type: JobType.COMPUTED_REGEN,\r\n          collection: computed.collection,\r\n          property: computed,\r\n          dep: this.global.getDep(computed.name, computed.collection)\r\n        });\r\n      });\r\n    }\r\n    this.finished();\r\n  }\r\n\r\n  // handle job loop flow\r\n  private finished(): void {\r\n    this.running = false;\r\n    if (this.completedJobs.length > 5000) return;\r\n\r\n    // If there's already more stuff in the queue, loop.\r\n    if (this.ingestQueue.length > 0) {\r\n      this.findNextJob();\r\n      return;\r\n    }\r\n\r\n    // Wait until callstack is empty to check if we should finalise this body of work\r\n    setTimeout(() => {\r\n      if (this.ingestQueue.length === 0) {\r\n        if (!this.updatingSubscribers) this.compileComponentUpdates();\r\n        this.cleanup();\r\n      } else {\r\n        // loop more!\r\n        this.findNextJob();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ****************** Perform Functions ****************** //\r\n\r\n  private performPublicDataUpdate(job: Job): void {\r\n    this.writeToPublicObject(job.collection, 'data', job.property, job.value);\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performInternalDataUpdate(job: Job): void {\r\n    job.previousValue = this.overwriteInternalData(\r\n      job.collection,\r\n      job.property,\r\n      job.value\r\n    );\r\n\r\n    // collection function handels ingesting indexes to update itself, since it waits until\r\n    // all internal data has been ingested before handling the affected indexes\r\n    // however for direct data modifications we should update afected indexes\r\n    if (!this.global.collecting) {\r\n      // affected indexes is an array of indexes that have this primary key (job.property) present.\r\n      const affectedIndexes: Array<string> = this.collections[\r\n        job.collection\r\n      ].searchIndexesForPrimaryKey(job.property);\r\n\r\n      affectedIndexes.forEach(index => {\r\n        // since this is a singular piece of data that has changed, we do not need to\r\n        // rebuild the entire group, so we can soft rebuild\r\n        let modifiedGroup = this.collections[\r\n          job.collection\r\n        ].softUpdateGroupData(job.property, index);\r\n\r\n        this.ingest({\r\n          type: JobType.GROUP_UPDATE,\r\n          collection: job.collection,\r\n          value: modifiedGroup,\r\n          property: index,\r\n          dep: this.global.getDep(index, job.collection)\r\n          // we do not need a previousValue because groups are cached outputs and reversing the internal data update will do the trick\r\n        });\r\n      });\r\n    }\r\n\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performInternalDataDeletion(job: Job): void {\r\n    const c = this.collections[job.collection];\r\n    // preserve previous value\r\n    job.previousValue = { ...c.internalData[job.property] };\r\n    // delete data\r\n    delete c.internalData[job.property];\r\n    // find indexes affected by this data deletion\r\n    const indexesToUpdate = this.collections[\r\n      job.collection\r\n    ].searchIndexesForPrimaryKey(job.collection, job.property);\r\n\r\n    // for each found index, perform index update\r\n    for (let i = 0; i < indexesToUpdate.length; i++) {\r\n      const indexName = indexesToUpdate[i];\r\n      const newIndex = [...c.indexes.object[indexName]].filter(\r\n        id => id !== job.property\r\n      );\r\n      this.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: c.name,\r\n        property: indexName,\r\n        value: newIndex,\r\n        dep: this.global.getDep(job.property, job.collection)\r\n      });\r\n    }\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performIndexUpdate(job: Job): void {\r\n    // preserve old index\r\n    job.previousValue = this.collections[job.collection].indexes[job.property];\r\n    // Update Index\r\n    this.collections[job.collection].indexes.privateWrite(\r\n      job.property,\r\n      job.value\r\n    );\r\n    this.completedJob(job);\r\n\r\n    // Group must also be updated\r\n    this.ingest({\r\n      type: JobType.GROUP_UPDATE,\r\n      collection: job.collection,\r\n      property: job.property,\r\n      dep: this.global.getDep(job.property, job.collection)\r\n    });\r\n  }\r\n\r\n  private performGroupRebuild(job: Job): void {\r\n    // soft group rebuilds already have a generated value, otherwise generate the value\r\n    if (!job.value) {\r\n      job.value = this.collections[job.collection].buildGroupFromIndex(\r\n        job.property\r\n      );\r\n    }\r\n\r\n    // TODO: trigger relaction controller to update group relations\r\n    // this.global.relations.groupModified(job.collection, job.property);\r\n\r\n    this.writeToPublicObject(job.collection, 'group', job.property, job.value);\r\n    this.completedJob(job);\r\n  }\r\n\r\n  public performComputedOutput(job: Job): void {\r\n    const computed =\r\n      typeof job.property === 'string'\r\n        ? this.collections[job.collection].computed[job.property]\r\n        : job.property;\r\n\r\n    job.value = computed.run();\r\n    // Commit Update\r\n    this.writeToPublicObject(\r\n      job.collection,\r\n      'computed',\r\n      computed.name,\r\n      job.value\r\n    );\r\n    this.completedJob(job);\r\n  }\r\n\r\n  // ****************** Handlers ****************** //\r\n\r\n  private completedJob(job: Job): void {\r\n    // if action is running, save that action instance inside job payload\r\n    job.fromAction = this.global.runningAction;\r\n    // during runtime log completed job ready for component updates\r\n    if (this.global.initComplete) this.completedJobs.push(job);\r\n    // if data is persistable ensure storage is updated with new data\r\n    this.persistData(job);\r\n    // inform Dep class that the job is complete\r\n    if (job.dep) (job.dep as Dep).changed();\r\n    // inform the collection that the job is complete\r\n    this.collections[job.collection].changed(job.property);\r\n    // if either of these contain tickets, the relation controller will ingest updates\r\n  }\r\n\r\n  // ****************** End Runtime Events ****************** //\r\n\r\n  private compileComponentUpdates(): void {\r\n    if (!this.global.initComplete) return;\r\n    this.updatingSubscribers = true;\r\n    log('ALL JOBS COMPLETE', this.completedJobs);\r\n    log('Updating components...');\r\n\r\n    const componentsToUpdate = {};\r\n\r\n    // for all completed jobs\r\n    for (let i = 0; i < this.completedJobs.length; i++) {\r\n      const job = this.completedJobs[i];\r\n\r\n      // if job has a Dep class present\r\n      // Dep class contains subscribers to that property (as a completed job)\r\n      if (job.dep) {\r\n        let subscribers: Array<any> = job.dep.subscribers;\r\n\r\n        // for all the subscribers\r\n        for (let i = 0; i < subscribers.length; i++) {\r\n          // add to componentsToUpdate (ensuring update & component is unique)\r\n          const uuid = subscribers[i].componentUUID;\r\n          const key = subscribers[i].key;\r\n          if (!componentsToUpdate[uuid]) {\r\n            componentsToUpdate[uuid] = {};\r\n            componentsToUpdate[uuid][key] = job.value;\r\n          } else {\r\n            componentsToUpdate[uuid][key] = job.value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.updateSubscribers(componentsToUpdate);\r\n    this.completedJobs = [];\r\n  }\r\n\r\n  private updateSubscribers(componentsToUpdate) {\r\n    const componentKeys = Object.keys(componentsToUpdate);\r\n    for (let i = 0; i < componentKeys.length; i++) {\r\n      const componentID = componentKeys[i];\r\n      const componentInstance = this.global.subs.componentStore[componentID];\r\n      if (!componentInstance || !componentInstance.instance) return;\r\n      const propertiesToUpdate = componentsToUpdate[componentID];\r\n      const dataKeys = Object.keys(propertiesToUpdate);\r\n      // Switch depending on framework\r\n      switch (this.global.config.framework) {\r\n        case 'vue':\r\n          dataKeys.forEach(property => {\r\n            const value = propertiesToUpdate[property];\r\n            componentInstance.instance.$set(\r\n              componentInstance.instance,\r\n              property,\r\n              value\r\n            );\r\n          });\r\n          break;\r\n        case 'react':\r\n          componentInstance.instance.setState(propertiesToUpdate);\r\n          // console.log(propertiesToUpdate);\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private persistData(job: Job): void {\r\n    if (job.type === JobType.INTERNAL_DATA_MUTATION) return;\r\n    if (this.collections[job.collection].persist.includes(job.property)) {\r\n      this.global.storage.set(job.collection, job.property, job.value);\r\n    }\r\n  }\r\n\r\n  private cleanup(): void {\r\n    setTimeout(() => {\r\n      this.updatingSubscribers = false;\r\n    });\r\n  }\r\n\r\n  // ****************** Misc Handlers ****************** //\r\n\r\n  private writeToPublicObject(\r\n    collection: string,\r\n    type: string,\r\n    key: string,\r\n    value: any\r\n  ): void {\r\n    if (type === 'indexes') {\r\n      if (!this.collections[collection][type].object.hasOwnProperty(key))\r\n        return;\r\n      this.collections[collection][type].privateWrite(key, value);\r\n    } else {\r\n      if (!this.collections[collection].public.object.hasOwnProperty(key))\r\n        return;\r\n      this.collections[collection].public.privateWrite(key, value);\r\n    }\r\n  }\r\n\r\n  private overwriteInternalData(\r\n    collection: string,\r\n    primaryKey: string | number,\r\n    newData: any\r\n  ): object | boolean {\r\n    const currentData = Object.assign(\r\n      {},\r\n      this.collections[collection].internalData[primaryKey]\r\n    );\r\n    if (currentData[primaryKey]) {\r\n      // data already exists, merge objects and return previous object\r\n      const keys = Object.keys(newData);\r\n      for (let i = 0; i < keys.length; i++) {\r\n        const property = keys[i];\r\n        this.collections[collection].internalData[primaryKey][property] =\r\n          newData[property];\r\n      }\r\n      return currentData;\r\n    } else {\r\n      // data does not exist, write and return false\r\n      this.collections[collection].internalData[primaryKey] = newData;\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import { Global } from './interfaces';\r\n\r\nexport default class Computed {\r\n  public relatedToGroup: Array<any> = [];\r\n  public relatedToInternalData: Array<any> = [];\r\n\r\n  constructor(\r\n    private global: Global,\r\n    public collection: string,\r\n    public name: string,\r\n    private computedFunction: (context: object) => any\r\n  ) {}\r\n\r\n  public run() {\r\n    this.global.runningComputed = this;\r\n\r\n    let output = this.computedFunction(this.global.getContext(this.collection));\r\n\r\n    if (output === undefined || output === null) output = false;\r\n\r\n    this.global.runningComputed = false;\r\n\r\n    return output;\r\n  }\r\n}\r\n","import { Global } from './interfaces';\r\nimport Computed from './computed';\r\nimport { JobType } from './runtime';\r\nimport Dep from './dep';\r\nimport { uuid, key, parse } from './helpers';\r\n\r\n// This class is global, since relationships can be between collections.\r\n// Three public functions: relate(), update() & cleanup()\r\n// Collections & Deps get \"tickets\" which are UUIDs that reference relations stored here.\r\n// this is the fastest way to access relations and cleanup from the outside.\r\n// 5 different relationship types currently supported\r\n\r\n// collection/primaryKey\r\nexport type Key = string;\r\n// what to update\r\nexport type UpdateThis = Computed | Key;\r\n// when to update it\r\nexport type WhenThisChanges = Key | Dep;\r\n\r\nexport enum RelationTypes {\r\n  COMPUTED_DEPENDS_ON_DATA, // used by findById() when run in computed\r\n  COMPUTED_DEPENDS_ON_GROUP, // used by getGroup() when run in computed\r\n  DATA_DEPENDS_ON_DEP, // the Dep class of a property when used in populate()\r\n  DATA_DEPENDS_ON_GROUP, // used by getGroup() when run in populate()\r\n  DATA_DEPENDS_ON_DATA // used by findById() when run in populate()\r\n}\r\nexport interface Relation {\r\n  type: RelationTypes;\r\n  updateThis: UpdateThis;\r\n  whenThisChanges: WhenThisChanges;\r\n  uuid: any;\r\n}\r\nexport default class RelationController {\r\n  private relations: { [key: string]: Relation } = {};\r\n  private cleanupRefs: { [key: string]: Array<string> } = {};\r\n  constructor(private global: Global) {}\r\n\r\n  private save(\r\n    id: any,\r\n    type: RelationTypes,\r\n    updateThis: UpdateThis,\r\n    whenThisChanges: WhenThisChanges\r\n  ) {\r\n    this.relations[id] = {\r\n      // uuid: id,\r\n      type,\r\n      updateThis,\r\n      whenThisChanges\r\n    };\r\n  }\r\n\r\n  private cleanup(cleanupKey: string): void {\r\n    if (!this.cleanupRefs[cleanupKey]) return;\r\n    // delete relations for this cleanupKey based on the tickets saved\r\n    this.cleanupRefs[cleanupKey].forEach(ticket => {\r\n      const whenThisChanges = this.relations[ticket].whenThisChanges;\r\n\r\n      this.global.cleanupTickets(whenThisChanges);\r\n\r\n      delete this.relations[ticket];\r\n    });\r\n\r\n    // empty old tickets ready for new evaluation\r\n    this.cleanupRefs[cleanupKey] = [];\r\n  }\r\n\r\n  private saveTicketsByCleanupKey(cleanupKey, ticket) {\r\n    if (Array.isArray(this.cleanupRefs[cleanupKey]))\r\n      this.cleanupRefs[cleanupKey].push(ticket);\r\n    // create new array with ticket already inside\r\n    else this.cleanupRefs[cleanupKey] = [ticket];\r\n  }\r\n\r\n  public relate(\r\n    type: RelationTypes,\r\n    updateThis: UpdateThis,\r\n    whenThisChanges: WhenThisChanges,\r\n    collection?: string // needed for data relations\r\n  ): void {\r\n    // a unique identifier for this relation increases speed finding & cleaning up relations\r\n    const ticket = uuid();\r\n\r\n    // if collection is set we change whenThisChanges (expected as a primaryKey)\r\n    // to be a key with the collection/key\r\n    if (collection) whenThisChanges = key(collection, whenThisChanges as Key);\r\n\r\n    // cleanup previous relations for this cleanup key\r\n    let cleanupKey: string;\r\n\r\n    // cleanup key is already set\r\n    if (typeof updateThis === 'string') cleanupKey = updateThis as Key;\r\n    // extract cleanup key from computed instance\r\n    else if (updateThis instanceof Computed)\r\n      cleanupKey = key(\r\n        (updateThis as Computed).collection,\r\n        (updateThis as Computed).name\r\n      );\r\n\r\n    // clean up\r\n    this.cleanup(cleanupKey);\r\n\r\n    // new cleanup ref\r\n    this.saveTicketsByCleanupKey(cleanupKey, ticket);\r\n\r\n    switch (type) {\r\n      //\r\n      case RelationTypes.COMPUTED_DEPENDS_ON_DATA:\r\n        this.global.ticket(collection, ticket, whenThisChanges); // for update\r\n        this.save(ticket, type, updateThis as Computed, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.COMPUTED_DEPENDS_ON_GROUP:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Computed, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_DATA:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_GROUP:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_DEP:\r\n        (whenThisChanges as Dep).ticket(ticket);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Dep);\r\n\r\n        break;\r\n    }\r\n  }\r\n\r\n  // this should be called whenever the whenThisChanges value updates\r\n  public update(tickets: Array<string>): void {\r\n    tickets.forEach(ticket => {\r\n      const relation = this.relations[ticket];\r\n\r\n      // console.log(this.relations[ticket]);\r\n      // if (\r\n      //   relation.updateThis instanceof Computed &&\r\n      //   relation.updateThis.name === 'forChannel'\r\n      // )\r\n      //   debugger;\r\n\r\n      switch (relation.type) {\r\n        //\r\n        case RelationTypes.COMPUTED_DEPENDS_ON_DATA:\r\n          this.ingestComputed(relation.updateThis as Computed);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.COMPUTED_DEPENDS_ON_GROUP:\r\n          this.ingestComputed(relation.updateThis as Computed);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_DATA:\r\n          this.privateIngestDataUpdate(relation.updateThis as Key);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_GROUP:\r\n          this.privateIngestDataUpdate(relation.updateThis as Key);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_DEP:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  private ingestComputed(computed: Computed) {\r\n    this.global.ingest({\r\n      type: JobType.COMPUTED_REGEN,\r\n      collection: computed.collection,\r\n      property: computed.name,\r\n      dep: this.global.getDep(computed.name, computed.collection)\r\n    });\r\n  }\r\n\r\n  privateIngestDataUpdate(updateThis: key): void {\r\n    const parsed = parse(updateThis as Key);\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: parsed.collection,\r\n      property: parsed.primaryKey\r\n    });\r\n  }\r\n}\r\n\r\n// export enum RelationTypes {\r\n//   COMPUTED_DEPENDS_ON_DATA, // used by findById() when run in computed                  //DONE\r\n//   // { type: 0, updateThis: Computed, whenThisChanges: collection/primaryKey  }\r\n//   // how: ingest Computed\r\n//   // store uuid on collection (relations = [uuid, uuid]) [cleanup on run]\r\n\r\n//   COMPUTED_DEPENDS_ON_GROUP, // used by getGroup() when run in computed\r\n//   // { type: 1, updateThis: Computed, whenThisChanges: Dep (group)  }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on Computed run]\r\n//   // how: ingest Computed\r\n\r\n//   DATA_DEPENDS_ON_DEP, // the Dep class of a property when used in populate()            //DONE\r\n//   // { type: 2, updateThis: collection/primaryKey, whenThisChanges: Dep (any) }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on data regen]\r\n\r\n//   DATA_DEPENDS_ON_GROUP, // used by getGroup() when run in populate()                    //DONE\r\n//   // { type: 3, updateThis: collection/primaryKey, whenThisChanges: collection/groupName (not a groups have Dep classes)  }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on data regen]\r\n\r\n//   DATA_DEPENDS_ON_DATA // used by findById() when run in populate()\r\n//   // { type: 4, updateThis: collection/primaryKey, whenThisChanges: collection/primaryKey  }\r\n//   // store uuid on collectiternalDataRelations = [uuid, uuid]) [cleanup on data regen]\r\n// }\r\n","import { Global } from './interfaces';\r\nimport { RelationTypes } from './relationController';\r\n\r\nexport default class Dep {\r\n  public dependents: any = new Set();\r\n  public subscribers: Array<object> = [];\r\n  public tickets: Array<string> = [];\r\n\r\n  constructor(\r\n    private global: Global,\r\n    public name: string,\r\n    public rootProperty: string,\r\n    public propertyOnObject: string\r\n  ) {}\r\n\r\n  register() {\r\n    const subs = this.global.subs;\r\n\r\n    if (this.global.runningComputed) {\r\n      this.dependents.add(this.global.runningComputed);\r\n    }\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_DEP,\r\n        this.global.runningPopulate,\r\n        this as Dep\r\n      );\r\n    }\r\n    if (subs.subscribingComponent) {\r\n      this.subscribeComponent();\r\n    }\r\n    if (subs.unsubscribingComponent) {\r\n      // this.subscribers.delete(this.global.subscribingComponent);\r\n    }\r\n  }\r\n\r\n  subscribeComponent() {\r\n    const subs = this.global.subs;\r\n\r\n    if (this.rootProperty && subs.skimmingDeepReactive) {\r\n      subs.prepareNext(this);\r\n      return;\r\n    }\r\n    if (this.rootProperty) {\r\n      subs.foundDeepReactive();\r\n      subs.prepareNext(this);\r\n      return;\r\n    }\r\n    if (!this.rootProperty && subs.skimmingDeepReactive) {\r\n      subs.exitDeepReactive();\r\n    }\r\n\r\n    this.subscribe();\r\n\r\n    subs.prepareNext(this);\r\n  }\r\n  subscribe() {\r\n    const subs = this.global.subs;\r\n    const keys = subs.subscribingComponent.keys;\r\n    const key = keys[subs.subscribingComponentKey];\r\n    const component = {\r\n      componentUUID: subs.subscribingComponent.componentUUID,\r\n      key: key\r\n    };\r\n    this.subscribers.push(component);\r\n  }\r\n  ticket(uuid) {\r\n    this.tickets.push(uuid);\r\n  }\r\n  // this should fire once runtime finish a job with a dep,\r\n  // we can then loop back with the relationController to check\r\n  // for any active relations based on tickets saved in this dep class\r\n  changed() {\r\n    if (this.tickets.length > 0) {\r\n      this.global.relations.update([...this.tickets]);\r\n    }\r\n  }\r\n}\r\n","import { protectedNames, arrayFunctions, isWatchableObject } from './helpers';\r\nimport Dep from './dep';\r\nimport { Global } from './interfaces';\r\n\r\ninterface Obj {\r\n  [key: string]: any;\r\n}\r\n\r\nexport default class Reactive {\r\n  public properties: Array<string>;\r\n  public object: Obj;\r\n  private dispatch: any;\r\n  private allowPrivateWrite: boolean = false;\r\n  private touching: boolean = false;\r\n  private touched: null | Dep;\r\n\r\n  constructor(\r\n    object: Obj = {},\r\n    private global: Global,\r\n    private collection: string,\r\n    public mutable: Array<string>,\r\n    public type: string\r\n  ) {\r\n    this.dispatch = this.global.dispatch;\r\n    this.properties = Object.keys(object);\r\n\r\n    this.object = this.reactiveObject(object);\r\n  }\r\n\r\n  reactiveObject(object: Obj, rootProperty?: string): object {\r\n    const self = this;\r\n    const objectKeys = Object.keys(object);\r\n\r\n    // Loop over all properties of the to-be reactive object\r\n    for (let i = 0; i < objectKeys.length; i++) {\r\n      const key = objectKeys[i];\r\n      const rootProperty = object.rootProperty;\r\n      const currentProperty = key;\r\n      let value = object[key];\r\n\r\n      // If property is an array, make it reactive\r\n      if (Array.isArray(value)) {\r\n        // value = this.reactiveArray(value, key);\r\n        // if property is an object, make it reactive also\r\n      } else if (isWatchableObject(value) && !protectedNames.includes(key)) {\r\n        // rootProperty should be the current key if first deep object\r\n        value = this.deepReactiveObject(\r\n          value,\r\n          rootProperty || key,\r\n          currentProperty\r\n        );\r\n      }\r\n\r\n      // Create an instance of the dependency tracker\r\n      const dep = new Dep(this.global, key, rootProperty, currentProperty);\r\n\r\n      Object.defineProperty(object, key, {\r\n        get: function pulseGetter() {\r\n          if (self.global.touching) {\r\n            self.global.touched = dep;\r\n            return;\r\n          }\r\n          dep.register();\r\n          return value;\r\n        },\r\n        set: function pulseSetter(newValue) {\r\n          // rootProperty indicates if the object is \"deep\".\r\n          if (rootProperty && self.mutable.includes(rootProperty)) {\r\n            // mutate locally\r\n            value = newValue;\r\n            // dispatch mutation for rootProperty\r\n            self.dispatch('mutation', {\r\n              collection: self.collection,\r\n              key: rootProperty,\r\n              value: self.object[rootProperty],\r\n              dep\r\n            });\r\n          } else {\r\n            // if backdoor open or is protected name, allow direct mutation\r\n            if (self.allowPrivateWrite || protectedNames.includes(key))\r\n              return (value = newValue);\r\n\r\n            // if property is mutable dispatch update\r\n            if (self.mutable.includes(key)) {\r\n              self.dispatch('mutation', {\r\n                collection: self.collection,\r\n                key,\r\n                value: newValue,\r\n                dep\r\n              });\r\n              // we did not apply the mutation since runtime will privatly\r\n              // write the result since we dispatched above\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n    return object;\r\n  }\r\n\r\n  deepReactiveObject(value, rootProperty?: string, propertyOnObject?: string) {\r\n    let objectWithCustomPrototype = Object.create({\r\n      rootProperty,\r\n      propertyOnObject\r\n    });\r\n    // repopulate custom object with incoming values\r\n    const keys = Object.keys(value);\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const property = keys[i];\r\n      objectWithCustomPrototype[property] = value[property];\r\n    }\r\n\r\n    this.allowPrivateWrite = true;\r\n    const obj = this.reactiveObject(objectWithCustomPrototype, rootProperty);\r\n    this.allowPrivateWrite = false;\r\n    return obj;\r\n  }\r\n\r\n  reactiveArray(array, key) {\r\n    const self = this;\r\n    const reactiveArray = array.slice();\r\n\r\n    for (let i = 0; i < arrayFunctions.length; i++) {\r\n      const func = arrayFunctions[i];\r\n      const original = Array.prototype[func];\r\n      Object.defineProperty(reactiveArray, func, {\r\n        value: function() {\r\n          const result = original.apply(this, arguments);\r\n          if (self.global.initComplete)\r\n            self.dispatch('mutation', {\r\n              collection: self.collection,\r\n              key,\r\n              value: result\r\n            });\r\n          return result;\r\n        }\r\n      });\r\n    }\r\n    return reactiveArray;\r\n  }\r\n\r\n  privateWrite(property, value) {\r\n    this.allowPrivateWrite = true;\r\n    this.object[property] = value;\r\n    this.allowPrivateWrite = false;\r\n  }\r\n\r\n  privateGetValue(property) {\r\n    return this.object[property];\r\n  }\r\n\r\n  exists(property: string): boolean {\r\n    return !!this.object.hasOwnProperty(property);\r\n  }\r\n}\r\n\r\n// look for computed output access to determine dependencies\r\n// remove computed categories from public object on default config\r\n","import { uuid } from \"./helpers\";\r\nimport { Global } from \"./interfaces\";\r\n\r\nexport default class Action {\r\n  public executing: boolean = false;\r\n  public uuid: string;\r\n  public exec: () => {};\r\n\r\n  constructor(\r\n    private collection: string,\r\n    private global: Global,\r\n    public action: any,\r\n    public actionName: string\r\n  ) {\r\n    this.uuid = uuid();\r\n    this.prepare(action, global, this.global.contextRef.undo);\r\n  }\r\n\r\n  prepare(action, global, undo) {\r\n    const _this = this;\r\n\r\n    this.exec = function() {\r\n      const context = global.getContext(_this.collection);\r\n      context.undo = error => {\r\n        return undo(this.actionName, this.uuid, error);\r\n      };\r\n      global.runningAction = _this;\r\n\r\n      _this.executing = true;\r\n\r\n      const result = action.apply(\r\n        null,\r\n        [context].concat(Array.prototype.slice.call(arguments))\r\n      );\r\n\r\n      _this.executing = false;\r\n      global.runningAction = false;\r\n\r\n      return result;\r\n    };\r\n  }\r\n}\r\n","import {\r\n  assert,\r\n  defineConfig,\r\n  validateNumber,\r\n  collectionFunctions,\r\n  objectLoop,\r\n  key\r\n} from './helpers';\r\nimport Reactive from './reactive';\r\nimport Action from './action';\r\nimport Computed from './computed';\r\nimport { JobType } from './runtime';\r\nimport {\r\n  Methods,\r\n  Keys,\r\n  CollectionObject,\r\n  CollectionConfig,\r\n  Global,\r\n  ExpandableObject\r\n} from './interfaces';\r\nimport { RelationTypes, Key } from './relationController';\r\n\r\nexport default class Collection {\r\n  private namespace: CollectionObject;\r\n  public public: Reactive;\r\n  public indexes: Reactive;\r\n  public config: CollectionConfig = {};\r\n  public keys: Keys = {};\r\n  public methods: Methods = {};\r\n\r\n  public actions: { [key: string]: Action } = {};\r\n  public computed: { [key: string]: Computed } = {};\r\n  public watchers: { [key: string]: any } = {};\r\n  public externalWatchers: { [key: string]: any } = {};\r\n  public persist: Array<string> = [];\r\n  public local: { [key: string]: any } = {};\r\n  public model: { [key: string]: any } = {};\r\n\r\n  public collectionSize: number = 0;\r\n  public primaryKey: string | number | boolean = false;\r\n\r\n  private internalData: object = {};\r\n  private internalDataWithPopulate: Array<string> = [];\r\n\r\n  private tickets: { [key: string]: Array<string> } = {};\r\n\r\n  dispatch: void;\r\n\r\n  constructor(\r\n    public name: string,\r\n    protected global: Global,\r\n    root: CollectionObject\r\n  ) {\r\n    this.config = root.config;\r\n    this.dispatch = this.global.dispatch;\r\n\r\n    // legacy support (\"filters\" changed to \"computed\")\r\n    root.computed = { ...root.computed, ...root.filters };\r\n\r\n    root = this.prepareNamespace(root);\r\n\r\n    this.initReactive(root.data, root.groups);\r\n    this.initRoutes(root.routes);\r\n    this.initActions(root.actions);\r\n    this.initWatchers(root.watch);\r\n    this.initComputed(root.computed);\r\n\r\n    this.initModel(root.model);\r\n    this.initPersist(root.persist);\r\n  }\r\n\r\n  prepareNamespace(root: CollectionObject) {\r\n    // map collection methods\r\n    collectionFunctions.map(\r\n      func => (this.methods[func] = this[func].bind(this))\r\n    );\r\n\r\n    if (root.local) this.local = root.local;\r\n\r\n    // for each type set default and register keys\r\n    ['data', 'actions', 'computed', 'indexes', 'routes', 'watch'].forEach(\r\n      type => {\r\n        if (type !== 'indexes' && !root[type]) root[type] = {};\r\n        this.keys[type] =\r\n          type === 'indexes' ? root['groups'] || [] : Object.keys(root[type]);\r\n      }\r\n    );\r\n\r\n    // assign namespace, this is used by initReactive\r\n    this.namespace = Object.assign(\r\n      Object.create({ ...this.methods }), // bind methods to prototype\r\n      {\r\n        routes: {},\r\n        indexes: {},\r\n        actions: root.actions,\r\n        ...root.computed,\r\n        ...root.data,\r\n        ...this.normalizeGroups(root.groups)\r\n      }\r\n    );\r\n    return root;\r\n  }\r\n\r\n  // groups are defined by the user as an array of strings, this converts them into object/keys\r\n  normalizeGroups(groupsAsArray: any = []) {\r\n    const groups: object = {};\r\n    for (let i = 0; i < groupsAsArray.length; i++) {\r\n      const groupName = groupsAsArray[i];\r\n      groups[groupName] = [];\r\n    }\r\n    return groups;\r\n  }\r\n\r\n  runWatchers(property) {\r\n    const watcher = this.watchers[property];\r\n    if (watcher) watcher();\r\n    const externalWatchers = this.externalWatchers[property];\r\n    if (externalWatchers)\r\n      externalWatchers.forEach(func =>\r\n        typeof func === 'function' ? func() : false\r\n      );\r\n  }\r\n\r\n  initReactive(data: object = {}, groups: Array<any> | object = []) {\r\n    groups = this.normalizeGroups(groups);\r\n    // Make indexes reactive\r\n    this.indexes = new Reactive(\r\n      groups, // object\r\n      this.global, // global\r\n      this.name, // collection\r\n      this.keys.indexes, // mutable\r\n      'indexes' // type\r\n    );\r\n    this.namespace.indexes = this.indexes.object;\r\n\r\n    // Make entire public object Reactive\r\n    this.public = new Reactive(\r\n      this.namespace,\r\n      this.global,\r\n      this.name,\r\n      [...this.keys.data, ...this.keys.indexes],\r\n      'root'\r\n    );\r\n  }\r\n\r\n  initPersist(persist: Array<string>): void {\r\n    if (!Array.isArray(persist)) return;\r\n\r\n    for (let i = 0; i < persist.length; i++) {\r\n      const dataName = persist[i];\r\n\r\n      // TODO: validate\r\n\r\n      this.persist.push(dataName);\r\n      if (this.global.storage.isPromise) {\r\n        this.global.storage.get(this.name, dataName).then(data => {\r\n          if (data === undefined || data === null) return;\r\n          const job = {\r\n            type: JobType.PUBLIC_DATA_MUTATION,\r\n            value: data,\r\n            property: dataName,\r\n            collection: this.name,\r\n            dep: this.global.getDep(dataName, this.name)\r\n          };\r\n          this.global.ingest(job);\r\n        });\r\n      } else {\r\n        let data = this.global.storage.get(this.name, dataName);\r\n        if (data === undefined || data === null) continue;\r\n        this.public.privateWrite(dataName, data);\r\n      }\r\n    }\r\n  }\r\n\r\n  initActions(actions: object = {}) {\r\n    let actionKeys = Object.keys(actions);\r\n    for (let i = 0; i < actionKeys.length; i++) {\r\n      const action = actions[actionKeys[i]];\r\n      this.actions[actionKeys[i]] = new Action(\r\n        this.name,\r\n        this.global,\r\n        action,\r\n        actionKeys[i]\r\n      );\r\n\r\n      this.public.privateWrite(actionKeys[i], this.actions[actionKeys[i]].exec);\r\n    }\r\n  }\r\n\r\n  initWatchers(watchers: object = {}) {\r\n    let watcherKeys = Object.keys(watchers);\r\n    for (let i = 0; i < watcherKeys.length; i++) {\r\n      const watcher = watchers[watcherKeys[i]];\r\n      this.watchers[watcherKeys[i]] = () => {\r\n        this.global.runningWatcher = {\r\n          collection: this.name,\r\n          property: watcherKeys[i]\r\n        };\r\n        const watcherOutput = watcher(this.global.getContext(this.name));\r\n        this.global.runningWatcher = false;\r\n        return watcherOutput;\r\n      };\r\n    }\r\n    this.watchers._keys = watcherKeys;\r\n  }\r\n\r\n  initComputed(computed: object): void {\r\n    objectLoop(\r\n      computed,\r\n      (computedName: string, computedFunction: () => void) => {\r\n        this.computed[computedName] = new Computed(\r\n          this.global,\r\n          this.name,\r\n          computedName,\r\n          computedFunction\r\n        );\r\n        this.public.object[computedName] = [];\r\n      },\r\n      this.keys.computed\r\n    );\r\n  }\r\n\r\n  initRoutes(routes: ExpandableObject) {\r\n    const self = this;\r\n    const routeWrapped = routeName => {\r\n      return function() {\r\n        let requestObject = Object.assign({}, self.global.request);\r\n        requestObject.context = self.global.getContext();\r\n        return routes[routeName].apply(\r\n          null,\r\n          [requestObject].concat(Array.prototype.slice.call(arguments))\r\n        );\r\n      };\r\n    };\r\n    objectLoop(\r\n      routes,\r\n      routeName =>\r\n        (this.public.object.routes[routeName] = routeWrapped(routeName))\r\n    );\r\n  }\r\n\r\n  initModel(model = {}) {\r\n    this.model = model;\r\n    Object.keys(model).forEach(property => {\r\n      Object.keys(model[property]).forEach(config => {\r\n        switch (config) {\r\n          case 'primaryKey':\r\n            this.primaryKey = property;\r\n            break;\r\n          case 'populate':\r\n            this.internalDataWithPopulate.push(property);\r\n            break;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  // called by relationController after new relation has been created\r\n  public ticket(uuid: string, primaryKey: string | number): void {\r\n    if (Array.isArray(this.tickets[primaryKey]))\r\n      this.tickets[primaryKey].push(uuid);\r\n    else this.tickets[primaryKey] = [uuid];\r\n  }\r\n\r\n  public cleanupTickets(primaryKey) {\r\n    if (this.tickets[primaryKey]) {\r\n      this.tickets[primaryKey] = [];\r\n    }\r\n  }\r\n\r\n  // called by Runtime when job has been completed\r\n  public changed(primaryKey: string | number): void {\r\n    if (this.tickets[primaryKey]) {\r\n      this.global.relations.update(this.tickets[primaryKey]);\r\n    }\r\n  }\r\n\r\n  private getData(id) {\r\n    return { ...this.internalData[id] };\r\n  }\r\n\r\n  public buildGroupFromIndex(groupName: string): Array<number> {\r\n    const constructedArray = [];\r\n    // get index directly\r\n    let index = this.indexes.object[groupName];\r\n    if (!index) return [];\r\n\r\n    // for every primaryKey in the index\r\n    for (let i = 0; i < index.length; i++) {\r\n      // primaryKey of data\r\n      let id = index[i];\r\n      // copy data from internal database\r\n      let data = this.getData(id);\r\n      // if none found skip\r\n      if (!data) continue;\r\n      // inject dynamic data\r\n      data = this.injectDynamicRelatedData(id, data);\r\n\r\n      constructedArray.push(data);\r\n    }\r\n    return constructedArray;\r\n  }\r\n\r\n  // rebuilding an entire group is expensive on resources, but is\r\n  // not nessisary if only one piece of data has changed\r\n  // this function will replace a single piece of data without rebuilding\r\n  // the entire group\r\n  public softUpdateGroupData(\r\n    primaryKey: string | number,\r\n    groupName: string\r\n  ): Array<any> {\r\n    let index: Array<any> = this.indexes.privateGetValue(groupName);\r\n\r\n    // find the data's position within index\r\n    let position: number = index.indexOf(primaryKey);\r\n\r\n    // if group is dynamic, just build the group from index.\r\n    if (!this.public[groupName]) return this.buildGroupFromIndex(groupName);\r\n\r\n    // copy the current group output\r\n    let currentGroup: Array<any> = [this.public[groupName]];\r\n\r\n    // get data for primaryKey\r\n    let data: { [key: string]: any } = { ...this.internalData[primaryKey] };\r\n\r\n    data = this.injectDynamicRelatedData(primaryKey, data);\r\n\r\n    // replace at known position with updated data\r\n    currentGroup[position] = data;\r\n\r\n    return currentGroup;\r\n  }\r\n\r\n  // This should be called on every piece of data retrieved when building a group from an index\r\n  private injectDynamicRelatedData(\r\n    primaryKey: string | number,\r\n    data: { [key: string]: any }\r\n  ): any {\r\n    // for each populate() function found in the model for this collection\r\n    this.internalDataWithPopulate.forEach(property => {\r\n      // set runningPopulate to the key (collection/propery) of the data being modified\r\n      // this is fed into the relations.relate() function becoming the unique cleanupKey for the relation\r\n      this.global.runningPopulate = key(this.name, primaryKey);\r\n      // run populate function passing in the context and the data\r\n      const populated = this.model[property].populate(\r\n        this.global.getContext(),\r\n        data\r\n      );\r\n\r\n      this.global.runningPopulate = false;\r\n      // inject result to data\r\n      data[property] = populated;\r\n    });\r\n    return data;\r\n  }\r\n\r\n  public createGroups(group) {\r\n    if (group === undefined) group = [];\r\n    else if (!Array.isArray(group)) group = [group];\r\n\r\n    for (let i = 0; i < group.length; i++) {\r\n      const groupName = group[i];\r\n      if (!this.indexes.object[groupName]) {\r\n        this.indexes.object[groupName] = [];\r\n      }\r\n    }\r\n    return group;\r\n  }\r\n\r\n  // METHODS\r\n\r\n  public collect(\r\n    data,\r\n    group?: string | Array<string>,\r\n    config?: ExpandableObject\r\n  ) {\r\n    config = defineConfig(config, {\r\n      append: true\r\n    });\r\n    this.global.collecting = true;\r\n    // normalise data\r\n    if (!Array.isArray(data)) data = [data];\r\n\r\n    // if groups don't already exist, create them dynamically\r\n    const groups: Array<string> = this.createGroups(group);\r\n    // groups now contains just the groups directly modified by this collect\r\n\r\n    // preserve index previous values\r\n    const previousIndexValues: object = this.getPreviousIndexValues(groups);\r\n\r\n    const indexesToRegenOnceComplete = new Set();\r\n\r\n    // process data items\r\n    for (let i = 0; i < data.length; i++) {\r\n      const dataItem = data[i];\r\n\r\n      if (dataItem === null) continue;\r\n      // process data item returns \"success\" as a boolean and affectedIndexes as an array\r\n      const processDataItem = this.processDataItem(dataItem, groups, config);\r\n\r\n      if (!processDataItem) continue;\r\n\r\n      if (processDataItem.success) this.collectionSize++;\r\n      // ensure indexes modified by this data item are waiting to be ingested for regen\r\n      processDataItem.affectedIndexes.forEach(index =>\r\n        indexesToRegenOnceComplete.add(index)\r\n      );\r\n    }\r\n\r\n    indexesToRegenOnceComplete.forEach(index => {\r\n      this.global.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: this.name,\r\n        property: index,\r\n        value: this.indexes.object[index],\r\n        previousValue: previousIndexValues[index]\r\n      });\r\n    });\r\n\r\n    this.global.collecting = false;\r\n  }\r\n\r\n  processDataItem(dataItem: object, groups: Array<string> = [], config) {\r\n    if (!this.primaryKey) this.findPrimaryKey(dataItem);\r\n\r\n    if (!this.primaryKey) return false;\r\n\r\n    const key = dataItem[this.primaryKey as number | string];\r\n\r\n    // find affected indexes\r\n    let affectedIndexes = [...groups];\r\n\r\n    // searchIndexesForPrimaryKey returns an array of indexes that include that primaryKey\r\n    // for each index found, if it is not already known, add to affected indexes\r\n    this.searchIndexesForPrimaryKey(key).map(\r\n      index => !affectedIndexes.includes(index) && affectedIndexes.push(index)\r\n    );\r\n\r\n    // validate against model\r\n\r\n    // ingest the data\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: key,\r\n      value: dataItem\r\n    });\r\n\r\n    // add the data to group indexes\r\n    for (let i = 0; i < groups.length; i++) {\r\n      const groupName = groups[i];\r\n      let index = [...this.indexes.object[groupName]];\r\n\r\n      // remove key if already present in index\r\n      index = index.filter(k => k != key);\r\n\r\n      if (config.append) index.push(key);\r\n      else index.unshift(key);\r\n\r\n      // write index\r\n      this.indexes.privateWrite(groupName, index);\r\n    }\r\n    return { success: true, affectedIndexes };\r\n  }\r\n\r\n  private searchIndexesForPrimaryKey(\r\n    primaryKey: string | number\r\n  ): Array<string> {\r\n    // include dynamic indexes\r\n    const keys = Object.keys(this.indexes.object);\r\n\r\n    let foundIndexes: Array<string> = [];\r\n\r\n    // for every index\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const indexName = keys[i];\r\n\r\n      // if the index includes the primaryKey\r\n      if (this.indexes.object[indexName].includes(primaryKey))\r\n        foundIndexes.push(indexName);\r\n    }\r\n    return foundIndexes;\r\n  }\r\n\r\n  getPreviousIndexValues(groups) {\r\n    const returnData = {};\r\n    for (let i = 0; i < groups; i++) {\r\n      const groupName = groups[i];\r\n      returnData[groupName] = this.indexes.object[groupName];\r\n    }\r\n    return returnData;\r\n  }\r\n\r\n  findPrimaryKey(dataItem) {\r\n    if (dataItem.hasOwnProperty('id')) this.primaryKey = 'id';\r\n    else if (dataItem.hasOwnProperty('_id')) this.primaryKey = '_id';\r\n    else if (dataItem.hasOwnProperty('key')) this.primaryKey = 'key';\r\n    if (this.primaryKey) return true;\r\n    else return assert(warn => warn.NO_PRIMARY_KEY);\r\n  }\r\n\r\n  replaceIndex(indexName: string, newIndex: Array<string | number>) {\r\n    if (!Array.isArray(newIndex) || typeof indexName !== 'string')\r\n      return assert(warn => warn.INVALID_PARAMETER, 'replaceIndex');\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: indexName,\r\n      value: newIndex\r\n    });\r\n  }\r\n\r\n  findById(id) {\r\n    // if (!this.internalData.hasOwnProperty(id))\r\n    //   return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'findById');\r\n\r\n    if (this.global.runningComputed) {\r\n      let computed = this.global.runningComputed as Computed;\r\n      this.global.relations.relate(\r\n        RelationTypes.COMPUTED_DEPENDS_ON_DATA,\r\n        // updateThis computed instance\r\n        computed,\r\n        // primaryKey of data for whenThisChanges\r\n        id,\r\n        this.name\r\n      );\r\n    }\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_DATA,\r\n        // this is the key (\"collection/primaryKey\") for the dynamically populated data for updateThis\r\n        this.global.runningPopulate,\r\n        // primaryKey of data for whenThisChanges\r\n        id,\r\n        this.name\r\n      );\r\n    }\r\n    return this.internalData[id];\r\n  }\r\n\r\n  getGroup(property) {\r\n    // if called inside Computed method, create temporary relation in relationship controller\r\n    if (this.global.runningComputed) {\r\n      let computed = this.global.runningComputed as Computed;\r\n      this.global.relations.relate(\r\n        RelationTypes.COMPUTED_DEPENDS_ON_GROUP,\r\n        computed, // updateThis\r\n        property, // whenThisChanges\r\n        this.name\r\n      );\r\n    }\r\n    // if called from within populate() create another temporary relation\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_GROUP,\r\n        this.global.runningPopulate, // updateThis\r\n        property, // whenThisChanges\r\n        this.name\r\n      );\r\n    }\r\n    // get group is not cached, so generate a fresh group from the index\r\n    return this.buildGroupFromIndex(property) || [];\r\n  }\r\n\r\n  // action functions\r\n  undo() {}\r\n  throttle() {}\r\n\r\n  // group functions\r\n  move(\r\n    ids: number | Array<string | number>,\r\n    sourceIndexName: string,\r\n    destIndexName?: string,\r\n    method: 'push' | 'unshift' = 'push'\r\n  ) {\r\n    // validation\r\n    if (!this.indexes.exists(sourceIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\r\n\r\n    if (destIndexName && !this.indexes.exists(destIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\r\n\r\n    if (!Array.isArray(ids)) ids = [ids];\r\n\r\n    let sourceIndex = this.indexes.privateGetValue(sourceIndexName);\r\n    for (let i = 0; i < ids.length; i++) sourceIndex.map(id => id !== ids[i]);\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: sourceIndexName,\r\n      value: sourceIndex\r\n    });\r\n\r\n    if (destIndexName) {\r\n      let destIndex = this.indexes.privateGetValue(destIndexName);\r\n\r\n      for (let i = 0; i < ids.length; i++) {\r\n        // destIndex = destIndex.filter(k => k != ids[i]);\r\n\r\n        if (destIndex.includes(ids[i])) continue;\r\n\r\n        // push or unshift id into current index\r\n        destIndex[method](ids[i]);\r\n      }\r\n\r\n      this.global.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: this.name,\r\n        property: destIndexName,\r\n        value: destIndex\r\n      });\r\n    }\r\n  }\r\n\r\n  put(\r\n    ids: number | Array<string | number>,\r\n    destIndexName: string,\r\n    method: 'push' | 'unshift' = 'push'\r\n  ) {\r\n    // validation\r\n    if (!this.indexes.exists(destIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'put');\r\n\r\n    if (!Array.isArray(ids)) ids = [ids];\r\n\r\n    // get current index\r\n    let destIndex = this.indexes.privateGetValue(destIndexName);\r\n\r\n    // This doesn't work because the array spead sets the object to index: value rather than just the values\r\n    // let test = { ...destIndex };\r\n    // ids.map(k => {\r\n    //   if (test[k]) return;\r\n    //   test[k] = true;\r\n    // });\r\n    // destIndex = Object.keys(test).map(k => Number(k));\r\n\r\n    // loop over every id user is trying to add into current index\r\n    for (let i = 0; i < ids.length; i++) {\r\n      // destIndex = destIndex.filter(k => k != ids[i]);\r\n\r\n      if (destIndex.includes(ids[i])) continue;\r\n\r\n      // push or unshift id into current index\r\n      destIndex[method](ids[i]);\r\n    }\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: destIndexName,\r\n      value: destIndex\r\n    });\r\n  }\r\n\r\n  newGroup(groupName: string, indexValue?: Array<string | number>) {\r\n    if (this.indexes.object.hasOwnProperty(groupName))\r\n      return assert(warn => warn.GROUP_ALREADY_EXISTS, 'newGroup');\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: indexValue\r\n    });\r\n  }\r\n  deleteGroup(groupName: string) {\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: []\r\n    });\r\n  }\r\n  removeFromGroup(\r\n    groupName: string,\r\n    itemsToRemove: number | string | Array<number | string>\r\n  ) {\r\n    if (!this.indexes.exists(groupName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'removeFromGroup');\r\n\r\n    if (!Array.isArray(itemsToRemove)) itemsToRemove = [itemsToRemove];\r\n\r\n    const index = this.indexes.privateGetValue(groupName);\r\n\r\n    const newIndex = index.filter(\r\n      id => !(itemsToRemove as Array<number | string>).includes(id)\r\n    );\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: newIndex\r\n    });\r\n  }\r\n\r\n  // internal data functions\r\n  update(primaryKey: string | number, newObject: { [key: string]: any }) {\r\n    if (!this.internalData.hasOwnProperty(primaryKey))\r\n      return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'update');\r\n\r\n    const newObjectKeys = Object.keys(newObject);\r\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\r\n\r\n    for (let i = 0; i < newObjectKeys.length; i++) {\r\n      const key = newObjectKeys[i];\r\n      currentData[key] = newObject[key];\r\n    }\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: primaryKey,\r\n      value: currentData\r\n    });\r\n  }\r\n  increment(\r\n    primaryKey: string | number,\r\n    property: string,\r\n    amount: number,\r\n    decrement?: boolean\r\n  ) {\r\n    if (!this.internalData.hasOwnProperty(primaryKey))\r\n      return assert(\r\n        warn => warn.INTERNAL_DATA_NOT_FOUND,\r\n        decrement ? 'decrement' : 'increment'\r\n      );\r\n\r\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\r\n\r\n    if (!validateNumber(amount, currentData[property]))\r\n      return assert(\r\n        warn => warn.PROPERTY_NOT_A_NUMBER,\r\n        decrement ? 'decrement' : 'increment'\r\n      );\r\n\r\n    if (decrement) currentData[property] -= amount;\r\n    else currentData[property] += amount;\r\n\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: primaryKey,\r\n      value: currentData\r\n    });\r\n  }\r\n  decrement(primaryKey: string | number, property: string, amount: number) {\r\n    this.increment(primaryKey, property, amount, true);\r\n  }\r\n\r\n  delete(primaryKeys: string | number | Array<string | number>) {\r\n    if (!Array.isArray(primaryKeys)) primaryKeys = [primaryKeys];\r\n    for (let i = 0; i < primaryKeys.length; i++) {\r\n      const primaryKey = primaryKeys[i];\r\n      this.global.ingest({\r\n        type: JobType.DELETE_INTERNAL_DATA,\r\n        collection: this.name,\r\n        property: primaryKey\r\n      });\r\n    }\r\n  }\r\n\r\n  // remove all dynamic indexes, empty all indexes, delete all internal data\r\n  purge() {}\r\n\r\n  // external functions\r\n  watch(property, callback) {\r\n    if (!this.externalWatchers[property])\r\n      this.externalWatchers[property] = [callback];\r\n    else this.externalWatchers[property].push(callback);\r\n  }\r\n\r\n  // deprecate\r\n  // added removeFromGroup to be more specific, params got switched around, keeping this for backwards compatibility\r\n  remove(itemsToRemove, groupName) {\r\n    return this.removeFromGroup(groupName, itemsToRemove);\r\n  }\r\n}\r\n","// This file handles external components subscribing to pulse.\r\n// It also handles subscribing mapData properties to collections\r\n\r\nimport { uuid } from './helpers';\r\nimport { ComponentContainer } from './interfaces';\r\nimport Dep from './dep';\r\n\r\ninterface SubscribingComponentObject {\r\n  componentUUID: string;\r\n  keys: Array<string>;\r\n}\r\n\r\nexport default class SubController {\r\n  private uuid: any = uuid;\r\n  private subscribingComponentKey: number = 0;\r\n  private subscribingComponent: boolean | SubscribingComponentObject = false;\r\n  private unsubscribingComponent: boolean = false;\r\n  private skimmingDeepReactive: boolean = false;\r\n  private lastAccessedDep: null | Dep = null;\r\n\r\n  public componentStore: { [key: string]: ComponentContainer } = {};\r\n\r\n  constructor(private getContext: any) {}\r\n\r\n  registerComponent(instance, config) {\r\n    let uuid = instance.__pulseUniqueIdentifier;\r\n    if (!uuid) {\r\n      // generate UUID\r\n      uuid = this.uuid();\r\n      // inject uuid into component instance\r\n      const componentContainer = {\r\n        instance: instance,\r\n        uuid,\r\n        ready: config.waitForMount ? false : true\r\n      };\r\n      instance.__pulseUniqueIdentifier = uuid;\r\n\r\n      this.componentStore[uuid] = componentContainer;\r\n    } else {\r\n      this.mount(instance);\r\n    }\r\n    return uuid;\r\n  }\r\n\r\n  mount(instance) {\r\n    let component = this.componentStore[instance.__pulseUniqueIdentifier];\r\n\r\n    if (component) {\r\n      component.instance = instance;\r\n      component.ready = true;\r\n    }\r\n  }\r\n\r\n  unmount(instance) {\r\n    const uuid = instance.__pulseUniqueIdentifier;\r\n    if (!uuid) return;\r\n\r\n    // delete refrence to this component from store\r\n    delete this.componentStore[instance.__pulseUniqueIdentifier];\r\n  }\r\n\r\n  subscribePropertiesToComponents(properties, componentUUID) {\r\n    // provisionally get keys of mapped data\r\n    const provision = properties(this.getContext());\r\n\r\n    const keys = Object.keys(provision);\r\n\r\n    // mapData has a user defined local key, we need to include that in the\r\n    // subscription so we know what to update on the component later.\r\n    this.subscribingComponentKey = 0;\r\n\r\n    this.subscribingComponent = {\r\n      componentUUID,\r\n      keys\r\n    };\r\n    const returnToComponent = properties(this.getContext());\r\n\r\n    this.subscribingComponent = false;\r\n\r\n    this.subscribingComponentKey = 0;\r\n\r\n    return returnToComponent;\r\n  }\r\n\r\n  prepareNext(dep) {\r\n    this.lastAccessedDep = dep;\r\n    if (!this.skimmingDeepReactive) this.subscribingComponentKey++;\r\n  }\r\n\r\n  foundDeepReactive() {\r\n    this.skimmingDeepReactive = true;\r\n    // undo changes\r\n    this.lastAccessedDep.subscribers.pop();\r\n    this.subscribingComponentKey--;\r\n  }\r\n\r\n  exitDeepReactive() {\r\n    this.skimmingDeepReactive = false;\r\n    //redo changes\r\n    this.lastAccessedDep.subscribe();\r\n    this.subscribingComponentKey++;\r\n  }\r\n}\r\n","interface StorageMethods {\r\n  async?: boolean;\r\n  get?: any;\r\n  set?: any;\r\n  remove?: any;\r\n}\r\n\r\nexport default class Storage {\r\n  private isPromise: boolean = false;\r\n  private storageReady: boolean = false;\r\n  private storageType: 'localStorage' | 'custom' = 'localStorage';\r\n  constructor(private storageMethods: StorageMethods = {}) {\r\n    if (storageMethods.async) this.isPromise = true;\r\n    if (this.localStorageAvaliable() && this.storageType === 'localStorage') {\r\n      this.storageReady = true;\r\n      storageMethods.get = localStorage.getItem.bind(localStorage);\r\n      storageMethods.set = localStorage.setItem.bind(localStorage);\r\n      storageMethods.remove = localStorage.removeItem.bind(localStorage);\r\n    } else {\r\n      this.storageType = 'custom';\r\n\r\n      if (\r\n        this.check(storageMethods.get) &&\r\n        this.check(storageMethods.set) &&\r\n        this.check(storageMethods.remove)\r\n      ) {\r\n        this.storageReady = true;\r\n      } else {\r\n        this.storageReady = false;\r\n        // bad\r\n      }\r\n    }\r\n  }\r\n\r\n  public get(collection, key) {\r\n    if (!this.storageReady) return;\r\n\r\n    if (this.isPromise) {\r\n      return new Promise((resolve, reject) => {\r\n        this.storageMethods\r\n          .get(this.getKey(collection, key))\r\n          .then(res => {\r\n            // if result is not JSON for some reason, return it.\r\n            if (typeof res !== 'string') return resolve(res);\r\n\r\n            resolve(JSON.parse(res));\r\n          })\r\n          .catch(reject);\r\n      });\r\n    } else {\r\n      return JSON.parse(this.storageMethods.get(this.getKey(collection, key)));\r\n    }\r\n  }\r\n\r\n  public set(collection, key, value) {\r\n    if (!this.storageReady) return;\r\n    this.storageMethods.set(\r\n      this.getKey(collection, key),\r\n      JSON.stringify(value)\r\n    );\r\n  }\r\n\r\n  public remove(collection, key) {\r\n    if (!this.storageReady) return;\r\n    this.storageMethods.remove(this.getKey(collection, key));\r\n  }\r\n\r\n  private getKey(collection, key) {\r\n    return `_${collection}_${key}`;\r\n  }\r\n\r\n  private check(func) {\r\n    return typeof func === 'function';\r\n  }\r\n\r\n  private localStorageAvaliable() {\r\n    try {\r\n      localStorage.setItem('_', '_');\r\n      localStorage.removeItem('_');\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import Collection from '../collection';\r\nimport { Global, ExpandableObject, RequestConfig } from '../interfaces';\r\n\r\ntype Method = 'get' | 'put' | 'post' | 'patch' | 'delete';\r\n\r\nexport default class Request extends Collection {\r\n  private timeout: number;\r\n  private options: ExpandableObject;\r\n  private saveHistory: boolean;\r\n\r\n  private requestIntercept: (\r\n    context: ExpandableObject,\r\n    options: ExpandableObject\r\n  ) => void;\r\n  private responseIntercept: (\r\n    context: ExpandableObject,\r\n    response: ExpandableObject\r\n  ) => void;\r\n\r\n  constructor(global: Global, requestConfig: RequestConfig) {\r\n    // Before we invoke the parent class, we define some defaults\r\n    let groups = [];\r\n    let persist = ['baseURL'];\r\n    let data = {\r\n      baseURL: requestConfig.baseURL || '',\r\n      mode: 'cors',\r\n      credentials: 'same-origin',\r\n      headers: {\r\n        Accept: 'application/json'\r\n      }\r\n    };\r\n\r\n    if (requestConfig.headers)\r\n      Object.keys(requestConfig.headers).forEach(header => {\r\n        data.headers[header] = requestConfig.headers[header];\r\n      });\r\n\r\n    if (requestConfig.credentials) data.credentials = requestConfig.credentials;\r\n    if (requestConfig.mode) data.mode = requestConfig.mode;\r\n\r\n    super('request', global, { groups, data, persist });\r\n\r\n    this.requestIntercept = requestConfig.requestIntercept;\r\n    this.responseIntercept = requestConfig.responseIntercept;\r\n    this.timeout = requestConfig.timeout;\r\n    this.saveHistory =\r\n      typeof requestConfig.saveHistory === 'undefined' ? true : false;\r\n\r\n    this.global.request = {\r\n      get: this.get.bind(this),\r\n      post: this.post.bind(this),\r\n      put: this._put.bind(this),\r\n      patch: this.patch.bind(this),\r\n      delete: this.delete.bind(this),\r\n      queryify: this.queryify.bind(this)\r\n    };\r\n  }\r\n\r\n  get(url: string, headers?: ExpandableObject) {\r\n    return this.send(url, 'get', {}, headers);\r\n  }\r\n\r\n  post(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'post', body, headers);\r\n  }\r\n\r\n  _put(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'put', body, headers);\r\n  }\r\n\r\n  patch(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'patch', body, headers);\r\n  }\r\n\r\n  delete(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'delete', body, headers);\r\n  }\r\n\r\n  async send(\r\n    url: string,\r\n    method: Method,\r\n    body: ExpandableObject | string = {},\r\n    headers: ExpandableObject\r\n  ) {\r\n    const requestHeaders = Object.assign({}, this.public.object.headers);\r\n\r\n    if (headers)\r\n      Object.keys(headers).forEach(header => {\r\n        requestHeaders[header] = headers[header];\r\n      });\r\n\r\n    // If method is not get set application type\r\n    if (method !== 'get' && requestHeaders['Content-Type'] === undefined)\r\n      requestHeaders['Content-Type'] = 'application/json';\r\n\r\n    let fullURL;\r\n\r\n    if (url.startsWith('http')) fullURL = url;\r\n    else fullURL = `${this.public.object.baseURL}/${url}`;\r\n\r\n    // Stringify body\r\n    body = JSON.stringify(body);\r\n\r\n    // Build options\r\n    this.options = {};\r\n    this.options.credentials = this.public.object.credentials;\r\n    this.options.mode = this.public.object.mode;\r\n\r\n    // Build final fetch options object\r\n    const options = Object.assign(\r\n      {\r\n        headers: requestHeaders,\r\n        method: method.toUpperCase(),\r\n        body: method === 'get' ? null : body\r\n      },\r\n      this.options\r\n    );\r\n\r\n    if (this.requestIntercept)\r\n      this.requestIntercept(this.global.getContext(), options);\r\n\r\n    let response: any;\r\n\r\n    if (this.timeout) {\r\n      response = await Promise.race([\r\n        fetch(fullURL, options),\r\n        new Promise((resolve, reject) =>\r\n          setTimeout(() => reject('timeout'), this.timeout)\r\n        )\r\n      ]);\r\n    } else {\r\n      response = await fetch(fullURL, options);\r\n    }\r\n\r\n    const contentType = response.headers.get('content-type');\r\n\r\n    // extract body\r\n    if (contentType && contentType.indexOf('application/json') !== -1) {\r\n      body = await response.json();\r\n    } else {\r\n      body = await response.text();\r\n    }\r\n\r\n    // history\r\n    if (!this.saveHistory)\r\n      this.collect({\r\n        id: Date.now(),\r\n        status: response.status,\r\n        timestamp: new Date(),\r\n        response: body\r\n      });\r\n\r\n    // inject headers into prototype\r\n    let final;\r\n\r\n    // If reponse body is an object, create a custom object with response function in prototype, so headers and the full response data can be accessed outside of this class\r\n    if (!Array.isArray(body) && typeof body === 'object') {\r\n      final = Object.create({\r\n        response: () => {\r\n          return response;\r\n        }\r\n      });\r\n      const keys = Object.keys(body);\r\n      for (let i = 0; i < keys.length; i++) {\r\n        const property = keys[i];\r\n        final[property] = body[property];\r\n      }\r\n      // if the body is not an object, we can not inject a prototype, so just return the rew body\r\n    } else {\r\n      final = body;\r\n    }\r\n    // intercept response\r\n    if (this.responseIntercept) {\r\n      response.data = body;\r\n      this.responseIntercept(this.global.getContext(), response);\r\n    }\r\n\r\n    // reject if bad response status\r\n    if (response.ok || response.redirected) return final;\r\n\r\n    // resolve response\r\n    throw final;\r\n  }\r\n\r\n  // Adapted from: https://github.com/Gozala/querystring/blob/master/encode.js\r\n  queryify(obj) {\r\n    const stringifyPrimitive = function(value) {\r\n      switch (typeof value) {\r\n        case 'string':\r\n          return value;\r\n\r\n        case 'boolean':\r\n          return value ? 'true' : 'false';\r\n\r\n        case 'number':\r\n          return isFinite(value) ? value : '';\r\n\r\n        default:\r\n          return '';\r\n      }\r\n    };\r\n    // validate input\r\n    if (typeof obj != 'object') return;\r\n\r\n    return Object.keys(obj)\r\n      .map(key => {\r\n        const encodedKey = encodeURIComponent(stringifyPrimitive(key)) + '=';\r\n        // if value is an array, encode with same key as parent\r\n        if (Array.isArray(obj[key]))\r\n          return obj[key]\r\n            .map(value => {\r\n              return encodedKey + encodeURIComponent(stringifyPrimitive(value));\r\n            })\r\n            .join('&');\r\n        // join encoded key with value\r\n        return encodedKey + encodeURIComponent(stringifyPrimitive(obj[key]));\r\n      })\r\n      .join('&');\r\n  }\r\n}\r\n","import Collection from '../collection';\r\nimport { Global, RootCollectionObject } from '../interfaces';\r\n\r\nexport default class Request extends Collection {\r\n  constructor(global: Global, root: RootCollectionObject = {}) {\r\n    root = Object.assign({}, root);\r\n\r\n    // Base as a collection is configured directly from the root of the Pulse config,\r\n    // thus to be verbose we remove the properties only used for global setup\r\n    // default collection properties like data, computed, actions etc will remain\r\n    delete root.collections;\r\n    delete root.request;\r\n\r\n    // if user has not created data or persist properties, create them for the defaults.\r\n    if (!root.data) root.data = {};\r\n    if (!root.persist) root.persist = [];\r\n\r\n    // can be used to preserve authenticated state\r\n    // automatically persists if local storage is availible\r\n    root.data['isAuthenticated'] = false;\r\n    root.persist.push('isAuthenticated');\r\n\r\n    // can be used to declare once the app has finished initilazation, does not affect Pulse\r\n    root.data['appReady'] = false;\r\n\r\n    super('base', global, root);\r\n  }\r\n}\r\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _extends() {\r\n  _extends =\r\n    Object.assign ||\r\n    function(target) {\r\n      for (var i = 1; i < arguments.length; i++) {\r\n        var source = arguments[i];\r\n        for (var key in source) {\r\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\r\n            target[key] = source[key];\r\n          }\r\n        }\r\n      }\r\n      return target;\r\n    };\r\n  return _extends.apply(this, arguments);\r\n}\r\n\r\nexport default function withPulse(pulse, React, ReactComponent, selectData) {\r\n  return class extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        ...pulse.mapData(\r\n          selectData,\r\n          this,\r\n          {\r\n            waitForMount:\r\n              pulse._private.global.config.waitForMount === false ? false : true\r\n          },\r\n          pulse\r\n        )\r\n      };\r\n    }\r\n    componentDidMount() {\r\n      if (pulse._private.global.config.waitForMount) pulse.mount(this);\r\n    }\r\n    componentWillUnmount() {\r\n      if (pulse._private.global.config.autoUnmount) pulse.unmount(this);\r\n    }\r\n    render() {\r\n      return React.createElement(\r\n        ReactComponent,\r\n        _extends(\r\n          {\r\n            pulse: this.state\r\n          },\r\n          this.props\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n","import Runtime from './runtime';\r\nimport Collection from './collection';\r\nimport SubController from './subController';\r\nimport Storage from './storage';\r\nimport Request from './collections/request';\r\nimport Base from './collections/base';\r\nimport withPulse from './wrappers/ReactWithPulse';\r\nimport { uuid, normalizeMap, log, defineConfig, parse } from './helpers';\r\nimport { Private, RootCollectionObject, DebugType } from './interfaces';\r\nimport { JobType } from './runtime';\r\n\r\nimport RelationController, { Key } from './relationController';\r\nimport Dep from './dep';\r\n\r\nexport default class Library {\r\n  _private: Private;\r\n  [key: string]: any;\r\n  constructor(root: RootCollectionObject = {}) {\r\n    // Private object contains all internal Pulse data\r\n    this._private = {\r\n      runtime: null,\r\n      events: {},\r\n      collections: {},\r\n      collectionKeys: [],\r\n      // global is passed in to all classes, must not contain cyclic references\r\n      global: {\r\n        config: this.prepareConfig(root.config),\r\n        // State\r\n        initComplete: false,\r\n        runningAction: false,\r\n        runningWatcher: false,\r\n        runningComputed: false,\r\n        runningPopulate: false,\r\n        collecting: false,\r\n        touching: false,\r\n        touched: false,\r\n        contextRef: {},\r\n        // Instances\r\n        subs: new SubController(this.getContext.bind(this)),\r\n        relations: null,\r\n        storage: null,\r\n        // Function aliases\r\n        ticket: this.ticket.bind(this),\r\n        cleanupTickets: this.cleanupTickets.bind(this),\r\n        dispatch: this.dispatch.bind(this),\r\n        getInternalData: this.getInternalData.bind(this),\r\n        getContext: this.getContext.bind(this),\r\n        getDep: this.getDep.bind(this),\r\n        uuid\r\n      }\r\n    };\r\n\r\n    // Bind static objects to instance (utils and services eventually should be initialized)\r\n    ['utils', 'services', 'staticData'].forEach(type => {\r\n      if (root[type]) this[type] = root[type];\r\n    });\r\n\r\n    // Create storage instance\r\n    this._private.global.storage = new Storage(root.storage);\r\n\r\n    // Create relation controller instance\r\n    this._private.global.relations = new RelationController(\r\n      this._private.global\r\n    );\r\n\r\n    // Prepare\r\n    this.initCollections(root);\r\n    this.initRuntime();\r\n\r\n    // Finalize\r\n    this.bindCollectionPublicData();\r\n    this.runAllComputed();\r\n\r\n    this.initComplete();\r\n  }\r\n\r\n  initCollections(root: RootCollectionObject) {\r\n    this._private.collectionKeys = [];\r\n    if (root.collections) {\r\n      this._private.collectionKeys = [\r\n        ...Object.keys(root.collections),\r\n        ...this._private.collectionKeys\r\n      ];\r\n      for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n        // Create collection instance\r\n        this._private.collections[\r\n          this._private.collectionKeys[i]\r\n        ] = new Collection(\r\n          this._private.collectionKeys[i], // name\r\n          this._private.global, // global\r\n          root.collections[this._private.collectionKeys[i]] // collection config\r\n        );\r\n      }\r\n    }\r\n    // Create request class\r\n    if (this._private.global.config.enableRequest !== false)\r\n      this._private.collectionKeys.push('request');\r\n    this._private.collections['request'] = new Request(\r\n      this._private.global,\r\n      root.request || {}\r\n    );\r\n\r\n    // Create base class\r\n    if (this._private.global.config.enableBase !== false) {\r\n      this._private.collectionKeys.push('base');\r\n      this._private.collections['base'] = new Base(this._private.global, root);\r\n    }\r\n  }\r\n\r\n  initRuntime() {\r\n    this._private.runtime = new Runtime(\r\n      this._private.collections,\r\n      this._private.global\r\n    );\r\n  }\r\n\r\n  private bindCollectionPublicData(): void {\r\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n      const collection = this._private.collections[\r\n        this._private.collectionKeys[i]\r\n      ];\r\n      this._private.global.contextRef[this._private.collectionKeys[i]] =\r\n        collection.public.object;\r\n      this[this._private.collectionKeys[i]] = collection.public.object;\r\n    }\r\n  }\r\n\r\n  runAllComputed() {\r\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n      const collection = this._private.collections[\r\n        this._private.collectionKeys[i]\r\n      ];\r\n\r\n      const computedKeys = collection.keys.computed;\r\n      for (let i = 0; i < computedKeys.length; i++) {\r\n        const computedName = computedKeys[i];\r\n        this._private.runtime.performComputedOutput({\r\n          collection: collection.name,\r\n          property: computedName,\r\n          type: JobType.COMPUTED_REGEN\r\n        });\r\n        collection.runWatchers(computedName);\r\n      }\r\n    }\r\n  }\r\n\r\n  initComplete() {\r\n    this._private.global.initComplete = true;\r\n    log('INIT COMPLETE', Object.assign({}, this));\r\n    if (!this._private.global.config.ssr) {\r\n      try {\r\n        window._pulse = this;\r\n      } catch (e) {}\r\n    }\r\n  }\r\n\r\n  public wrapped(ReactComponent, mapData) {\r\n    const config = this._private.global.config;\r\n    if (config.framework === 'react' && config.frameworkConstructor) {\r\n      return withPulse(\r\n        this,\r\n        config.frameworkConstructor,\r\n        ReactComponent,\r\n        mapData\r\n      );\r\n    } else return false;\r\n  }\r\n\r\n  private prepareConfig(config) {\r\n    // defaults\r\n    config = defineConfig(config, {\r\n      framework: null,\r\n      waitForMount: false,\r\n      autoUnmount: false\r\n    });\r\n\r\n    // detect if framework passed in is a React constructor\r\n    if (\r\n      config.framework &&\r\n      config.framework.hasOwnProperty(\r\n        '__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED'\r\n      )\r\n    ) {\r\n      config.frameworkConstructor = config.framework;\r\n      config.framework = 'react';\r\n    }\r\n\r\n    if (config.framework === 'react') {\r\n      if (config.waitForMount != false) config.waitForMount = true;\r\n      if (config.autoUnmount != false) config.autoUnmount = true;\r\n    }\r\n    return config;\r\n  }\r\n\r\n  getInternalData(collection, primaryKey) {\r\n    return this._private.collections[collection].findById(primaryKey);\r\n  }\r\n\r\n  // returns Dep instance by \"touching\" reactive property revealing its Dep class\r\n  // if collection param is present we'll assume the property param is the name of the property, not a reference to the property itself\r\n  getDep(property: any, collection: string): Dep {\r\n    this._private.global.touching = true;\r\n\r\n    // \"touching\" is simply invoking the property's getter\r\n\r\n    if (typeof collection === 'string') {\r\n      this._private.collections[collection].public.object[property];\r\n    } else if (typeof collection === 'object') {\r\n      collection[property];\r\n    }\r\n\r\n    // Extract the dep\r\n    const dep = this._private.global.touched as Dep;\r\n    this._private.global.touching = false;\r\n    this._private.global.touched = null;\r\n\r\n    return dep as Dep;\r\n  }\r\n\r\n  dispatch(type: string, payload) {\r\n    switch (type) {\r\n      case 'mutation':\r\n        this._private.runtime.ingest({\r\n          type: JobType.PUBLIC_DATA_MUTATION,\r\n          collection: payload.collection,\r\n          property: payload.key,\r\n          value: payload.value,\r\n          dep: payload.dep\r\n        });\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  getContext(collection) {\r\n    const c = this._private.collections[collection];\r\n    if (!c) return this._private.global.contextRef;\r\n    return {\r\n      ...this._private.global.contextRef,\r\n      ...c.methods,\r\n      data: c.public.object,\r\n      indexes: c.indexes.object,\r\n      groups: c.public.object,\r\n      computed: c.public.object,\r\n      routes: c.public.object.routes,\r\n      local: c.local\r\n    };\r\n  }\r\n\r\n  install(Vue) {\r\n    this._private.global.config.framework = 'vue';\r\n    const pulse = this;\r\n    const config = pulse._private.global.config;\r\n    Vue.mixin({\r\n      beforeCreate() {\r\n        Object.keys(pulse._private.global.contextRef).forEach(collection => {\r\n          this['$' + collection] = pulse._private.global.contextRef[collection];\r\n        });\r\n\r\n        if (pulse.utils) this.$utils = pulse.utils;\r\n        if (pulse.services) this.$services = pulse.services;\r\n        if (pulse.staticData) this.$staticData = pulse.staticData;\r\n\r\n        this.mapData = properties =>\r\n          pulse.mapData(\r\n            properties,\r\n            this,\r\n            {\r\n              waitForMount: config.waitForMount\r\n            },\r\n            pulse\r\n          );\r\n      },\r\n      mounted() {\r\n        if (this.__pulseUniqueIdentifier && config.waitForMount)\r\n          pulse.mount(this);\r\n      },\r\n      beforeDestroy() {\r\n        if (this.__pulseUniqueIdentifier && config.autoUnmount)\r\n          pulse.unmount(this);\r\n      }\r\n    });\r\n  }\r\n\r\n  mount(instance) {\r\n    this._private.global.subs.mount(instance);\r\n  }\r\n\r\n  unmount(instance) {\r\n    this._private.global.subs.unmount(instance);\r\n  }\r\n\r\n  mapData(properties, instance = {}, _config = {}, pulseAlias?: any) {\r\n    let pulse = pulseAlias ? pulseAlias : this;\r\n    const config = {\r\n      waitForMount: true,\r\n      ..._config\r\n    };\r\n    const componentUUID = pulse._private.global.subs.registerComponent(\r\n      instance,\r\n      config\r\n    );\r\n    // new cool mapData method\r\n    if (typeof properties === 'function') {\r\n      return pulse._private.global.subs.subscribePropertiesToComponents(\r\n        properties,\r\n        componentUUID\r\n      );\r\n      // legacy support....\r\n    } else if (typeof properties === 'object') {\r\n      let returnData = {};\r\n      normalizeMap(properties).forEach(({ key, val }) => {\r\n        let collection = val.split('/')[0];\r\n        let property = val.split('/')[1];\r\n        let c = pulse._private.global.getContext()[collection];\r\n        returnData[\r\n          key\r\n        ] = pulse._private.global.subs.subscribePropertiesToComponents(() => {\r\n          return { [key]: c[property] };\r\n        }, componentUUID)[key];\r\n      });\r\n      return returnData;\r\n    }\r\n  }\r\n\r\n  emit(name: string, payload: any): void {\r\n    if (this._private.events[name])\r\n      for (let i = 0; i < this._private.events[name].length; i++) {\r\n        const callback = this._private.events[name][i];\r\n        callback(payload);\r\n      }\r\n  }\r\n  on(name: string, callback: () => any): void {\r\n    if (!Array.isArray(this._private.events[name]))\r\n      this._private.events[name] = [callback];\r\n    else this._private.events[name].push(callback);\r\n  }\r\n\r\n  // root alias for relationController to access ticket function of a given collection\r\n  ticket(collection: string, uuid: string, key: Key) {\r\n    const primaryKey = parse(key).primaryKey;\r\n    this._private.collections[collection].ticket(uuid, primaryKey);\r\n  }\r\n\r\n  // root alias for relationController to access cleanupTicket function of a given collection\r\n  cleanupTickets(key): void {\r\n    const parsed = parse(key);\r\n\r\n    this._private.collections[parsed.collection].cleanupTickets(\r\n      parsed.primaryKey\r\n    );\r\n  }\r\n\r\n  log(type: DebugType): void {\r\n    // let debugMode: Set<DebugType> = this._private.global.config.debugMode;\r\n    // if (debugMode.size === 0) return;\r\n    // if (debugMode.has(DebugType.ERRORS)) {\r\n    // }\r\n    // log(DebugType.ASSERT, `There was an error with \"${thing}\", bad :(`);\r\n    // const AssertMessages = {\r\n    //   INDEX_UPDATE_FAILED: (collection, property) =>\r\n    //     `The type ${collection} is ${property}.`\r\n    //   // and more\r\n    // };\r\n    // function _log(callback) {\r\n    // }\r\n    // _log(({ AssertMessages }) => AssertMessages.INDEX_UPDATE_FAILED(thing, thing2));\r\n  }\r\n}\r\n"],"names":["tslib_1.__extends","_typeof","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","withPulse","pulse","React","ReactComponent","selectData","props","state","mapData","waitForMount","_private","global","config","mount","autoUnmount","unmount","createElement","Component","Base"],"mappings":"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"}