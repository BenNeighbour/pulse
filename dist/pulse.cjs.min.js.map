{"version":3,"file":"pulse.cjs.min.js","sources":["../lib2/helpers.ts","../lib2/runtime.ts","../lib2/computed.ts","../lib2/relationController.ts","../lib2/dep.ts","../lib2/reactive.ts","../lib2/action.ts","../lib2/collection.ts","../lib2/subController.ts","../lib2/storage.ts","../lib2/collections/request.ts","../lib2/collections/base.ts","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/objectSpread.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../lib2/wrappers/ReactWithPulse.js","../lib2/library.ts"],"sourcesContent":["export const protectedNames = [\r\n  'data',\r\n  'indexes',\r\n  'groups',\r\n  'computed',\r\n  'actions',\r\n  'routes'\r\n];\r\n\r\nexport const collectionFunctions = [\r\n  'collect',\r\n  'replaceIndex',\r\n  'getGroup',\r\n  'newGroup',\r\n  'deleteGroup',\r\n  'removeFromGroup',\r\n  'update',\r\n  'increment',\r\n  'decrement',\r\n  'delete',\r\n  'purge',\r\n  'watch',\r\n  'findById',\r\n  'put',\r\n  'move',\r\n  'throttle',\r\n  // deprecated\r\n  'remove'\r\n];\r\n\r\nexport function defineConfig(config, defaults) {\r\n  return { ...defaults, ...config };\r\n}\r\n\r\nexport function parse(key: string) {\r\n  return {\r\n    collection: key.split('/')[0],\r\n    primaryKey: key.split('/')[1]\r\n  };\r\n}\r\n\r\nexport function uuid() {\r\n  return (\r\n    Math.random()\r\n      .toString()\r\n      .split('.')[1] + Date.now()\r\n  );\r\n}\r\n\r\nexport function objectLoop(object, callback, keys?: Array<any>) {\r\n  const objectKeys = keys ? keys : Object.keys(object);\r\n  for (let i = 0; i < objectKeys.length; i++) {\r\n    const key: string = objectKeys[i];\r\n    const value: any = object[key];\r\n    callback(key, value, objectKeys);\r\n  }\r\n}\r\n\r\n// const thing = {}\r\n// objectLoop(thing, (thingKey, thingItem) => {\r\n\r\n// })\r\n\r\nexport function log(value: any, payload?: any) {\r\n  // console.log(`Pulse / ${value}`, payload ? payload : ' ');\r\n}\r\nexport function key(collection: string, property?: string | number) {\r\n  return `${collection}/${property}`;\r\n}\r\n\r\nexport function normalizeMap(map) {\r\n  return Array.isArray(map)\r\n    ? map.map(key => ({ key, val: key }))\r\n    : Object.keys(map).map(key => ({ key, val: map[key] }));\r\n}\r\n\r\nexport const arrayFunctions = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'splice',\r\n  'sort',\r\n  'reverse'\r\n];\r\n\r\nexport function assert(\r\n  func: (warnings: { [key: string]: any }) => any,\r\n  funcName?: string\r\n) {\r\n  function warn(message) {\r\n    // if (funcName) console.log(`PULSE // \"${funcName}()\" :: ${message}`);\r\n    // else console.warn(`PULSE :: ${message}`);\r\n    return false;\r\n  }\r\n  const warnings = {\r\n    NO_PRIMARY_KEY: () => warn('No primary $1 key found! $2'),\r\n    INVALID_PARAMETER: () => warn('Invalid parameter supplied to function.'),\r\n    INDEX_NOT_FOUND: () => warn('Index was not found on collection.'),\r\n    INTERNAL_DATA_NOT_FOUND: () => warn('Data was not found on collection.'),\r\n    PROPERTY_NOT_A_NUMBER: () => warn('Property is not a number!')\r\n  };\r\n  return func(warnings)();\r\n}\r\n\r\nexport function isWatchableObject(value) {\r\n  function isHTMLElement(obj) {\r\n    try {\r\n      return obj instanceof HTMLElement;\r\n    } catch (e) {\r\n      return (\r\n        typeof obj === 'object' &&\r\n        obj.nodeType === 1 &&\r\n        typeof obj.style === 'object' &&\r\n        typeof obj.ownerDocument === 'object'\r\n      );\r\n    }\r\n  }\r\n  let type = typeof value;\r\n  return (\r\n    value != null &&\r\n    type == 'object' &&\r\n    !isHTMLElement(value) &&\r\n    !Array.isArray(value)\r\n  );\r\n}\r\n\r\nexport function validateNumber(mutable, amount) {\r\n  if (typeof amount !== 'number' || typeof mutable !== 'number') {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n","import { log, objectLoop, log } from './helpers';\r\nimport { Job, Global } from './interfaces';\r\nimport Dep from './Dep';\r\n\r\nexport enum JobType {\r\n  PUBLIC_DATA_MUTATION = 'PUBLIC_DATA_MUTATION',\r\n  INTERNAL_DATA_MUTATION = 'INTERNAL_DATA_MUTATION',\r\n  INDEX_UPDATE = 'INDEX_UPDATE',\r\n  COMPUTED_REGEN = 'COMPUTED_REGEN',\r\n  GROUP_UPDATE = 'GROUP_UPDATE',\r\n  DEEP_PUBLIC_DATA_MUTATION = 'DEEP_PUBLIC_DATA_MUTATION',\r\n  DELETE_INTERNAL_DATA = 'DELETE_INTERNAL_DATA'\r\n}\r\nexport default class Runtime {\r\n  public running: Boolean = false;\r\n  public updatingSubscribers: Boolean = false;\r\n\r\n  private ingestQueue: Array<Job> = [];\r\n  private completedJobs: Array<Job> = [];\r\n  private archivedJobs: Array<Job> = [];\r\n\r\n  // private collections: Object;\r\n  private config: Object;\r\n\r\n  constructor(private collections: Object, private global: Global) {\r\n    global.ingest = this.ingest.bind(this);\r\n    this.config = global.config;\r\n  }\r\n\r\n  // The primary entry point for Runtime, all jobs should come through here\r\n  public ingest(job: Job): void {\r\n    this.ingestQueue.push(job);\r\n    if (!this.running) {\r\n      this.findNextJob();\r\n    }\r\n  }\r\n\r\n  private findNextJob() {\r\n    this.running = true;\r\n    // shift the next job from the queue\r\n    let next = this.ingestQueue.shift();\r\n\r\n    if (!next.dep)\r\n      // groups, computed and indexes will not have their Dep class, so get it.\r\n      next.dep = this.global.getDep(next.property, next.collection);\r\n\r\n    // execute the next task in the queue\r\n    this.performJob(next);\r\n  }\r\n\r\n  private performJob(job: Job): void {\r\n    switch (job.type) {\r\n      case JobType.PUBLIC_DATA_MUTATION:\r\n        this.performPublicDataUpdate(job);\r\n        this.collections[job.collection].runWatchers(job.property);\r\n        break;\r\n      case JobType.INTERNAL_DATA_MUTATION:\r\n        this.performInternalDataUpdate(job);\r\n        break;\r\n      case JobType.INDEX_UPDATE:\r\n        this.performIndexUpdate(job);\r\n        break;\r\n      case JobType.COMPUTED_REGEN:\r\n        this.performComputedOutput(job);\r\n        this.collections[job.collection].runWatchers(job.property.name);\r\n        break;\r\n      case JobType.GROUP_UPDATE:\r\n        this.performGroupRebuild(job);\r\n        this.collections[job.collection].runWatchers(job.property);\r\n        break;\r\n      case JobType.DELETE_INTERNAL_DATA:\r\n        this.performInternalDataDeletion(job);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    // unpack dependents\r\n    if (job.dep && job.dep.dependents.size > 0) {\r\n      // log(`Queueing ${dep.dependents.size} dependents`);\r\n      job.dep.dependents.forEach(computed => {\r\n        // get dep from public computed output\r\n        this.ingest({\r\n          type: JobType.COMPUTED_REGEN,\r\n          collection: computed.collection,\r\n          property: computed,\r\n          dep: this.global.getDep(computed.name, computed.collection)\r\n        });\r\n      });\r\n    }\r\n    this.finished();\r\n  }\r\n\r\n  // handle job loop flow\r\n  private finished(): void {\r\n    this.running = false;\r\n    if (this.completedJobs.length > 5000) return;\r\n\r\n    // If there's already more stuff in the queue, loop.\r\n    if (this.ingestQueue.length > 0) {\r\n      this.findNextJob();\r\n      return;\r\n    }\r\n\r\n    // Wait until callstack is empty to check if we should finalise this body of work\r\n    setTimeout(() => {\r\n      if (this.ingestQueue.length === 0) {\r\n        if (!this.updatingSubscribers) this.compileComponentUpdates();\r\n        this.cleanup();\r\n      } else {\r\n        // loop more!\r\n        this.findNextJob();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ****************** Perform Functions ****************** //\r\n\r\n  private performPublicDataUpdate(job: Job): void {\r\n    this.writeToPublicObject(job.collection, 'data', job.property, job.value);\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performInternalDataUpdate(job: Job): void {\r\n    job.previousValue = this.overwriteInternalData(\r\n      job.collection,\r\n      job.property,\r\n      job.value\r\n    );\r\n\r\n    // collection function handels ingesting indexes to update itself, since it waits until\r\n    // all internal data has been ingested before handling the affected indexes\r\n    // however for direct data modifications we should update afected indexes\r\n    if (!this.global.collecting) {\r\n      // affected indexes is an array of indexes that have this primary key (job.property) present.\r\n      const affectedIndexes: Array<string> = this.collections[\r\n        job.collection\r\n      ].searchIndexesForPrimaryKey(job.property);\r\n\r\n      affectedIndexes.forEach(index => {\r\n        // since this is a singular piece of data that has changed, we do not need to\r\n        // rebuild the entire group, so we can soft rebuild\r\n        let modifiedGroup = this.collections[\r\n          job.collection\r\n        ].softUpdateGroupData(job.property, index);\r\n\r\n        this.ingest({\r\n          type: JobType.GROUP_UPDATE,\r\n          collection: job.collection,\r\n          value: modifiedGroup,\r\n          property: index,\r\n          dep: this.global.getDep(index, job.collection)\r\n          // we do not need a previousValue because groups are cached outputs and reversing the internal data update will do the trick\r\n        });\r\n      });\r\n    }\r\n\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performInternalDataDeletion(job: Job): void {\r\n    const c = this.collections[job.collection];\r\n    // preserve previous value\r\n    job.previousValue = { ...c.internalData[job.property] };\r\n    // delete data\r\n    delete c.internalData[job.property];\r\n    // find indexes affected by this data deletion\r\n    const indexesToUpdate = this.collections[\r\n      job.collection\r\n    ].searchIndexesForPrimaryKey(job.collection, job.property);\r\n\r\n    // for each found index, perform index update\r\n    for (let i = 0; i < indexesToUpdate.length; i++) {\r\n      const indexName = indexesToUpdate[i];\r\n      const newIndex = [...c.indexes.object[indexName]].filter(\r\n        id => id !== job.property\r\n      );\r\n      this.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: c.name,\r\n        property: indexName,\r\n        value: newIndex,\r\n        dep: this.global.getDep(job.property, job.collection)\r\n      });\r\n    }\r\n    this.completedJob(job);\r\n  }\r\n\r\n  private performIndexUpdate(job: Job): void {\r\n    // preserve old index\r\n    job.previousValue = this.collections[job.collection].indexes[job.property];\r\n    // Update Index\r\n    this.collections[job.collection].indexes.privateWrite(\r\n      job.property,\r\n      job.value\r\n    );\r\n    this.completedJob(job);\r\n\r\n    // Group must also be updated\r\n    this.ingest({\r\n      type: JobType.GROUP_UPDATE,\r\n      collection: job.collection,\r\n      property: job.property,\r\n      dep: this.global.getDep(job.property, job.collection)\r\n    });\r\n  }\r\n\r\n  private performGroupRebuild(job: Job): void {\r\n    // soft group rebuilds already have a generated value, otherwise generate the value\r\n    if (!job.value) {\r\n      job.value = this.collections[job.collection].buildGroupFromIndex(\r\n        job.property\r\n      );\r\n    }\r\n\r\n    // TODO: trigger relaction controller to update group relations\r\n    // this.global.relations.groupModified(job.collection, job.property);\r\n\r\n    this.writeToPublicObject(job.collection, 'group', job.property, job.value);\r\n    this.completedJob(job);\r\n  }\r\n\r\n  public performComputedOutput(job: Job): void {\r\n    const computed =\r\n      typeof job.property === 'string'\r\n        ? this.collections[job.collection].computed[job.property]\r\n        : job.property;\r\n\r\n    job.value = computed.run();\r\n    // Commit Update\r\n    this.writeToPublicObject(\r\n      job.collection,\r\n      'computed',\r\n      computed.name,\r\n      job.value\r\n    );\r\n    this.completedJob(job);\r\n  }\r\n\r\n  // ****************** Handlers ****************** //\r\n\r\n  private completedJob(job: Job): void {\r\n    // if action is running, save that action instance inside job payload\r\n    job.fromAction = this.global.runningAction;\r\n    // during runtime log completed job ready for component updates\r\n    if (this.global.initComplete) this.completedJobs.push(job);\r\n    // if data is persistable ensure storage is updated with new data\r\n    this.persistData(job);\r\n    // inform Dep class that the job is complete\r\n    if (job.dep) (job.dep as Dep).changed();\r\n    // inform the collection that the job is complete\r\n    this.collections[job.collection].changed(job.property);\r\n    // if either of these contain tickets, the relation controller will ingest updates\r\n  }\r\n\r\n  // ****************** End Runtime Events ****************** //\r\n\r\n  private compileComponentUpdates(): void {\r\n    if (!this.global.initComplete) return;\r\n    this.updatingSubscribers = true;\r\n    log('ALL JOBS COMPLETE', this.completedJobs);\r\n    log('Updating components...');\r\n\r\n    const componentsToUpdate = {};\r\n\r\n    // for all completed jobs\r\n    for (let i = 0; i < this.completedJobs.length; i++) {\r\n      const job = this.completedJobs[i];\r\n\r\n      // if job has a Dep class present\r\n      // Dep class contains subscribers to that property (as a completed job)\r\n      if (job.dep) {\r\n        let subscribers: Array<any> = job.dep.subscribers;\r\n\r\n        // for all the subscribers\r\n        for (let i = 0; i < subscribers.length; i++) {\r\n          // add to componentsToUpdate (ensuring update & component is unique)\r\n          const uuid = subscribers[i].componentUUID;\r\n          const key = subscribers[i].key;\r\n          if (!componentsToUpdate[uuid]) {\r\n            componentsToUpdate[uuid] = {};\r\n            componentsToUpdate[uuid][key] = job.value;\r\n          } else {\r\n            componentsToUpdate[uuid][key] = job.value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.updateSubscribers(componentsToUpdate);\r\n    this.completedJobs = [];\r\n  }\r\n\r\n  private updateSubscribers(componentsToUpdate) {\r\n    const componentKeys = Object.keys(componentsToUpdate);\r\n    for (let i = 0; i < componentKeys.length; i++) {\r\n      const componentID = componentKeys[i];\r\n      const componentInstance = this.global.subs.componentStore[componentID];\r\n      if (!componentInstance || !componentInstance.instance) return;\r\n      const propertiesToUpdate = componentsToUpdate[componentID];\r\n      const dataKeys = Object.keys(propertiesToUpdate);\r\n      // Switch depending on framework\r\n      switch (this.global.config.framework) {\r\n        case 'vue':\r\n          dataKeys.forEach(property => {\r\n            const value = propertiesToUpdate[property];\r\n            componentInstance.instance.$set(\r\n              componentInstance.instance,\r\n              property,\r\n              value\r\n            );\r\n          });\r\n          break;\r\n        case 'react':\r\n          componentInstance.instance.setState(propertiesToUpdate);\r\n          // console.log(propertiesToUpdate);\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private persistData(job: Job): void {\r\n    if (job.type === JobType.INTERNAL_DATA_MUTATION) return;\r\n    if (this.collections[job.collection].persist.includes(job.property)) {\r\n      this.global.storage.set(job.collection, job.property, job.value);\r\n    }\r\n  }\r\n\r\n  private cleanup(): void {\r\n    setTimeout(() => {\r\n      this.updatingSubscribers = false;\r\n    });\r\n  }\r\n\r\n  // ****************** Misc Handlers ****************** //\r\n\r\n  private writeToPublicObject(\r\n    collection: string,\r\n    type: string,\r\n    key: string,\r\n    value: any\r\n  ): void {\r\n    if (type === 'indexes') {\r\n      if (!this.collections[collection][type].object.hasOwnProperty(key))\r\n        return;\r\n      this.collections[collection][type].privateWrite(key, value);\r\n    } else {\r\n      if (!this.collections[collection].public.object.hasOwnProperty(key))\r\n        return;\r\n      this.collections[collection].public.privateWrite(key, value);\r\n    }\r\n  }\r\n\r\n  private overwriteInternalData(\r\n    collection: string,\r\n    primaryKey: string | number,\r\n    newData: any\r\n  ): object | boolean {\r\n    const internalData = this.collections[collection].internalData;\r\n    // create a copy of the original data\r\n    const currentData = internalData[primaryKey]\r\n      ? { ...internalData[primaryKey] }\r\n      : false;\r\n\r\n    if (currentData) {\r\n      // data already exists, merge objects and return previous object\r\n      const keys = Object.keys(newData);\r\n      for (let i = 0; i < keys.length; i++) {\r\n        const property = keys[i];\r\n        internalData[primaryKey][property] = newData[property];\r\n      }\r\n      return currentData;\r\n    } else {\r\n      // data does not exist, write and return false\r\n      internalData[primaryKey] = newData;\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import { Global } from './interfaces';\r\n\r\nexport default class Computed {\r\n  public relatedToGroup: Array<any> = [];\r\n  public relatedToInternalData: Array<any> = [];\r\n\r\n  constructor(\r\n    private global: Global,\r\n    public collection: string,\r\n    public name: string,\r\n    private computedFunction: (context: object) => any\r\n  ) {}\r\n\r\n  public run() {\r\n    this.global.runningComputed = this;\r\n\r\n    let output = this.computedFunction(this.global.getContext(this.collection));\r\n\r\n    if (output === undefined || output === null) output = false;\r\n\r\n    this.global.runningComputed = false;\r\n\r\n    return output;\r\n  }\r\n}\r\n","import { Global } from './interfaces';\r\nimport Computed from './computed';\r\nimport { JobType } from './runtime';\r\nimport Dep from './dep';\r\nimport { uuid, key, parse } from './helpers';\r\n\r\n// This class is global, since relationships can be between collections.\r\n// Three public functions: relate(), update() & cleanup()\r\n// Collections & Deps get \"tickets\" which are UUIDs that reference relations stored here.\r\n// this is the fastest way to access relations and cleanup from the outside.\r\n// 5 different relationship types currently supported\r\n\r\n// collection/primaryKey\r\nexport type Key = string;\r\n// what to update\r\nexport type UpdateThis = Computed | Key;\r\n// when to update it\r\nexport type WhenThisChanges = Key | Dep;\r\n\r\nexport enum RelationTypes {\r\n  COMPUTED_DEPENDS_ON_DATA, // used by findById() when run in computed\r\n  COMPUTED_DEPENDS_ON_GROUP, // used by getGroup() when run in computed\r\n  DATA_DEPENDS_ON_DEP, // the Dep class of a property when used in populate()\r\n  DATA_DEPENDS_ON_GROUP, // used by getGroup() when run in populate()\r\n  DATA_DEPENDS_ON_DATA // used by findById() when run in populate()\r\n}\r\nexport interface Relation {\r\n  type: RelationTypes;\r\n  updateThis: UpdateThis;\r\n  whenThisChanges: WhenThisChanges;\r\n  uuid: any;\r\n}\r\nexport default class RelationController {\r\n  private relations: { [key: string]: Relation } = {};\r\n  private cleanupRefs: { [key: string]: Array<string> } = {};\r\n  constructor(private global: Global) {}\r\n\r\n  private save(\r\n    id: any,\r\n    type: RelationTypes,\r\n    updateThis: UpdateThis,\r\n    whenThisChanges: WhenThisChanges\r\n  ) {\r\n    this.relations[id] = {\r\n      // uuid: id,\r\n      type,\r\n      updateThis,\r\n      whenThisChanges\r\n    };\r\n  }\r\n\r\n  private cleanup(cleanupKey: string): void {\r\n    if (!this.cleanupRefs[cleanupKey]) return;\r\n    // delete relations for this cleanupKey based on the tickets saved\r\n    this.cleanupRefs[cleanupKey].forEach(ticket => {\r\n      const whenThisChanges = this.relations[ticket].whenThisChanges;\r\n\r\n      this.global.cleanupTickets(whenThisChanges);\r\n\r\n      delete this.relations[ticket];\r\n    });\r\n\r\n    // empty old tickets ready for new evaluation\r\n    this.cleanupRefs[cleanupKey] = [];\r\n  }\r\n\r\n  private saveTicketsByCleanupKey(cleanupKey, ticket) {\r\n    if (Array.isArray(this.cleanupRefs[cleanupKey]))\r\n      this.cleanupRefs[cleanupKey].push(ticket);\r\n    // create new array with ticket already inside\r\n    else this.cleanupRefs[cleanupKey] = [ticket];\r\n  }\r\n\r\n  public relate(\r\n    type: RelationTypes,\r\n    updateThis: UpdateThis,\r\n    whenThisChanges: WhenThisChanges,\r\n    collection?: string // needed for data relations\r\n  ): void {\r\n    // a unique identifier for this relation increases speed finding & cleaning up relations\r\n    const ticket = uuid();\r\n\r\n    // if collection is set we change whenThisChanges (expected as a primaryKey)\r\n    // to be a key with the collection/key\r\n    if (collection) whenThisChanges = key(collection, whenThisChanges as Key);\r\n\r\n    // cleanup previous relations for this cleanup key\r\n    let cleanupKey: string;\r\n\r\n    // cleanup key is already set\r\n    if (typeof updateThis === 'string') cleanupKey = updateThis as Key;\r\n    // extract cleanup key from computed instance\r\n    else if (updateThis instanceof Computed)\r\n      cleanupKey = key(\r\n        (updateThis as Computed).collection,\r\n        (updateThis as Computed).name\r\n      );\r\n\r\n    // clean up\r\n    this.cleanup(cleanupKey);\r\n\r\n    // new cleanup ref\r\n    this.saveTicketsByCleanupKey(cleanupKey, ticket);\r\n\r\n    switch (type) {\r\n      //\r\n      case RelationTypes.COMPUTED_DEPENDS_ON_DATA:\r\n        this.global.ticket(collection, ticket, whenThisChanges); // for update\r\n        this.save(ticket, type, updateThis as Computed, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.COMPUTED_DEPENDS_ON_GROUP:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Computed, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_DATA:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_GROUP:\r\n        this.global.ticket(collection, ticket, whenThisChanges);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Key);\r\n\r\n        break;\r\n      //\r\n      case RelationTypes.DATA_DEPENDS_ON_DEP:\r\n        (whenThisChanges as Dep).ticket(ticket);\r\n        this.save(ticket, type, updateThis as Key, whenThisChanges as Dep);\r\n\r\n        break;\r\n    }\r\n  }\r\n\r\n  // this should be called whenever the whenThisChanges value updates\r\n  public update(tickets: Array<string>): void {\r\n    tickets.forEach(ticket => {\r\n      const relation = this.relations[ticket];\r\n\r\n      // console.log(this.relations[ticket]);\r\n      // if (\r\n      //   relation.updateThis instanceof Computed &&\r\n      //   relation.updateThis.name === 'forChannel'\r\n      // )\r\n      //   debugger;\r\n\r\n      switch (relation.type) {\r\n        //\r\n        case RelationTypes.COMPUTED_DEPENDS_ON_DATA:\r\n          this.ingestComputed(relation.updateThis as Computed);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.COMPUTED_DEPENDS_ON_GROUP:\r\n          this.ingestComputed(relation.updateThis as Computed);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_DATA:\r\n          this.privateIngestDataUpdate(relation.updateThis as Key);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_GROUP:\r\n          this.privateIngestDataUpdate(relation.updateThis as Key);\r\n\r\n          break;\r\n        //\r\n        case RelationTypes.DATA_DEPENDS_ON_DEP:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  private ingestComputed(computed: Computed) {\r\n    this.global.ingest({\r\n      type: JobType.COMPUTED_REGEN,\r\n      collection: computed.collection,\r\n      property: computed.name,\r\n      dep: this.global.getDep(computed.name, computed.collection)\r\n    });\r\n  }\r\n\r\n  privateIngestDataUpdate(updateThis: key): void {\r\n    const parsed = parse(updateThis as Key);\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: parsed.collection,\r\n      property: parsed.primaryKey\r\n    });\r\n  }\r\n}\r\n\r\n// export enum RelationTypes {\r\n//   COMPUTED_DEPENDS_ON_DATA, // used by findById() when run in computed                  //DONE\r\n//   // { type: 0, updateThis: Computed, whenThisChanges: collection/primaryKey  }\r\n//   // how: ingest Computed\r\n//   // store uuid on collection (relations = [uuid, uuid]) [cleanup on run]\r\n\r\n//   COMPUTED_DEPENDS_ON_GROUP, // used by getGroup() when run in computed\r\n//   // { type: 1, updateThis: Computed, whenThisChanges: Dep (group)  }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on Computed run]\r\n//   // how: ingest Computed\r\n\r\n//   DATA_DEPENDS_ON_DEP, // the Dep class of a property when used in populate()            //DONE\r\n//   // { type: 2, updateThis: collection/primaryKey, whenThisChanges: Dep (any) }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on data regen]\r\n\r\n//   DATA_DEPENDS_ON_GROUP, // used by getGroup() when run in populate()                    //DONE\r\n//   // { type: 3, updateThis: collection/primaryKey, whenThisChanges: collection/groupName (not a groups have Dep classes)  }\r\n//   // store uuid on Dep (relations = [uuid, uuid]) [cleanup on data regen]\r\n\r\n//   DATA_DEPENDS_ON_DATA // used by findById() when run in populate()\r\n//   // { type: 4, updateThis: collection/primaryKey, whenThisChanges: collection/primaryKey  }\r\n//   // store uuid on collectiternalDataRelations = [uuid, uuid]) [cleanup on data regen]\r\n// }\r\n","import { Global } from './interfaces';\r\nimport { RelationTypes } from './relationController';\r\n\r\nexport default class Dep {\r\n  public dependents: any = new Set();\r\n  public subscribers: Array<object> = [];\r\n  public tickets: Array<string> = [];\r\n\r\n  constructor(\r\n    private global: Global,\r\n    public name: string,\r\n    public rootProperty: string,\r\n    public propertyOnObject: string\r\n  ) {}\r\n\r\n  register() {\r\n    const subs = this.global.subs;\r\n\r\n    if (this.global.runningComputed) {\r\n      this.dependents.add(this.global.runningComputed);\r\n    }\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_DEP,\r\n        this.global.runningPopulate,\r\n        this as Dep\r\n      );\r\n    }\r\n    if (subs.subscribingComponent) {\r\n      this.subscribeComponent();\r\n    }\r\n    if (subs.unsubscribingComponent) {\r\n      // this.subscribers.delete(this.global.subscribingComponent);\r\n    }\r\n  }\r\n\r\n  subscribeComponent() {\r\n    const subs = this.global.subs;\r\n\r\n    if (this.rootProperty && subs.skimmingDeepReactive) {\r\n      subs.prepareNext(this);\r\n      return;\r\n    }\r\n    if (this.rootProperty) {\r\n      subs.foundDeepReactive();\r\n      subs.prepareNext(this);\r\n      return;\r\n    }\r\n    if (!this.rootProperty && subs.skimmingDeepReactive) {\r\n      subs.exitDeepReactive();\r\n    }\r\n\r\n    this.subscribe();\r\n\r\n    subs.prepareNext(this);\r\n  }\r\n  subscribe() {\r\n    const subs = this.global.subs;\r\n    const keys = subs.subscribingComponent.keys;\r\n    const key = keys[subs.subscribingComponentKey];\r\n    const component = {\r\n      componentUUID: subs.subscribingComponent.componentUUID,\r\n      key: key\r\n    };\r\n    this.subscribers.push(component);\r\n  }\r\n  ticket(uuid) {\r\n    this.tickets.push(uuid);\r\n  }\r\n  // this should fire once runtime finish a job with a dep,\r\n  // we can then loop back with the relationController to check\r\n  // for any active relations based on tickets saved in this dep class\r\n  changed() {\r\n    if (this.tickets.length > 0) {\r\n      this.global.relations.update([...this.tickets]);\r\n    }\r\n  }\r\n}\r\n","import { protectedNames, arrayFunctions, isWatchableObject } from './helpers';\r\nimport Dep from './dep';\r\nimport { Global } from './interfaces';\r\n\r\ninterface Obj {\r\n  [key: string]: any;\r\n}\r\n\r\nexport default class Reactive {\r\n  public properties: Array<string>;\r\n  public object: Obj;\r\n  private dispatch: any;\r\n  private allowPrivateWrite: boolean = false;\r\n  private touching: boolean = false;\r\n  private touched: null | Dep;\r\n\r\n  constructor(\r\n    object: Obj = {},\r\n    private global: Global,\r\n    private collection: string,\r\n    public mutable: Array<string>,\r\n    public type: string\r\n  ) {\r\n    this.dispatch = this.global.dispatch;\r\n    this.properties = Object.keys(object);\r\n\r\n    this.object = this.reactiveObject(object);\r\n  }\r\n\r\n  reactiveObject(object: Obj, rootProperty?: string): object {\r\n    const self = this;\r\n    const objectKeys = Object.keys(object);\r\n\r\n    // Loop over all properties of the to-be reactive object\r\n    for (let i = 0; i < objectKeys.length; i++) {\r\n      const key = objectKeys[i];\r\n      const rootProperty = object.rootProperty;\r\n      const currentProperty = key;\r\n      let value = object[key];\r\n\r\n      // If property is an array, make it reactive\r\n      if (Array.isArray(value)) {\r\n        // value = this.reactiveArray(value, key);\r\n        // if property is an object, make it reactive also\r\n      } else if (isWatchableObject(value) && !protectedNames.includes(key)) {\r\n        // rootProperty should be the current key if first deep object\r\n        value = this.deepReactiveObject(\r\n          value,\r\n          rootProperty || key,\r\n          currentProperty\r\n        );\r\n      }\r\n\r\n      // Create an instance of the dependency tracker\r\n      const dep = new Dep(this.global, key, rootProperty, currentProperty);\r\n\r\n      Object.defineProperty(object, key, {\r\n        get: function pulseGetter() {\r\n          if (self.global.touching) {\r\n            self.global.touched = dep;\r\n            return;\r\n          }\r\n          dep.register();\r\n          return value;\r\n        },\r\n        set: function pulseSetter(newValue) {\r\n          // rootProperty indicates if the object is \"deep\".\r\n          if (rootProperty && self.mutable.includes(rootProperty)) {\r\n            // mutate locally\r\n            value = newValue;\r\n            // dispatch mutation for rootProperty\r\n            self.dispatch('mutation', {\r\n              collection: self.collection,\r\n              key: rootProperty,\r\n              value: self.object[rootProperty],\r\n              dep\r\n            });\r\n          } else {\r\n            // if backdoor open or is protected name, allow direct mutation\r\n            if (self.allowPrivateWrite || protectedNames.includes(key))\r\n              return (value = newValue);\r\n\r\n            // if property is mutable dispatch update\r\n            if (self.mutable.includes(key)) {\r\n              self.dispatch('mutation', {\r\n                collection: self.collection,\r\n                key,\r\n                value: newValue,\r\n                dep\r\n              });\r\n              // we did not apply the mutation since runtime will privatly\r\n              // write the result since we dispatched above\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n    return object;\r\n  }\r\n\r\n  deepReactiveObject(value, rootProperty?: string, propertyOnObject?: string) {\r\n    let objectWithCustomPrototype = Object.create({\r\n      rootProperty,\r\n      propertyOnObject\r\n    });\r\n    // repopulate custom object with incoming values\r\n    const keys = Object.keys(value);\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const property = keys[i];\r\n      objectWithCustomPrototype[property] = value[property];\r\n    }\r\n\r\n    this.allowPrivateWrite = true;\r\n    const obj = this.reactiveObject(objectWithCustomPrototype, rootProperty);\r\n    this.allowPrivateWrite = false;\r\n    return obj;\r\n  }\r\n\r\n  reactiveArray(array, key) {\r\n    const self = this;\r\n    const reactiveArray = array.slice();\r\n\r\n    for (let i = 0; i < arrayFunctions.length; i++) {\r\n      const func = arrayFunctions[i];\r\n      const original = Array.prototype[func];\r\n      Object.defineProperty(reactiveArray, func, {\r\n        value: function() {\r\n          const result = original.apply(this, arguments);\r\n          if (self.global.initComplete)\r\n            self.dispatch('mutation', {\r\n              collection: self.collection,\r\n              key,\r\n              value: result\r\n            });\r\n          return result;\r\n        }\r\n      });\r\n    }\r\n    return reactiveArray;\r\n  }\r\n\r\n  privateWrite(property, value) {\r\n    this.allowPrivateWrite = true;\r\n    this.object[property] = value;\r\n    this.allowPrivateWrite = false;\r\n  }\r\n\r\n  privateGetValue(property) {\r\n    return this.object[property];\r\n  }\r\n\r\n  exists(property: string): boolean {\r\n    return !!this.object.hasOwnProperty(property);\r\n  }\r\n}\r\n\r\n// look for computed output access to determine dependencies\r\n// remove computed categories from public object on default config\r\n","import { uuid } from \"./helpers\";\r\nimport { Global } from \"./interfaces\";\r\n\r\nexport default class Action {\r\n  public executing: boolean = false;\r\n  public uuid: string;\r\n  public exec: () => {};\r\n\r\n  constructor(\r\n    private collection: string,\r\n    private global: Global,\r\n    public action: any,\r\n    public actionName: string\r\n  ) {\r\n    this.uuid = uuid();\r\n    this.prepare(action, global, this.global.contextRef.undo);\r\n  }\r\n\r\n  prepare(action, global, undo) {\r\n    const _this = this;\r\n\r\n    this.exec = function() {\r\n      const context = global.getContext(_this.collection);\r\n      context.undo = error => {\r\n        return undo(this.actionName, this.uuid, error);\r\n      };\r\n      global.runningAction = _this;\r\n\r\n      _this.executing = true;\r\n\r\n      const result = action.apply(\r\n        null,\r\n        [context].concat(Array.prototype.slice.call(arguments))\r\n      );\r\n\r\n      _this.executing = false;\r\n      global.runningAction = false;\r\n\r\n      return result;\r\n    };\r\n  }\r\n}\r\n","import {\r\n  assert,\r\n  defineConfig,\r\n  validateNumber,\r\n  collectionFunctions,\r\n  objectLoop,\r\n  key\r\n} from './helpers';\r\nimport Reactive from './reactive';\r\nimport Action from './action';\r\nimport Computed from './computed';\r\nimport { JobType } from './runtime';\r\nimport {\r\n  Methods,\r\n  Keys,\r\n  CollectionObject,\r\n  CollectionConfig,\r\n  Global,\r\n  ExpandableObject\r\n} from './interfaces';\r\nimport { RelationTypes, Key } from './relationController';\r\n\r\nexport default class Collection {\r\n  private namespace: CollectionObject;\r\n  public public: Reactive;\r\n  public indexes: Reactive;\r\n  public config: CollectionConfig = {};\r\n  public keys: Keys = {};\r\n  public methods: Methods = {};\r\n\r\n  public actions: { [key: string]: Action } = {};\r\n  public computed: { [key: string]: Computed } = {};\r\n  public watchers: { [key: string]: any } = {};\r\n  public externalWatchers: { [key: string]: any } = {};\r\n  public persist: Array<string> = [];\r\n  public local: { [key: string]: any } = {};\r\n  public model: { [key: string]: any } = {};\r\n\r\n  public collectionSize: number = 0;\r\n  public primaryKey: string | number | boolean = false;\r\n\r\n  private internalData: object = {};\r\n  private internalDataWithPopulate: Array<string> = [];\r\n\r\n  private tickets: { [key: string]: Array<string> } = {};\r\n\r\n  dispatch: void;\r\n\r\n  constructor(\r\n    public name: string,\r\n    protected global: Global,\r\n    root: CollectionObject\r\n  ) {\r\n    this.config = root.config;\r\n    this.dispatch = this.global.dispatch;\r\n\r\n    // legacy support (\"filters\" changed to \"computed\")\r\n    root.computed = { ...root.computed, ...root.filters };\r\n\r\n    root = this.prepareNamespace(root);\r\n\r\n    this.initReactive(root.data, root.groups);\r\n    this.initRoutes(root.routes);\r\n    this.initActions(root.actions);\r\n    this.initWatchers(root.watch);\r\n    this.initComputed(root.computed);\r\n\r\n    this.initModel(root.model);\r\n    this.initPersist(root.persist);\r\n  }\r\n\r\n  prepareNamespace(root: CollectionObject) {\r\n    // map collection methods\r\n    collectionFunctions.map(\r\n      func => (this.methods[func] = this[func].bind(this))\r\n    );\r\n\r\n    if (root.local) this.local = root.local;\r\n\r\n    // for each type set default and register keys\r\n    ['data', 'actions', 'computed', 'indexes', 'routes', 'watch'].forEach(\r\n      type => {\r\n        if (type !== 'indexes' && !root[type]) root[type] = {};\r\n        this.keys[type] =\r\n          type === 'indexes' ? root['groups'] || [] : Object.keys(root[type]);\r\n      }\r\n    );\r\n\r\n    // assign namespace, this is used by initReactive\r\n    this.namespace = Object.assign(\r\n      Object.create({ ...this.methods }), // bind methods to prototype\r\n      {\r\n        routes: {},\r\n        indexes: {},\r\n        actions: root.actions,\r\n        ...root.computed,\r\n        ...root.data,\r\n        ...this.normalizeGroups(root.groups)\r\n      }\r\n    );\r\n    return root;\r\n  }\r\n\r\n  // groups are defined by the user as an array of strings, this converts them into object/keys\r\n  normalizeGroups(groupsAsArray: any = []) {\r\n    const groups: object = {};\r\n    for (let i = 0; i < groupsAsArray.length; i++) {\r\n      const groupName = groupsAsArray[i];\r\n      groups[groupName] = [];\r\n    }\r\n    return groups;\r\n  }\r\n\r\n  runWatchers(property) {\r\n    const watcher = this.watchers[property];\r\n    if (watcher) watcher();\r\n    const externalWatchers = this.externalWatchers[property];\r\n    if (externalWatchers)\r\n      externalWatchers.forEach(func =>\r\n        typeof func === 'function' ? func() : false\r\n      );\r\n  }\r\n\r\n  initReactive(data: object = {}, groups: Array<any> | object = []) {\r\n    groups = this.normalizeGroups(groups);\r\n    // Make indexes reactive\r\n    this.indexes = new Reactive(\r\n      groups, // object\r\n      this.global, // global\r\n      this.name, // collection\r\n      this.keys.indexes, // mutable\r\n      'indexes' // type\r\n    );\r\n    this.namespace.indexes = this.indexes.object;\r\n\r\n    // Make entire public object Reactive\r\n    this.public = new Reactive(\r\n      this.namespace,\r\n      this.global,\r\n      this.name,\r\n      [...this.keys.data, ...this.keys.indexes],\r\n      'root'\r\n    );\r\n  }\r\n\r\n  initPersist(persist: Array<string>): void {\r\n    if (!Array.isArray(persist)) return;\r\n\r\n    for (let i = 0; i < persist.length; i++) {\r\n      const dataName = persist[i];\r\n\r\n      // TODO: validate\r\n\r\n      this.persist.push(dataName);\r\n      if (this.global.storage.isPromise) {\r\n        this.global.storage.get(this.name, dataName).then(data => {\r\n          if (data === undefined || data === null) return;\r\n          const job = {\r\n            type: JobType.PUBLIC_DATA_MUTATION,\r\n            value: data,\r\n            property: dataName,\r\n            collection: this.name,\r\n            dep: this.global.getDep(dataName, this.name)\r\n          };\r\n          this.global.ingest(job);\r\n        });\r\n      } else {\r\n        let data = this.global.storage.get(this.name, dataName);\r\n        if (data === undefined || data === null) continue;\r\n        this.public.privateWrite(dataName, data);\r\n      }\r\n    }\r\n  }\r\n\r\n  initActions(actions: object = {}) {\r\n    let actionKeys = Object.keys(actions);\r\n    for (let i = 0; i < actionKeys.length; i++) {\r\n      const action = actions[actionKeys[i]];\r\n      this.actions[actionKeys[i]] = new Action(\r\n        this.name,\r\n        this.global,\r\n        action,\r\n        actionKeys[i]\r\n      );\r\n\r\n      this.public.privateWrite(actionKeys[i], this.actions[actionKeys[i]].exec);\r\n    }\r\n  }\r\n\r\n  initWatchers(watchers: object = {}) {\r\n    let watcherKeys = Object.keys(watchers);\r\n    for (let i = 0; i < watcherKeys.length; i++) {\r\n      const watcher = watchers[watcherKeys[i]];\r\n      this.watchers[watcherKeys[i]] = () => {\r\n        this.global.runningWatcher = {\r\n          collection: this.name,\r\n          property: watcherKeys[i]\r\n        };\r\n        const watcherOutput = watcher(this.global.getContext(this.name));\r\n        this.global.runningWatcher = false;\r\n        return watcherOutput;\r\n      };\r\n    }\r\n    this.watchers._keys = watcherKeys;\r\n  }\r\n\r\n  initComputed(computed: object): void {\r\n    objectLoop(\r\n      computed,\r\n      (computedName: string, computedFunction: () => void) => {\r\n        this.computed[computedName] = new Computed(\r\n          this.global,\r\n          this.name,\r\n          computedName,\r\n          computedFunction\r\n        );\r\n        this.public.object[computedName] = [];\r\n      },\r\n      this.keys.computed\r\n    );\r\n  }\r\n\r\n  initRoutes(routes: ExpandableObject) {\r\n    const self = this;\r\n    const routeWrapped = routeName => {\r\n      return function() {\r\n        let requestObject = Object.assign({}, self.global.request);\r\n        requestObject.context = self.global.getContext();\r\n        return routes[routeName].apply(\r\n          null,\r\n          [requestObject].concat(Array.prototype.slice.call(arguments))\r\n        );\r\n      };\r\n    };\r\n    objectLoop(\r\n      routes,\r\n      routeName =>\r\n        (this.public.object.routes[routeName] = routeWrapped(routeName))\r\n    );\r\n  }\r\n\r\n  initModel(model = {}) {\r\n    this.model = model;\r\n    Object.keys(model).forEach(property => {\r\n      Object.keys(model[property]).forEach(config => {\r\n        switch (config) {\r\n          case 'primaryKey':\r\n            this.primaryKey = property;\r\n            break;\r\n          case 'populate':\r\n            this.internalDataWithPopulate.push(property);\r\n            break;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  // called by relationController after new relation has been created\r\n  public ticket(uuid: string, primaryKey: string | number): void {\r\n    if (Array.isArray(this.tickets[primaryKey]))\r\n      this.tickets[primaryKey].push(uuid);\r\n    else this.tickets[primaryKey] = [uuid];\r\n  }\r\n\r\n  public cleanupTickets(primaryKey) {\r\n    if (this.tickets[primaryKey]) {\r\n      this.tickets[primaryKey] = [];\r\n    }\r\n  }\r\n\r\n  // called by Runtime when job has been completed\r\n  public changed(primaryKey: string | number): void {\r\n    if (this.tickets[primaryKey]) {\r\n      this.global.relations.update(this.tickets[primaryKey]);\r\n    }\r\n  }\r\n\r\n  private getData(id) {\r\n    return { ...this.internalData[id] };\r\n  }\r\n\r\n  public buildGroupFromIndex(groupName: string): Array<number> {\r\n    const constructedArray = [];\r\n    // get index directly\r\n    let index = this.indexes.object[groupName];\r\n    if (!index) return [];\r\n\r\n    // for every primaryKey in the index\r\n    for (let i = 0; i < index.length; i++) {\r\n      // primaryKey of data\r\n      let id = index[i];\r\n      // copy data from internal database\r\n      let data = this.getData(id);\r\n      // if none found skip\r\n      if (!data) continue;\r\n      // inject dynamic data\r\n      data = this.injectDynamicRelatedData(id, data);\r\n\r\n      constructedArray.push(data);\r\n    }\r\n    return constructedArray;\r\n  }\r\n\r\n  // rebuilding an entire group is expensive on resources, but is\r\n  // not nessisary if only one piece of data has changed\r\n  // this function will replace a single piece of data without rebuilding\r\n  // the entire group\r\n  public softUpdateGroupData(\r\n    primaryKey: string | number,\r\n    groupName: string\r\n  ): Array<any> {\r\n    let index: Array<any> = this.indexes.privateGetValue(groupName);\r\n\r\n    // find the data's position within index\r\n    let position: number = index.indexOf(primaryKey);\r\n\r\n    // if group is dynamic, just build the group from index.\r\n    if (!this.public[groupName]) return this.buildGroupFromIndex(groupName);\r\n\r\n    // copy the current group output\r\n    let currentGroup: Array<any> = [this.public[groupName]];\r\n\r\n    // get data for primaryKey\r\n    let data: { [key: string]: any } = { ...this.internalData[primaryKey] };\r\n\r\n    data = this.injectDynamicRelatedData(primaryKey, data);\r\n\r\n    // replace at known position with updated data\r\n    currentGroup[position] = data;\r\n\r\n    return currentGroup;\r\n  }\r\n\r\n  // This should be called on every piece of data retrieved when building a group from an index\r\n  private injectDynamicRelatedData(\r\n    primaryKey: string | number,\r\n    data: { [key: string]: any }\r\n  ): any {\r\n    // for each populate() function found in the model for this collection\r\n    this.internalDataWithPopulate.forEach(property => {\r\n      // set runningPopulate to the key (collection/propery) of the data being modified\r\n      // this is fed into the relations.relate() function becoming the unique cleanupKey for the relation\r\n      this.global.runningPopulate = key(this.name, primaryKey);\r\n      // run populate function passing in the context and the data\r\n      const populated = this.model[property].populate(\r\n        this.global.getContext(),\r\n        data\r\n      );\r\n\r\n      this.global.runningPopulate = false;\r\n      // inject result to data\r\n      data[property] = populated;\r\n    });\r\n    return data;\r\n  }\r\n\r\n  public createGroups(group) {\r\n    if (group === undefined) group = [];\r\n    else if (!Array.isArray(group)) group = [group];\r\n\r\n    for (let i = 0; i < group.length; i++) {\r\n      const groupName = group[i];\r\n      if (!this.indexes.object[groupName]) {\r\n        this.indexes.object[groupName] = [];\r\n      }\r\n    }\r\n    return group;\r\n  }\r\n\r\n  // METHODS\r\n\r\n  public collect(\r\n    data,\r\n    group?: string | Array<string>,\r\n    config?: ExpandableObject\r\n  ) {\r\n    config = defineConfig(config, {\r\n      append: true\r\n    });\r\n    this.global.collecting = true;\r\n    // normalise data\r\n    if (!Array.isArray(data)) data = [data];\r\n\r\n    // if groups don't already exist, create them dynamically\r\n    const groups: Array<string> = this.createGroups(group);\r\n    // groups now contains just the groups directly modified by this collect\r\n\r\n    // preserve index previous values\r\n    const previousIndexValues: object = this.getPreviousIndexValues(groups);\r\n\r\n    const indexesToRegenOnceComplete = new Set();\r\n\r\n    // process data items\r\n    for (let i = 0; i < data.length; i++) {\r\n      const dataItem = data[i];\r\n\r\n      if (dataItem === null) continue;\r\n      // process data item returns \"success\" as a boolean and affectedIndexes as an array\r\n      const processDataItem = this.processDataItem(dataItem, groups, config);\r\n\r\n      if (!processDataItem) continue;\r\n\r\n      if (processDataItem.success) this.collectionSize++;\r\n      // ensure indexes modified by this data item are waiting to be ingested for regen\r\n      processDataItem.affectedIndexes.forEach(index =>\r\n        indexesToRegenOnceComplete.add(index)\r\n      );\r\n    }\r\n\r\n    indexesToRegenOnceComplete.forEach(index => {\r\n      this.global.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: this.name,\r\n        property: index,\r\n        value: this.indexes.object[index],\r\n        previousValue: previousIndexValues[index]\r\n      });\r\n    });\r\n\r\n    this.global.collecting = false;\r\n  }\r\n\r\n  processDataItem(dataItem: object, groups: Array<string> = [], config) {\r\n    if (!this.primaryKey) this.findPrimaryKey(dataItem);\r\n\r\n    if (!this.primaryKey) return false;\r\n\r\n    const key = dataItem[this.primaryKey as number | string];\r\n\r\n    // find affected indexes\r\n    let affectedIndexes = [...groups];\r\n\r\n    // searchIndexesForPrimaryKey returns an array of indexes that include that primaryKey\r\n    // for each index found, if it is not already known, add to affected indexes\r\n    this.searchIndexesForPrimaryKey(key).map(\r\n      index => !affectedIndexes.includes(index) && affectedIndexes.push(index)\r\n    );\r\n\r\n    // validate against model\r\n\r\n    // ingest the data\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: key,\r\n      value: dataItem\r\n    });\r\n\r\n    // add the data to group indexes\r\n    for (let i = 0; i < groups.length; i++) {\r\n      const groupName = groups[i];\r\n      let index = [...this.indexes.object[groupName]];\r\n\r\n      // remove key if already present in index\r\n      index = index.filter(k => k != key);\r\n\r\n      if (config.append) index.push(key);\r\n      else index.unshift(key);\r\n\r\n      // write index\r\n      this.indexes.privateWrite(groupName, index);\r\n    }\r\n    return { success: true, affectedIndexes };\r\n  }\r\n\r\n  private searchIndexesForPrimaryKey(\r\n    primaryKey: string | number\r\n  ): Array<string> {\r\n    // include dynamic indexes\r\n    const keys = Object.keys(this.indexes.object);\r\n\r\n    let foundIndexes: Array<string> = [];\r\n\r\n    // for every index\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const indexName = keys[i];\r\n\r\n      // if the index includes the primaryKey\r\n      if (this.indexes.object[indexName].includes(primaryKey))\r\n        foundIndexes.push(indexName);\r\n    }\r\n    return foundIndexes;\r\n  }\r\n\r\n  getPreviousIndexValues(groups) {\r\n    const returnData = {};\r\n    for (let i = 0; i < groups; i++) {\r\n      const groupName = groups[i];\r\n      returnData[groupName] = this.indexes.object[groupName];\r\n    }\r\n    return returnData;\r\n  }\r\n\r\n  findPrimaryKey(dataItem) {\r\n    if (dataItem.hasOwnProperty('id')) this.primaryKey = 'id';\r\n    else if (dataItem.hasOwnProperty('_id')) this.primaryKey = '_id';\r\n    else if (dataItem.hasOwnProperty('key')) this.primaryKey = 'key';\r\n    if (this.primaryKey) return true;\r\n    else return assert(warn => warn.NO_PRIMARY_KEY);\r\n  }\r\n\r\n  replaceIndex(indexName: string, newIndex: Array<string | number>) {\r\n    if (!Array.isArray(newIndex) || typeof indexName !== 'string')\r\n      return assert(warn => warn.INVALID_PARAMETER, 'replaceIndex');\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: indexName,\r\n      value: newIndex\r\n    });\r\n  }\r\n\r\n  findById(id) {\r\n    // if (!this.internalData.hasOwnProperty(id))\r\n    //   return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'findById');\r\n\r\n    if (this.global.runningComputed) {\r\n      let computed = this.global.runningComputed as Computed;\r\n      this.global.relations.relate(\r\n        RelationTypes.COMPUTED_DEPENDS_ON_DATA,\r\n        // updateThis computed instance\r\n        computed,\r\n        // primaryKey of data for whenThisChanges\r\n        id,\r\n        this.name\r\n      );\r\n    }\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_DATA,\r\n        // this is the key (\"collection/primaryKey\") for the dynamically populated data for updateThis\r\n        this.global.runningPopulate,\r\n        // primaryKey of data for whenThisChanges\r\n        id,\r\n        this.name\r\n      );\r\n    }\r\n    return this.internalData[id];\r\n  }\r\n\r\n  getGroup(property) {\r\n    // if called inside Computed method, create temporary relation in relationship controller\r\n    if (this.global.runningComputed) {\r\n      let computed = this.global.runningComputed as Computed;\r\n      this.global.relations.relate(\r\n        RelationTypes.COMPUTED_DEPENDS_ON_GROUP,\r\n        computed, // updateThis\r\n        property, // whenThisChanges\r\n        this.name\r\n      );\r\n    }\r\n    // if called from within populate() create another temporary relation\r\n    if (this.global.runningPopulate) {\r\n      this.global.relations.relate(\r\n        RelationTypes.DATA_DEPENDS_ON_GROUP,\r\n        this.global.runningPopulate, // updateThis\r\n        property, // whenThisChanges\r\n        this.name\r\n      );\r\n    }\r\n    // get group is not cached, so generate a fresh group from the index\r\n    return this.buildGroupFromIndex(property) || [];\r\n  }\r\n\r\n  // action functions\r\n  undo() {}\r\n  throttle() {}\r\n\r\n  // group functions\r\n  move(\r\n    ids: number | Array<string | number>,\r\n    sourceIndexName: string,\r\n    destIndexName?: string,\r\n    method: 'push' | 'unshift' = 'push'\r\n  ) {\r\n    // validation\r\n    if (!this.indexes.exists(sourceIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\r\n\r\n    if (destIndexName && !this.indexes.exists(destIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\r\n\r\n    if (!Array.isArray(ids)) ids = [ids];\r\n\r\n    let sourceIndex = this.indexes.privateGetValue(sourceIndexName);\r\n    for (let i = 0; i < ids.length; i++) sourceIndex.map(id => id !== ids[i]);\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: sourceIndexName,\r\n      value: sourceIndex\r\n    });\r\n\r\n    if (destIndexName) {\r\n      let destIndex = this.indexes.privateGetValue(destIndexName);\r\n\r\n      for (let i = 0; i < ids.length; i++) {\r\n        // destIndex = destIndex.filter(k => k != ids[i]);\r\n\r\n        if (destIndex.includes(ids[i])) continue;\r\n\r\n        // push or unshift id into current index\r\n        destIndex[method](ids[i]);\r\n      }\r\n\r\n      this.global.ingest({\r\n        type: JobType.INDEX_UPDATE,\r\n        collection: this.name,\r\n        property: destIndexName,\r\n        value: destIndex\r\n      });\r\n    }\r\n  }\r\n\r\n  put(\r\n    ids: number | Array<string | number>,\r\n    destIndexName: string,\r\n    method: 'push' | 'unshift' = 'push'\r\n  ) {\r\n    // validation\r\n    if (!this.indexes.exists(destIndexName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'put');\r\n\r\n    if (!Array.isArray(ids)) ids = [ids];\r\n\r\n    // get current index\r\n    let destIndex = this.indexes.privateGetValue(destIndexName);\r\n\r\n    // This doesn't work because the array spead sets the object to index: value rather than just the values\r\n    // let test = { ...destIndex };\r\n    // ids.map(k => {\r\n    //   if (test[k]) return;\r\n    //   test[k] = true;\r\n    // });\r\n    // destIndex = Object.keys(test).map(k => Number(k));\r\n\r\n    // loop over every id user is trying to add into current index\r\n    for (let i = 0; i < ids.length; i++) {\r\n      // destIndex = destIndex.filter(k => k != ids[i]);\r\n\r\n      if (destIndex.includes(ids[i])) continue;\r\n\r\n      // push or unshift id into current index\r\n      destIndex[method](ids[i]);\r\n    }\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: destIndexName,\r\n      value: destIndex\r\n    });\r\n  }\r\n\r\n  newGroup(groupName: string, indexValue?: Array<string | number>) {\r\n    if (this.indexes.object.hasOwnProperty(groupName))\r\n      return assert(warn => warn.GROUP_ALREADY_EXISTS, 'newGroup');\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: indexValue\r\n    });\r\n  }\r\n  deleteGroup(groupName: string) {\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: []\r\n    });\r\n  }\r\n  removeFromGroup(\r\n    groupName: string,\r\n    itemsToRemove: number | string | Array<number | string>\r\n  ) {\r\n    if (!this.indexes.exists(groupName))\r\n      return assert(warn => warn.INDEX_NOT_FOUND, 'removeFromGroup');\r\n\r\n    if (!Array.isArray(itemsToRemove)) itemsToRemove = [itemsToRemove];\r\n\r\n    const index = this.indexes.privateGetValue(groupName);\r\n\r\n    const newIndex = index.filter(\r\n      id => !(itemsToRemove as Array<number | string>).includes(id)\r\n    );\r\n\r\n    this.global.ingest({\r\n      type: JobType.INDEX_UPDATE,\r\n      collection: this.name,\r\n      property: groupName,\r\n      value: newIndex\r\n    });\r\n  }\r\n\r\n  // internal data functions\r\n  update(primaryKey: string | number, newObject: { [key: string]: any }) {\r\n    if (!this.internalData.hasOwnProperty(primaryKey))\r\n      return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'update');\r\n\r\n    const newObjectKeys = Object.keys(newObject);\r\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\r\n\r\n    for (let i = 0; i < newObjectKeys.length; i++) {\r\n      const key = newObjectKeys[i];\r\n      currentData[key] = newObject[key];\r\n    }\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: primaryKey,\r\n      value: currentData\r\n    });\r\n  }\r\n  increment(\r\n    primaryKey: string | number,\r\n    property: string,\r\n    amount: number,\r\n    decrement?: boolean\r\n  ) {\r\n    if (!this.internalData.hasOwnProperty(primaryKey))\r\n      return assert(\r\n        warn => warn.INTERNAL_DATA_NOT_FOUND,\r\n        decrement ? 'decrement' : 'increment'\r\n      );\r\n\r\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\r\n\r\n    if (!validateNumber(amount, currentData[property]))\r\n      return assert(\r\n        warn => warn.PROPERTY_NOT_A_NUMBER,\r\n        decrement ? 'decrement' : 'increment'\r\n      );\r\n\r\n    if (decrement) currentData[property] -= amount;\r\n    else currentData[property] += amount;\r\n\r\n    this.global.ingest({\r\n      type: JobType.INTERNAL_DATA_MUTATION,\r\n      collection: this.name,\r\n      property: primaryKey,\r\n      value: currentData\r\n    });\r\n  }\r\n  decrement(primaryKey: string | number, property: string, amount: number) {\r\n    this.increment(primaryKey, property, amount, true);\r\n  }\r\n\r\n  delete(primaryKeys: string | number | Array<string | number>) {\r\n    if (!Array.isArray(primaryKeys)) primaryKeys = [primaryKeys];\r\n    for (let i = 0; i < primaryKeys.length; i++) {\r\n      const primaryKey = primaryKeys[i];\r\n      this.global.ingest({\r\n        type: JobType.DELETE_INTERNAL_DATA,\r\n        collection: this.name,\r\n        property: primaryKey\r\n      });\r\n    }\r\n  }\r\n\r\n  // remove all dynamic indexes, empty all indexes, delete all internal data\r\n  purge() {}\r\n\r\n  // external functions\r\n  watch(property, callback) {\r\n    if (!this.externalWatchers[property])\r\n      this.externalWatchers[property] = [callback];\r\n    else this.externalWatchers[property].push(callback);\r\n  }\r\n\r\n  // deprecate\r\n  // added removeFromGroup to be more specific, params got switched around, keeping this for backwards compatibility\r\n  remove(itemsToRemove, groupName) {\r\n    return this.removeFromGroup(groupName, itemsToRemove);\r\n  }\r\n}\r\n","// This file handles external components subscribing to pulse.\r\n// It also handles subscribing mapData properties to collections\r\n\r\nimport { uuid } from './helpers';\r\nimport { ComponentContainer } from './interfaces';\r\nimport Dep from './dep';\r\n\r\ninterface SubscribingComponentObject {\r\n  componentUUID: string;\r\n  keys: Array<string>;\r\n}\r\n\r\nexport default class SubController {\r\n  private uuid: any = uuid;\r\n  private subscribingComponentKey: number = 0;\r\n  private subscribingComponent: boolean | SubscribingComponentObject = false;\r\n  private unsubscribingComponent: boolean = false;\r\n  private skimmingDeepReactive: boolean = false;\r\n  private lastAccessedDep: null | Dep = null;\r\n\r\n  public componentStore: { [key: string]: ComponentContainer } = {};\r\n\r\n  constructor(private getContext: any) {}\r\n\r\n  registerComponent(instance, config) {\r\n    let uuid = instance.__pulseUniqueIdentifier;\r\n    if (!uuid) {\r\n      // generate UUID\r\n      uuid = this.uuid();\r\n      // inject uuid into component instance\r\n      const componentContainer = {\r\n        instance: instance,\r\n        uuid,\r\n        ready: config.waitForMount ? false : true\r\n      };\r\n      instance.__pulseUniqueIdentifier = uuid;\r\n\r\n      this.componentStore[uuid] = componentContainer;\r\n    } else {\r\n      this.mount(instance);\r\n    }\r\n    return uuid;\r\n  }\r\n\r\n  mount(instance) {\r\n    let component = this.componentStore[instance.__pulseUniqueIdentifier];\r\n\r\n    if (component) {\r\n      component.instance = instance;\r\n      component.ready = true;\r\n    }\r\n  }\r\n\r\n  unmount(instance) {\r\n    const uuid = instance.__pulseUniqueIdentifier;\r\n    if (!uuid) return;\r\n\r\n    // delete refrence to this component from store\r\n    delete this.componentStore[instance.__pulseUniqueIdentifier];\r\n  }\r\n\r\n  subscribePropertiesToComponents(properties, componentUUID) {\r\n    // provisionally get keys of mapped data\r\n    const provision = properties(this.getContext());\r\n\r\n    const keys = Object.keys(provision);\r\n\r\n    // mapData has a user defined local key, we need to include that in the\r\n    // subscription so we know what to update on the component later.\r\n    this.subscribingComponentKey = 0;\r\n\r\n    this.subscribingComponent = {\r\n      componentUUID,\r\n      keys\r\n    };\r\n    const returnToComponent = properties(this.getContext());\r\n\r\n    this.subscribingComponent = false;\r\n\r\n    this.subscribingComponentKey = 0;\r\n\r\n    return returnToComponent;\r\n  }\r\n\r\n  prepareNext(dep) {\r\n    this.lastAccessedDep = dep;\r\n    if (!this.skimmingDeepReactive) this.subscribingComponentKey++;\r\n  }\r\n\r\n  foundDeepReactive() {\r\n    this.skimmingDeepReactive = true;\r\n    // undo changes\r\n    this.lastAccessedDep.subscribers.pop();\r\n    this.subscribingComponentKey--;\r\n  }\r\n\r\n  exitDeepReactive() {\r\n    this.skimmingDeepReactive = false;\r\n    //redo changes\r\n    this.lastAccessedDep.subscribe();\r\n    this.subscribingComponentKey++;\r\n  }\r\n}\r\n","interface StorageMethods {\r\n  async?: boolean;\r\n  get?: any;\r\n  set?: any;\r\n  remove?: any;\r\n}\r\n\r\nexport default class Storage {\r\n  private isPromise: boolean = false;\r\n  private storageReady: boolean = false;\r\n  private storageType: 'localStorage' | 'custom' = 'localStorage';\r\n  constructor(private storageMethods: StorageMethods = {}) {\r\n    if (storageMethods.async) this.isPromise = true;\r\n    if (this.localStorageAvaliable() && this.storageType === 'localStorage') {\r\n      this.storageReady = true;\r\n      storageMethods.get = localStorage.getItem.bind(localStorage);\r\n      storageMethods.set = localStorage.setItem.bind(localStorage);\r\n      storageMethods.remove = localStorage.removeItem.bind(localStorage);\r\n    } else {\r\n      this.storageType = 'custom';\r\n\r\n      if (\r\n        this.check(storageMethods.get) &&\r\n        this.check(storageMethods.set) &&\r\n        this.check(storageMethods.remove)\r\n      ) {\r\n        this.storageReady = true;\r\n      } else {\r\n        this.storageReady = false;\r\n        // bad\r\n      }\r\n    }\r\n  }\r\n\r\n  public get(collection, key) {\r\n    if (!this.storageReady) return;\r\n\r\n    if (this.isPromise) {\r\n      return new Promise((resolve, reject) => {\r\n        this.storageMethods\r\n          .get(this.getKey(collection, key))\r\n          .then(res => {\r\n            // if result is not JSON for some reason, return it.\r\n            if (typeof res !== 'string') return resolve(res);\r\n\r\n            resolve(JSON.parse(res));\r\n          })\r\n          .catch(reject);\r\n      });\r\n    } else {\r\n      return JSON.parse(this.storageMethods.get(this.getKey(collection, key)));\r\n    }\r\n  }\r\n\r\n  public set(collection, key, value) {\r\n    if (!this.storageReady) return;\r\n    this.storageMethods.set(\r\n      this.getKey(collection, key),\r\n      JSON.stringify(value)\r\n    );\r\n  }\r\n\r\n  public remove(collection, key) {\r\n    if (!this.storageReady) return;\r\n    this.storageMethods.remove(this.getKey(collection, key));\r\n  }\r\n\r\n  private getKey(collection, key) {\r\n    return `_${collection}_${key}`;\r\n  }\r\n\r\n  private check(func) {\r\n    return typeof func === 'function';\r\n  }\r\n\r\n  private localStorageAvaliable() {\r\n    try {\r\n      localStorage.setItem('_', '_');\r\n      localStorage.removeItem('_');\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import Collection from '../collection';\r\nimport { Global, ExpandableObject, RequestConfig } from '../interfaces';\r\n\r\ntype Method = 'get' | 'put' | 'post' | 'patch' | 'delete';\r\n\r\nexport default class Request extends Collection {\r\n  private timeout: number;\r\n  private options: ExpandableObject;\r\n  private saveHistory: boolean;\r\n\r\n  private requestIntercept: (\r\n    context: ExpandableObject,\r\n    options: ExpandableObject\r\n  ) => void;\r\n  private responseIntercept: (\r\n    context: ExpandableObject,\r\n    response: ExpandableObject\r\n  ) => void;\r\n\r\n  constructor(global: Global, requestConfig: RequestConfig) {\r\n    // Before we invoke the parent class, we define some defaults\r\n    let groups = [];\r\n    let persist = ['baseURL'];\r\n    let data = {\r\n      baseURL: requestConfig.baseURL || '',\r\n      mode: 'cors',\r\n      credentials: 'same-origin',\r\n      headers: {\r\n        Accept: 'application/json'\r\n      }\r\n    };\r\n\r\n    if (requestConfig.headers)\r\n      Object.keys(requestConfig.headers).forEach(header => {\r\n        data.headers[header] = requestConfig.headers[header];\r\n      });\r\n\r\n    if (requestConfig.credentials) data.credentials = requestConfig.credentials;\r\n    if (requestConfig.mode) data.mode = requestConfig.mode;\r\n\r\n    super('request', global, { groups, data, persist });\r\n\r\n    this.requestIntercept = requestConfig.requestIntercept;\r\n    this.responseIntercept = requestConfig.responseIntercept;\r\n    this.timeout = requestConfig.timeout;\r\n    this.saveHistory =\r\n      typeof requestConfig.saveHistory === 'undefined' ? true : false;\r\n\r\n    this.global.request = {\r\n      get: this.get.bind(this),\r\n      post: this.post.bind(this),\r\n      put: this._put.bind(this),\r\n      patch: this.patch.bind(this),\r\n      delete: this.delete.bind(this),\r\n      queryify: this.queryify.bind(this)\r\n    };\r\n  }\r\n\r\n  get(url: string, headers?: ExpandableObject) {\r\n    return this.send(url, 'get', {}, headers);\r\n  }\r\n\r\n  post(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'post', body, headers);\r\n  }\r\n\r\n  _put(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'put', body, headers);\r\n  }\r\n\r\n  patch(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'patch', body, headers);\r\n  }\r\n\r\n  delete(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\r\n    return this.send(url, 'delete', body, headers);\r\n  }\r\n\r\n  async send(\r\n    url: string,\r\n    method: Method,\r\n    body: ExpandableObject | string = {},\r\n    headers: ExpandableObject\r\n  ) {\r\n    const requestHeaders = Object.assign({}, this.public.object.headers);\r\n\r\n    if (headers)\r\n      Object.keys(headers).forEach(header => {\r\n        requestHeaders[header] = headers[header];\r\n      });\r\n\r\n    // If method is not get set application type\r\n    if (method !== 'get' && requestHeaders['Content-Type'] === undefined)\r\n      requestHeaders['Content-Type'] = 'application/json';\r\n\r\n    let fullURL;\r\n\r\n    if (url.startsWith('http')) fullURL = url;\r\n    else fullURL = `${this.public.object.baseURL}/${url}`;\r\n\r\n    // Stringify body\r\n    body = JSON.stringify(body);\r\n\r\n    // Build options\r\n    this.options = {};\r\n    this.options.credentials = this.public.object.credentials;\r\n    this.options.mode = this.public.object.mode;\r\n\r\n    // Build final fetch options object\r\n    const options = Object.assign(\r\n      {\r\n        headers: requestHeaders,\r\n        method: method.toUpperCase(),\r\n        body: method === 'get' ? null : body\r\n      },\r\n      this.options\r\n    );\r\n\r\n    if (this.requestIntercept)\r\n      this.requestIntercept(this.global.getContext('request'), options);\r\n\r\n    let response: any;\r\n\r\n    if (this.timeout) {\r\n      response = await Promise.race([\r\n        fetch(fullURL, options),\r\n        new Promise((resolve, reject) =>\r\n          setTimeout(() => reject('timeout'), this.timeout)\r\n        )\r\n      ]);\r\n    } else {\r\n      response = await fetch(fullURL, options);\r\n    }\r\n\r\n    const contentType = response.headers.get('content-type');\r\n\r\n    // extract body\r\n    if (contentType && contentType.indexOf('application/json') !== -1) {\r\n      body = await response.json();\r\n    } else {\r\n      body = await response.text();\r\n    }\r\n\r\n    // history\r\n    if (!this.saveHistory)\r\n      this.collect({\r\n        id: Date.now(),\r\n        status: response.status,\r\n        timestamp: new Date(),\r\n        response: body\r\n      });\r\n\r\n    // inject headers into prototype\r\n    let final;\r\n\r\n    // If reponse body is an object, create a custom object with response function in prototype, so headers and the full response data can be accessed outside of this class\r\n    if (!Array.isArray(body) && typeof body === 'object') {\r\n      final = Object.create({\r\n        response: () => {\r\n          return response;\r\n        }\r\n      });\r\n      const keys = Object.keys(body);\r\n      for (let i = 0; i < keys.length; i++) {\r\n        const property = keys[i];\r\n        final[property] = body[property];\r\n      }\r\n      // if the body is not an object, we can not inject a prototype, so just return the rew body\r\n    } else {\r\n      final = body;\r\n    }\r\n    // intercept response\r\n    if (this.responseIntercept) {\r\n      response.data = body;\r\n      this.responseIntercept(this.global.getContext('request'), response);\r\n    }\r\n\r\n    // reject if bad response status\r\n    if (response.ok || response.redirected) return final;\r\n\r\n    // resolve response\r\n    throw final;\r\n  }\r\n\r\n  // Adapted from: https://github.com/Gozala/querystring/blob/master/encode.js\r\n  queryify(obj) {\r\n    const stringifyPrimitive = function(value) {\r\n      switch (typeof value) {\r\n        case 'string':\r\n          return value;\r\n\r\n        case 'boolean':\r\n          return value ? 'true' : 'false';\r\n\r\n        case 'number':\r\n          return isFinite(value) ? value : '';\r\n\r\n        default:\r\n          return '';\r\n      }\r\n    };\r\n    // validate input\r\n    if (typeof obj != 'object') return;\r\n\r\n    return Object.keys(obj)\r\n      .map(key => {\r\n        const encodedKey = encodeURIComponent(stringifyPrimitive(key)) + '=';\r\n        // if value is an array, encode with same key as parent\r\n        if (Array.isArray(obj[key]))\r\n          return obj[key]\r\n            .map(value => {\r\n              return encodedKey + encodeURIComponent(stringifyPrimitive(value));\r\n            })\r\n            .join('&');\r\n        // join encoded key with value\r\n        return encodedKey + encodeURIComponent(stringifyPrimitive(obj[key]));\r\n      })\r\n      .join('&');\r\n  }\r\n}\r\n","import Collection from '../collection';\r\nimport { Global, RootCollectionObject } from '../interfaces';\r\n\r\nexport default class Request extends Collection {\r\n  constructor(global: Global, root: RootCollectionObject = {}) {\r\n    root = Object.assign({}, root);\r\n\r\n    // Base as a collection is configured directly from the root of the Pulse config,\r\n    // thus to be verbose we remove the properties only used for global setup\r\n    // default collection properties like data, computed, actions etc will remain\r\n    delete root.collections;\r\n    delete root.request;\r\n\r\n    // if user has not created data or persist properties, create them for the defaults.\r\n    if (!root.data) root.data = {};\r\n    if (!root.persist) root.persist = [];\r\n\r\n    // can be used to preserve authenticated state\r\n    // automatically persists if local storage is availible\r\n    root.data['isAuthenticated'] = false;\r\n    root.persist.push('isAuthenticated');\r\n\r\n    // can be used to declare once the app has finished initilazation, does not affect Pulse\r\n    root.data['appReady'] = false;\r\n\r\n    super('base', global, root);\r\n  }\r\n}\r\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _extends() {\r\n  _extends =\r\n    Object.assign ||\r\n    function(target) {\r\n      for (var i = 1; i < arguments.length; i++) {\r\n        var source = arguments[i];\r\n        for (var key in source) {\r\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\r\n            target[key] = source[key];\r\n          }\r\n        }\r\n      }\r\n      return target;\r\n    };\r\n  return _extends.apply(this, arguments);\r\n}\r\n\r\nexport default function withPulse(pulse, React, ReactComponent, selectData) {\r\n  return class extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        ...pulse.mapData(\r\n          selectData,\r\n          this,\r\n          {\r\n            waitForMount:\r\n              pulse._private.global.config.waitForMount === false ? false : true\r\n          },\r\n          pulse\r\n        )\r\n      };\r\n    }\r\n    componentDidMount() {\r\n      if (pulse._private.global.config.waitForMount) pulse.mount(this);\r\n    }\r\n    componentWillUnmount() {\r\n      if (pulse._private.global.config.autoUnmount) pulse.unmount(this);\r\n    }\r\n    render() {\r\n      return React.createElement(\r\n        ReactComponent,\r\n        _extends(\r\n          {\r\n            pulse: this.state\r\n          },\r\n          this.props\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n","import Runtime from './runtime';\r\nimport Collection from './collection';\r\nimport SubController from './subController';\r\nimport Storage from './storage';\r\nimport Request from './collections/request';\r\nimport Base from './collections/base';\r\nimport withPulse from './wrappers/ReactWithPulse';\r\nimport { uuid, normalizeMap, log, defineConfig, parse } from './helpers';\r\nimport { Private, RootCollectionObject, DebugType } from './interfaces';\r\nimport { JobType } from './runtime';\r\n\r\nimport RelationController, { Key } from './relationController';\r\nimport Dep from './dep';\r\n\r\nexport default class Library {\r\n  _private: Private;\r\n  [key: string]: any;\r\n  constructor(root: RootCollectionObject = {}) {\r\n    // Private object contains all internal Pulse data\r\n    this._private = {\r\n      runtime: null,\r\n      events: {},\r\n      collections: {},\r\n      collectionKeys: [],\r\n      // global is passed in to all classes, must not contain cyclic references\r\n      global: {\r\n        config: this.prepareConfig(root.config),\r\n        // State\r\n        initComplete: false,\r\n        runningAction: false,\r\n        runningWatcher: false,\r\n        runningComputed: false,\r\n        runningPopulate: false,\r\n        collecting: false,\r\n        touching: false,\r\n        touched: false,\r\n        contextRef: {},\r\n        // Instances\r\n        subs: new SubController(this.getContext.bind(this)),\r\n        relations: null,\r\n        storage: null,\r\n        // Function aliases\r\n        ticket: this.ticket.bind(this),\r\n        cleanupTickets: this.cleanupTickets.bind(this),\r\n        dispatch: this.dispatch.bind(this),\r\n        getInternalData: this.getInternalData.bind(this),\r\n        getContext: this.getContext.bind(this),\r\n        getDep: this.getDep.bind(this),\r\n        uuid\r\n      }\r\n    };\r\n\r\n    // Bind static objects to instance (utils and services eventually should be initialized)\r\n    ['utils', 'services', 'staticData'].forEach(type => {\r\n      if (root[type]) this[type] = root[type];\r\n    });\r\n\r\n    // Create storage instance\r\n    this._private.global.storage = new Storage(root.storage);\r\n\r\n    // Create relation controller instance\r\n    this._private.global.relations = new RelationController(\r\n      this._private.global\r\n    );\r\n\r\n    // Prepare\r\n    this.initCollections(root);\r\n    this.initRuntime();\r\n\r\n    // Finalize\r\n    this.bindCollectionPublicData();\r\n    this.runAllComputed();\r\n\r\n    this.initComplete();\r\n  }\r\n\r\n  initCollections(root: RootCollectionObject) {\r\n    this._private.collectionKeys = [];\r\n    if (root.collections) {\r\n      this._private.collectionKeys = [\r\n        ...Object.keys(root.collections),\r\n        ...this._private.collectionKeys\r\n      ];\r\n      for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n        // Create collection instance\r\n        this._private.collections[\r\n          this._private.collectionKeys[i]\r\n        ] = new Collection(\r\n          this._private.collectionKeys[i], // name\r\n          this._private.global, // global\r\n          root.collections[this._private.collectionKeys[i]] // collection config\r\n        );\r\n      }\r\n    }\r\n    // Create request class\r\n    if (this._private.global.config.enableRequest !== false)\r\n      this._private.collectionKeys.push('request');\r\n    this._private.collections['request'] = new Request(\r\n      this._private.global,\r\n      root.request || {}\r\n    );\r\n\r\n    // Create base class\r\n    if (this._private.global.config.enableBase !== false) {\r\n      this._private.collectionKeys.push('base');\r\n      this._private.collections['base'] = new Base(this._private.global, root);\r\n    }\r\n  }\r\n\r\n  initRuntime() {\r\n    this._private.runtime = new Runtime(\r\n      this._private.collections,\r\n      this._private.global\r\n    );\r\n  }\r\n\r\n  private bindCollectionPublicData(): void {\r\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n      const collection = this._private.collections[\r\n        this._private.collectionKeys[i]\r\n      ];\r\n      this._private.global.contextRef[this._private.collectionKeys[i]] =\r\n        collection.public.object;\r\n      this[this._private.collectionKeys[i]] = collection.public.object;\r\n    }\r\n  }\r\n\r\n  runAllComputed() {\r\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\r\n      const collection = this._private.collections[\r\n        this._private.collectionKeys[i]\r\n      ];\r\n\r\n      const computedKeys = collection.keys.computed;\r\n      for (let i = 0; i < computedKeys.length; i++) {\r\n        const computedName = computedKeys[i];\r\n        this._private.runtime.performComputedOutput({\r\n          collection: collection.name,\r\n          property: computedName,\r\n          type: JobType.COMPUTED_REGEN\r\n        });\r\n        collection.runWatchers(computedName);\r\n      }\r\n    }\r\n  }\r\n\r\n  initComplete() {\r\n    this._private.global.initComplete = true;\r\n    log('INIT COMPLETE', Object.assign({}, this));\r\n    if (!this._private.global.config.ssr) {\r\n      try {\r\n        window._pulse = this;\r\n      } catch (e) {}\r\n    }\r\n  }\r\n\r\n  public wrapped(ReactComponent, mapData) {\r\n    const config = this._private.global.config;\r\n    if (config.framework === 'react' && config.frameworkConstructor) {\r\n      return withPulse(\r\n        this,\r\n        config.frameworkConstructor,\r\n        ReactComponent,\r\n        mapData\r\n      );\r\n    } else return false;\r\n  }\r\n\r\n  private prepareConfig(config) {\r\n    // defaults\r\n    config = defineConfig(config, {\r\n      framework: null,\r\n      waitForMount: false,\r\n      autoUnmount: false\r\n    });\r\n\r\n    // detect if framework passed in is a React constructor\r\n    if (\r\n      config.framework &&\r\n      config.framework.hasOwnProperty(\r\n        '__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED'\r\n      )\r\n    ) {\r\n      config.frameworkConstructor = config.framework;\r\n      config.framework = 'react';\r\n    }\r\n\r\n    if (config.framework === 'react') {\r\n      if (config.waitForMount != false) config.waitForMount = true;\r\n      if (config.autoUnmount != false) config.autoUnmount = true;\r\n    }\r\n    return config;\r\n  }\r\n\r\n  getInternalData(collection, primaryKey) {\r\n    return this._private.collections[collection].findById(primaryKey);\r\n  }\r\n\r\n  // returns Dep instance by \"touching\" reactive property revealing its Dep class\r\n  // if collection param is present we'll assume the property param is the name of the property, not a reference to the property itself\r\n  getDep(property: any, collection: string): Dep {\r\n    this._private.global.touching = true;\r\n\r\n    // \"touching\" is simply invoking the property's getter\r\n\r\n    if (typeof collection === 'string') {\r\n      this._private.collections[collection].public.object[property];\r\n    } else if (typeof collection === 'object') {\r\n      collection[property];\r\n    }\r\n\r\n    // Extract the dep\r\n    const dep = this._private.global.touched as Dep;\r\n    this._private.global.touching = false;\r\n    this._private.global.touched = null;\r\n\r\n    return dep as Dep;\r\n  }\r\n\r\n  dispatch(type: string, payload) {\r\n    switch (type) {\r\n      case 'mutation':\r\n        this._private.runtime.ingest({\r\n          type: JobType.PUBLIC_DATA_MUTATION,\r\n          collection: payload.collection,\r\n          property: payload.key,\r\n          value: payload.value,\r\n          dep: payload.dep\r\n        });\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  getContext(collection) {\r\n    const c = this._private.collections[collection];\r\n    if (!c) return this._private.global.contextRef;\r\n    return {\r\n      ...this._private.global.contextRef,\r\n      ...c.methods,\r\n      data: c.public.object,\r\n      indexes: c.indexes.object,\r\n      groups: c.public.object,\r\n      computed: c.public.object,\r\n      routes: c.public.object.routes,\r\n      local: c.local\r\n    };\r\n  }\r\n\r\n  install(Vue) {\r\n    this._private.global.config.framework = 'vue';\r\n    const pulse = this;\r\n    const config = pulse._private.global.config;\r\n    Vue.mixin({\r\n      beforeCreate() {\r\n        Object.keys(pulse._private.global.contextRef).forEach(collection => {\r\n          this['$' + collection] = pulse._private.global.contextRef[collection];\r\n        });\r\n\r\n        if (pulse.utils) this.$utils = pulse.utils;\r\n        if (pulse.services) this.$services = pulse.services;\r\n        if (pulse.staticData) this.$staticData = pulse.staticData;\r\n\r\n        this.mapData = properties =>\r\n          pulse.mapData(\r\n            properties,\r\n            this,\r\n            {\r\n              waitForMount: config.waitForMount\r\n            },\r\n            pulse\r\n          );\r\n      },\r\n      mounted() {\r\n        if (this.__pulseUniqueIdentifier && config.waitForMount)\r\n          pulse.mount(this);\r\n      },\r\n      beforeDestroy() {\r\n        if (this.__pulseUniqueIdentifier && config.autoUnmount)\r\n          pulse.unmount(this);\r\n      }\r\n    });\r\n  }\r\n\r\n  mount(instance) {\r\n    this._private.global.subs.mount(instance);\r\n  }\r\n\r\n  unmount(instance) {\r\n    this._private.global.subs.unmount(instance);\r\n  }\r\n\r\n  mapData(properties, instance = {}, _config = {}, pulseAlias?: any) {\r\n    let pulse = pulseAlias ? pulseAlias : this;\r\n    const config = {\r\n      waitForMount: true,\r\n      ..._config\r\n    };\r\n    const componentUUID = pulse._private.global.subs.registerComponent(\r\n      instance,\r\n      config\r\n    );\r\n    // new cool mapData method\r\n    if (typeof properties === 'function') {\r\n      return pulse._private.global.subs.subscribePropertiesToComponents(\r\n        properties,\r\n        componentUUID\r\n      );\r\n      // legacy support....\r\n    } else if (typeof properties === 'object') {\r\n      let returnData = {};\r\n      normalizeMap(properties).forEach(({ key, val }) => {\r\n        let collection = val.split('/')[0];\r\n        let property = val.split('/')[1];\r\n        let c = pulse._private.global.getContext()[collection];\r\n        returnData[\r\n          key\r\n        ] = pulse._private.global.subs.subscribePropertiesToComponents(() => {\r\n          return { [key]: c[property] };\r\n        }, componentUUID)[key];\r\n      });\r\n      return returnData;\r\n    }\r\n  }\r\n\r\n  emit(name: string, payload: any): void {\r\n    if (this._private.events[name])\r\n      for (let i = 0; i < this._private.events[name].length; i++) {\r\n        const callback = this._private.events[name][i];\r\n        callback(payload);\r\n      }\r\n  }\r\n  on(name: string, callback: () => any): void {\r\n    if (!Array.isArray(this._private.events[name]))\r\n      this._private.events[name] = [callback];\r\n    else this._private.events[name].push(callback);\r\n  }\r\n\r\n  // root alias for relationController to access ticket function of a given collection\r\n  ticket(collection: string, uuid: string, key: Key) {\r\n    const primaryKey = parse(key).primaryKey;\r\n    this._private.collections[collection].ticket(uuid, primaryKey);\r\n  }\r\n\r\n  // root alias for relationController to access cleanupTicket function of a given collection\r\n  cleanupTickets(key): void {\r\n    const parsed = parse(key);\r\n\r\n    this._private.collections[parsed.collection].cleanupTickets(\r\n      parsed.primaryKey\r\n    );\r\n  }\r\n\r\n  log(type: DebugType): void {\r\n    // let debugMode: Set<DebugType> = this._private.global.config.debugMode;\r\n    // if (debugMode.size === 0) return;\r\n    // if (debugMode.has(DebugType.ERRORS)) {\r\n    // }\r\n    // log(DebugType.ASSERT, `There was an error with \"${thing}\", bad :(`);\r\n    // const AssertMessages = {\r\n    //   INDEX_UPDATE_FAILED: (collection, property) =>\r\n    //     `The type ${collection} is ${property}.`\r\n    //   // and more\r\n    // };\r\n    // function _log(callback) {\r\n    // }\r\n    // _log(({ AssertMessages }) => AssertMessages.INDEX_UPDATE_FAILED(thing, thing2));\r\n  }\r\n}\r\n"],"names":["tslib_1.__extends","_typeof","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","withPulse","pulse","React","ReactComponent","selectData","props","state","mapData","waitForMount","_private","global","config","mount","autoUnmount","unmount","createElement","Component","Base"],"mappings":"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"}